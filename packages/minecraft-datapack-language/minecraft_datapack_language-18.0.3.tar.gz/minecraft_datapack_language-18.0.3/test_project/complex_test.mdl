namespace "complex";

var num player_health<@s> = 20;
var num team_score<@a[team=red]> = 0;
var num global_timer<@a> = 0;

function complex:combat<@s> {
    if $player_health<@s>$ < 10 {
        say "Health is low!";
        player_health<@s> = $player_health<@s>$ + 5;
    } else {
        say "Health is good!";
    }
    
    while $global_timer<@a>$ < 100 {
        global_timer<@a> = $global_timer<@a>$ + 1;
        say "Timer: $global_timer<@a>$";
    }
    
    if $team_score<@a[team=red]>$ > 50 {
        $!raw
        tellraw @a {"text":"Red team is winning!","color":"red"}
        raw!$
    }
}

on_load complex:combat<@s>;
