"use strict";(self.webpackChunkstreamlit_lightweight_charts_pro=self.webpackChunkstreamlit_lightweight_charts_pro||[]).push([[574],{268:(e,t,r)=>{r.d(t,{t5:()=>j,vc:()=>E,td:()=>Q,QB:()=>W,g5:()=>z});var n=r(5217),i=r(2899),s=r(8449),o=r(2688),a=r(1197),c=r(7884),h=r(942),d=r(9891),u=r(2320),l=r(9631),f=r(4702),y=r(1705),_=r(6399),g=r(4100),m=r(8137),w=r(1874),v=r(8094),b=r(3914),p=r(6824),D=r(7915),S=r(2784),B=r(31),M=r(462),L=r(7772),A=r(4908),x=r(8612),I=r(403);function R(e){return new z(e.count,k(e.columns),V(e.columns))}function O(e,t){return(e.children||[]).filter(Boolean).map(e=>M.D.fromJSON(e,t))}function k(e){return(e||[]).reduce((e,t)=>{return[...e,new Q(t.count,(r=t.VALIDITY,(r||[]).reduce((e,t)=>e+ +(0===t),0))),...k(t.children)];var r},[])}function V(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];for(let r=-1,n=(e||[]).length;++r<n;){const n=e[r];n.VALIDITY&&t.push(new j(t.length,n.VALIDITY.length)),n.TYPE&&t.push(new j(t.length,n.TYPE.length)),n.OFFSET&&t.push(new j(t.length,n.OFFSET.length)),n.DATA&&t.push(new j(t.length,n.DATA.length)),t=V(n.children,t)}return t}function N(e){return new Map(Object.entries(e||{}))}function H(e){return new I.Ai(e.isSigned,e.bitWidth)}function T(e,t){const r=e.type.name;switch(r){case"NONE":case"null":return new I.Uv;case"binary":return new I.yI;case"utf8":return new I.YE;case"bool":return new I.x;case"list":return new I.B8((t||[])[0]);case"struct":case"struct_":return new I._k(t||[])}switch(r){case"int":{const t=e.type;return new I.Ai(t.isSigned,t.bitWidth)}case"floatingpoint":{const t=e.type;return new I.nt(A.jA[t.precision])}case"decimal":{const t=e.type;return new I.Ww(t.scale,t.precision,t.bitWidth)}case"date":{const t=e.type;return new I.OD(A.fo[t.unit])}case"time":{const t=e.type;return new I.gX(A.yr[t.unit],t.bitWidth)}case"timestamp":{const t=e.type;return new I.Dc(A.yr[t.unit],t.timezone)}case"interval":{const t=e.type;return new I.IX(A.ad[t.unit])}case"union":{const r=e.type;return new I.gP(A.R3[r.mode],r.typeIds||[],t||[])}case"fixedsizebinary":{const t=e.type;return new I.Pv(t.byteWidth)}case"fixedsizelist":{const r=e.type;return new I.Y1(r.listSize,(t||[])[0])}case"map":{const r=e.type;return new I.WD((t||[])[0],r.keysSorted)}}throw Error('Unrecognized type: "'.concat(r,'"'))}var U=n.v2,F=n.M$,P=n.$F;class W{constructor(e,t,r,n){this._version=t,this._headerType=r,this.body=new Uint8Array(0),n&&(this._createHeader=()=>n),this._bodyLength="number"==typeof e?e:e.low}static fromJSON(e,t){const r=new W(0,A.Wg.V4,t);return r._createHeader=function(e,t){return()=>{switch(t){case A.LD.Schema:return M.S.fromJSON(e);case A.LD.RecordBatch:return z.fromJSON(e);case A.LD.DictionaryBatch:return E.fromJSON(e)}throw Error("Unrecognized Message type: { name: ".concat(A.LD[t],", type: ").concat(t," }"))}}(e,t),r}static decode(e){e=new P((0,L.toUint8Array)(e));const t=B.Q.getRootAsMessage(e),r=t.bodyLength(),n=t.version(),s=t.headerType(),c=new W(r,n,s);return c._createHeader=function(e,t){return()=>{switch(t){case A.LD.Schema:return M.S.decode(e.header(new i.S));case A.LD.RecordBatch:return z.decode(e.header(new o.g),e.version());case A.LD.DictionaryBatch:return E.decode(e.header(new a.v),e.version())}throw Error("Unrecognized Message type: { name: ".concat(A.LD[t],", type: ").concat(t," }"))}}(t,s),c}static encode(e){const t=new F;let r=-1;return e.isSchema()?r=M.S.encode(t,e.header()):e.isRecordBatch()?r=z.encode(t,e.header()):e.isDictionaryBatch()&&(r=E.encode(t,e.header())),B.Q.startMessage(t),B.Q.addVersion(t,A.Wg.V4),B.Q.addHeader(t,r),B.Q.addHeaderType(t,e.headerType),B.Q.addBodyLength(t,new U(e.bodyLength,0)),B.Q.finishMessageBuffer(t,B.Q.endMessage(t)),t.asUint8Array()}static from(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(e instanceof M.S)return new W(0,A.Wg.V4,A.LD.Schema,e);if(e instanceof z)return new W(t,A.Wg.V4,A.LD.RecordBatch,e);if(e instanceof E)return new W(t,A.Wg.V4,A.LD.DictionaryBatch,e);throw Error("Unrecognized Message header: ".concat(e))}get type(){return this.headerType}get version(){return this._version}get headerType(){return this._headerType}get bodyLength(){return this._bodyLength}header(){return this._createHeader()}isSchema(){return this.headerType===A.LD.Schema}isRecordBatch(){return this.headerType===A.LD.RecordBatch}isDictionaryBatch(){return this.headerType===A.LD.DictionaryBatch}}class z{constructor(e,t,r){this._nodes=t,this._buffers=r,this._length="number"==typeof e?e:e.low}get nodes(){return this._nodes}get length(){return this._length}get buffers(){return this._buffers}}class E{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._data=e,this._isDelta=r,this._id="number"==typeof t?t:t.low}get id(){return this._id}get data(){return this._data}get isDelta(){return this._isDelta}get length(){return this.data.length}get nodes(){return this.data.nodes}get buffers(){return this.data.buffers}}class j{constructor(e,t){this.offset="number"==typeof e?e:e.low,this.length="number"==typeof t?t:t.low}}class Q{constructor(e,t){this.length="number"==typeof e?e:e.low,this.nullCount="number"==typeof t?t:t.low}}function Z(e,t){const r=[];for(let n,i=-1,s=-1,o=e.childrenLength();++i<o;)(n=e.children(i))&&(r[++s]=M.D.decode(n,t));return r}function C(e){const t=new Map;if(e)for(let r,n,i=-1,s=Math.trunc(e.customMetadataLength());++i<s;)(r=e.customMetadata(i))&&null!=(n=r.key())&&t.set(n,r.value());return t}function Y(e){return new I.Ai(e.isSigned(),e.bitWidth())}function J(e,t){const r=e.typeType();switch(r){case u.ZU.NONE:case u.ZU.Null:return new I.Uv;case u.ZU.Binary:return new I.yI;case u.ZU.Utf8:return new I.YE;case u.ZU.Bool:return new I.x;case u.ZU.List:return new I.B8((t||[])[0]);case u.ZU.Struct_:return new I._k(t||[])}switch(r){case u.ZU.Int:{const t=e.type(new s.A);return new I.Ai(t.isSigned(),t.bitWidth())}case u.ZU.FloatingPoint:{const t=e.type(new y.$);return new I.nt(t.precision())}case u.ZU.Decimal:{const t=e.type(new _.W);return new I.Ww(t.scale(),t.precision(),t.bitWidth())}case u.ZU.Date:{const t=e.type(new g.n);return new I.OD(t.unit())}case u.ZU.Time:{const t=e.type(new m.g);return new I.gX(t.unit(),t.bitWidth())}case u.ZU.Timestamp:{const t=e.type(new w.D);return new I.Dc(t.unit(),t.timezone())}case u.ZU.Interval:{const t=e.type(new v.I);return new I.IX(t.unit())}case u.ZU.Union:{const r=e.type(new b.g);return new I.gP(r.mode(),r.typeIdsArray()||[],t||[])}case u.ZU.FixedSizeBinary:{const t=e.type(new p.P);return new I.Pv(t.byteWidth())}case u.ZU.FixedSizeList:{const r=e.type(new D.Y);return new I.Y1(r.listSize(),(t||[])[0])}case u.ZU.Map:{const r=e.type(new S.T);return new I.WD((t||[])[0],r.keysSorted())}}throw Error('Unrecognized type: "'.concat(u.ZU[r],'" (').concat(r,")"))}M.D.encode=function(e,t){let r=-1,n=-1,i=-1;const s=t.type;let o=t.typeId;I.pe.isDictionary(s)?(o=s.dictionary.typeId,i=x.K.visit(s,e),n=x.K.visit(s.dictionary,e)):n=x.K.visit(s,e);const a=(s.children||[]).map(t=>M.D.encode(e,t)),c=h.D.createChildrenVector(e,a),d=t.metadata&&t.metadata.size>0?h.D.createCustomMetadataVector(e,[...t.metadata].map(t=>{let[r,n]=t;const i=e.createString("".concat(r)),s=e.createString("".concat(n));return l.r.startKeyValue(e),l.r.addKey(e,i),l.r.addValue(e,s),l.r.endKeyValue(e)})):-1;return t.name&&(r=e.createString(t.name)),h.D.startField(e),h.D.addType(e,n),h.D.addTypeType(e,o),h.D.addChildren(e,c),h.D.addNullable(e,!!t.nullable),-1!==r&&h.D.addName(e,r),-1!==i&&h.D.addDictionary(e,i),-1!==d&&h.D.addCustomMetadata(e,d),h.D.endField(e)},M.D.decode=function(e,t){let r,n,i,s,o,a;return t&&(a=e.dictionary())?t.has(r=a.id().low)?(s=(s=a.indexType())?Y(s):new I.P_,o=new I.bT(t.get(r),s,r,a.isOrdered()),n=new M.D(e.name(),o,e.nullable(),C(e))):(s=(s=a.indexType())?Y(s):new I.P_,t.set(r,i=J(e,Z(e,t))),o=new I.bT(i,s,r,a.isOrdered()),n=new M.D(e.name(),o,e.nullable(),C(e))):(i=J(e,Z(e,t)),n=new M.D(e.name(),i,e.nullable(),C(e))),n||null},M.D.fromJSON=function(e,t){let r,n,i,s,o,a;return t&&(s=e.dictionary)?t.has(r=s.id)?(n=(n=s.indexType)?H(n):new I.P_,a=new I.bT(t.get(r),n,r,s.isOrdered),i=new M.D(e.name,a,e.nullable,N(e.customMetadata))):(n=(n=s.indexType)?H(n):new I.P_,t.set(r,o=T(e,O(e,t))),a=new I.bT(o,n,r,s.isOrdered),i=new M.D(e.name,a,e.nullable,N(e.customMetadata))):(o=T(e,O(e,t)),i=new M.D(e.name,o,e.nullable,N(e.customMetadata))),i||null},M.S.encode=function(e,t){const r=t.fields.map(t=>M.D.encode(e,t));i.S.startFieldsVector(e,r.length);const n=i.S.createFieldsVector(e,r),s=t.metadata&&t.metadata.size>0?i.S.createCustomMetadataVector(e,[...t.metadata].map(t=>{let[r,n]=t;const i=e.createString("".concat(r)),s=e.createString("".concat(n));return l.r.startKeyValue(e),l.r.addKey(e,i),l.r.addValue(e,s),l.r.endKeyValue(e)})):-1;return i.S.startSchema(e),i.S.addFields(e,n),i.S.addEndianness(e,q?f.H.Little:f.H.Big),-1!==s&&i.S.addCustomMetadata(e,s),i.S.endSchema(e)},M.S.decode=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Map;const r=function(e,t){const r=[];for(let n,i=-1,s=-1,o=e.fieldsLength();++i<o;)(n=e.fields(i))&&(r[++s]=M.D.decode(n,t));return r}(e,t);return new M.S(r,C(e),t)},M.S.fromJSON=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Map;return new M.S(function(e,t){return(e.fields||[]).filter(Boolean).map(e=>M.D.fromJSON(e,t))}(e,t),N(e.customMetadata),t)},z.encode=function(e,t){const r=t.nodes||[],n=t.buffers||[];o.g.startNodesVector(e,r.length);for(const o of r.slice().reverse())Q.encode(e,o);const i=e.endVector();o.g.startBuffersVector(e,n.length);for(const o of n.slice().reverse())j.encode(e,o);const s=e.endVector();return o.g.startRecordBatch(e),o.g.addLength(e,new U(t.length,0)),o.g.addNodes(e,i),o.g.addBuffers(e,s),o.g.endRecordBatch(e)},z.decode=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:A.Wg.V4;if(null!==e.compression())throw Error("Record batch compression not implemented");return new z(e.length(),function(e){const t=[];for(let r,n=-1,i=-1,s=e.nodesLength();++n<s;)(r=e.nodes(n))&&(t[++i]=Q.decode(r));return t}(e),function(e,t){const r=[];for(let n,i=-1,s=-1,o=e.buffersLength();++i<o;)(n=e.buffers(i))&&(t<A.Wg.V4&&(n.bb_pos+=8*(i+1)),r[++s]=j.decode(n));return r}(e,t))},z.fromJSON=R,E.encode=function(e,t){const r=z.encode(e,t.data);return a.v.startDictionaryBatch(e),a.v.addId(e,new U(t.id,0)),a.v.addIsDelta(e,t.isDelta),a.v.addData(e,r),a.v.endDictionaryBatch(e)},E.decode=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:A.Wg.V4;return new E(z.decode(e.data(),t),e.id(),e.isDelta())},E.fromJSON=function(e){return new E(R(e.data),e.id,e.isDelta)},Q.encode=function(e,t){return d.t.createFieldNode(e,new U(t.length,0),new U(t.nullCount,0))},Q.decode=function(e){return new Q(e.length(),e.nullCount())},j.encode=function(e,t){return c.h.createBuffer(e,new U(t.offset,0),new U(t.length,0))},j.decode=function(e){return new j(e.offset(),e.length())};const q=(()=>{const e=new ArrayBuffer(2);return new DataView(e).setInt16(0,256,!0),256===new Int16Array(e)[0]})()},400:(e,t,r)=>{r.d(t,{y:()=>s});var n=r(7827),i=r(2070);function s(e,t){const r=new this(e),s=new i.V8(r),o=new ReadableStream({cancel(){return(0,n.sH)(this,void 0,void 0,function*(){yield s.cancel()})},pull(e){return(0,n.sH)(this,void 0,void 0,function*(){yield a(e)})},start(e){return(0,n.sH)(this,void 0,void 0,function*(){yield a(e)})}},Object.assign({highWaterMark:16384},t));return{writable:new WritableStream(r,e),readable:o};function a(e){return(0,n.sH)(this,void 0,void 0,function*(){let t=null,r=e.desiredSize;for(;t=yield s.read(r||null);)if(e.enqueue(t),null!=r&&0>=(r-=t.byteLength))return;e.close()})}}},1987:(e,t,r)=>{r.d(t,{NW:()=>v,VN:()=>m,vs:()=>w});var n=r(7827),i=r(7585),s=r(4051),o=r(5858),a=(r(403),r(268)),c=r(5190),h=r(4908),d=r(8290),u=r(2070),l=r(8763),f=(r(2602),r(8049),r(7772)),y=r(5760),_=r(2678),g=r(3868);class m extends _.Qm{constructor(e){super(),this._position=0,this._started=!1,this._sink=new u.kb,this._schema=null,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._dictionaryDeltaOffsets=new Map,(0,g.Gv)(e)||(e={autoDestroy:!0,writeLegacyIpcFormat:!1}),this._autoDestroy="boolean"!=typeof e.autoDestroy||e.autoDestroy,this._writeLegacyIpcFormat="boolean"==typeof e.writeLegacyIpcFormat&&e.writeLegacyIpcFormat}static throughNode(e){throw Error('"throughNode" not available in this environment')}static throughDOM(e,t){throw Error('"throughDOM" not available in this environment')}toString(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._sink.toString(e)}toUint8Array(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._sink.toUint8Array(e)}writeAll(e){return(0,g.yL)(e)?e.then(e=>this.writeAll(e)):(0,g.Td)(e)?p(this,e):b(this,e)}get closed(){return this._sink.closed}[Symbol.asyncIterator](){return this._sink[Symbol.asyncIterator]()}toDOMStream(e){return this._sink.toDOMStream(e)}toNodeStream(e){return this._sink.toNodeStream(e)}close(){return this.reset()._sink.close()}abort(e){return this.reset()._sink.abort(e)}finish(){return this._autoDestroy?this.close():this.reset(this._sink,this._schema),this}reset(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._sink,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return e===this._sink||e instanceof u.kb?this._sink=e:(this._sink=new u.kb,e&&(0,g.DC)(e)?this.toDOMStream({type:"bytes"}).pipeTo(e):e&&(0,g.JO)(e)&&this.toNodeStream({objectMode:!1}).pipe(e)),this._started&&this._schema&&this._writeFooter(this._schema),this._started=!1,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._dictionaryDeltaOffsets=new Map,t&&(0,d._e)(t,this._schema)||(null==t?(this._position=0,this._schema=null):(this._started=!0,this._schema=t,this._writeSchema(t))),this}write(e){let t=null;if(!this._sink)throw Error("RecordBatchWriter is closed");if(null==e)return this.finish()&&void 0;if(e instanceof i.XI&&!(t=e.schema))return this.finish()&&void 0;if(e instanceof y.g&&!(t=e.schema))return this.finish()&&void 0;if(t&&!(0,d._e)(t,this._schema)){if(this._started&&this._autoDestroy)return this.close();this.reset(this._sink,t)}e instanceof y.g?e instanceof y.M||this._writeRecordBatch(e):e instanceof i.XI?this.writeAll(e.batches):(0,g.xZ)(e)&&this.writeAll(e)}_writeMessage(e){const t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:8)-1,r=a.QB.encode(e),n=r.byteLength,i=this._writeLegacyIpcFormat?4:8,s=n+i+t&~t,o=s-n-i;return e.headerType===h.LD.RecordBatch?this._recordBatchBlocks.push(new c.k(s,e.bodyLength,this._position)):e.headerType===h.LD.DictionaryBatch&&this._dictionaryBlocks.push(new c.k(s,e.bodyLength,this._position)),this._writeLegacyIpcFormat||this._write(Int32Array.of(-1)),this._write(Int32Array.of(s-i)),n>0&&this._write(r),this._writePadding(o)}_write(e){if(this._started){const t=(0,f.toUint8Array)(e);t&&t.byteLength>0&&(this._sink.write(t),this._position+=t.byteLength)}return this}_writeSchema(e){return this._writeMessage(a.QB.from(e))}_writeFooter(e){return this._writeLegacyIpcFormat?this._write(Int32Array.of(0)):this._write(Int32Array.of(-1,0))}_writeMagic(){return this._write(s.mS)}_writePadding(e){return e>0?this._write(new Uint8Array(e)):this}_writeRecordBatch(e){const{byteLength:t,nodes:r,bufferRegions:n,buffers:i}=l.Q.assemble(e),s=new a.g5(e.numRows,r,n),o=a.QB.from(s,t);return this._writeDictionaries(e)._writeMessage(o)._writeBodyBuffers(i)}_writeDictionaryBatch(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._dictionaryDeltaOffsets.set(t,e.length+(this._dictionaryDeltaOffsets.get(t)||0));const{byteLength:n,nodes:i,bufferRegions:s,buffers:c}=l.Q.assemble(new o.M([e])),h=new a.g5(e.length,i,s),d=new a.vc(h,t,r),u=a.QB.from(d,n);return this._writeMessage(u)._writeBodyBuffers(c)}_writeBodyBuffers(e){let t,r,n;for(let i=-1,s=e.length;++i<s;)(t=e[i])&&(r=t.byteLength)>0&&(this._write(t),(n=(r+7&-8)-r)>0&&this._writePadding(n));return this}_writeDictionaries(e){for(let[t,r]of e.dictionaries){let e=this._dictionaryDeltaOffsets.get(t)||0;if(0===e||(r=null==r?void 0:r.slice(e)).length>0)for(const n of r.data)this._writeDictionaryBatch(n,t,e>0),e+=n.length}return this}}class w extends m{static writeAll(e,t){const r=new w(t);return(0,g.yL)(e)?e.then(e=>r.writeAll(e)):(0,g.Td)(e)?p(r,e):b(r,e)}}class v extends m{static writeAll(e){const t=new v;return(0,g.yL)(e)?e.then(e=>t.writeAll(e)):(0,g.Td)(e)?p(t,e):b(t,e)}constructor(){super(),this._autoDestroy=!0}_writeSchema(e){return this._writeMagic()._writePadding(2)}_writeFooter(e){const t=c.w.encode(new c.w(e,h.Wg.V4,this._recordBatchBlocks,this._dictionaryBlocks));return super._writeFooter(e)._write(t)._write(Int32Array.of(t.byteLength))._writeMagic()}}function b(e,t){let r=t;t instanceof i.XI&&(r=t.batches,e.reset(void 0,t.schema));for(const n of r)e.write(n);return e.finish()}function p(e,t){var r,i,s,o;return(0,n.sH)(this,void 0,void 0,function*(){try{for(r=(0,n.xN)(t);!(i=yield r.next()).done;){const t=i.value;e.write(t)}}catch(a){s={error:a}}finally{try{i&&!i.done&&(o=r.return)&&(yield o.call(r))}finally{if(s)throw s.error}}return e.finish()})}},2070:(e,t,r)=>{r.d(t,{V8:()=>u,kb:()=>h,xj:()=>d});var n=r(7827),i=r(8554),s=r(4271),o=r(2678),a=r(7772),c=r(3868);class h extends o.O3{write(e){if((e=(0,a.toUint8Array)(e)).byteLength>0)return super.write(e)}toString(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?(0,s._)(this.toUint8Array(!0)):this.toUint8Array(!1).then(s._)}toUint8Array(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?(0,a.joinUint8Arrays)(this._values)[0]:(()=>(0,n.sH)(this,void 0,void 0,function*(){var e,t;const r=[];let i=0;try{for(var s,o=(0,n.xN)(this);!(s=yield o.next()).done;){const e=s.value;r.push(e),i+=e.byteLength}}catch(c){e={error:c}}finally{try{s&&!s.done&&(t=o.return)&&(yield t.call(o))}finally{if(e)throw e.error}}return(0,a.joinUint8Arrays)(r,i)[0]}))()}}class d{constructor(e){e&&(this.source=new l(i.A.fromIterable(e)))}[Symbol.iterator](){return this}next(e){return this.source.next(e)}throw(e){return this.source.throw(e)}return(e){return this.source.return(e)}peek(e){return this.source.peek(e)}read(e){return this.source.read(e)}}class u{constructor(e){e instanceof u?this.source=e.source:e instanceof h?this.source=new f(i.A.fromAsyncIterable(e)):(0,c.hy)(e)?this.source=new f(i.A.fromNodeStream(e)):(0,c.Rv)(e)?this.source=new f(i.A.fromDOMStream(e)):(0,c.es)(e)?this.source=new f(i.A.fromDOMStream(e.body)):(0,c.xZ)(e)?this.source=new f(i.A.fromIterable(e)):((0,c.yL)(e)||(0,c.Td)(e))&&(this.source=new f(i.A.fromAsyncIterable(e)))}[Symbol.asyncIterator](){return this}next(e){return this.source.next(e)}throw(e){return this.source.throw(e)}return(e){return this.source.return(e)}get closed(){return this.source.closed}cancel(e){return this.source.cancel(e)}peek(e){return this.source.peek(e)}read(e){return this.source.read(e)}}class l{constructor(e){this.source=e}cancel(e){this.return(e)}peek(e){return this.next(e,"peek").value}read(e){return this.next(e,"read").value}next(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"read";return this.source.next({cmd:t,size:e})}throw(e){return Object.create(this.source.throw&&this.source.throw(e)||o.gV)}return(e){return Object.create(this.source.return&&this.source.return(e)||o.gV)}}class f{constructor(e){this.source=e,this._closedPromise=new Promise(e=>this._closedPromiseResolve=e)}cancel(e){return(0,n.sH)(this,void 0,void 0,function*(){yield this.return(e)})}get closed(){return this._closedPromise}read(e){return(0,n.sH)(this,void 0,void 0,function*(){return(yield this.next(e,"read")).value})}peek(e){return(0,n.sH)(this,void 0,void 0,function*(){return(yield this.next(e,"peek")).value})}next(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"read";return(0,n.sH)(this,void 0,void 0,function*(){return yield this.source.next({cmd:t,size:e})})}throw(e){return(0,n.sH)(this,void 0,void 0,function*(){const t=this.source.throw&&(yield this.source.throw(e))||o.gV;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(t)})}return(e){return(0,n.sH)(this,void 0,void 0,function*(){const t=this.source.return&&(yield this.source.return(e))||o.gV;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(t)})}}},2223:(e,t,r)=>{r.d(t,{m:()=>o});var n=r(7827),i=r(7772),s=r(3868);function o(e,t){if((0,s.Td)(e))return function(e,t){let r=null;const s="bytes"===(null==t?void 0:t.type)||!1,o=(null==t?void 0:t.highWaterMark)||16777216;return new ReadableStream(Object.assign(Object.assign({},t),{start(t){return(0,n.sH)(this,void 0,void 0,function*(){yield a(t,r||(r=e[Symbol.asyncIterator]()))})},pull(e){return(0,n.sH)(this,void 0,void 0,function*(){r?yield a(e,r):e.close()})},cancel(){return(0,n.sH)(this,void 0,void 0,function*(){(null==r?void 0:r.return)&&(yield r.return()),r=null})}}),Object.assign({highWaterMark:s?o:void 0},t));function a(e,t){return(0,n.sH)(this,void 0,void 0,function*(){let r,n=null,o=e.desiredSize||null;for(;!(n=yield t.next(s?o:null)).done;)if(ArrayBuffer.isView(n.value)&&(r=(0,i.toUint8Array)(n.value))&&(null!=o&&s&&(o=o-r.byteLength+1),n.value=r),e.enqueue(n.value),null!=o&&0>=--o)return;e.close()})}}(e,t);if((0,s.xZ)(e))return function(e,t){let r=null;const n="bytes"===(null==t?void 0:t.type)||!1,s=(null==t?void 0:t.highWaterMark)||16777216;return new ReadableStream(Object.assign(Object.assign({},t),{start(t){o(t,r||(r=e[Symbol.iterator]()))},pull(e){r?o(e,r):e.close()},cancel(){(null==r?void 0:r.return)&&r.return(),r=null}}),Object.assign({highWaterMark:n?s:void 0},t));function o(e,t){let r,s=null,o=e.desiredSize||null;for(;!(s=t.next(n?o:null)).done;)if(ArrayBuffer.isView(s.value)&&(r=(0,i.toUint8Array)(s.value))&&(null!=o&&n&&(o=o-r.byteLength+1),s.value=r),e.enqueue(s.value),null!=o&&0>=--o)return;e.close()}}(e,t);throw Error("toDOMStream() must be called with an Iterable or AsyncIterable")}},2678:(e,t,r)=>{r.d(t,{Kc:()=>o,O3:()=>c,Qm:()=>a,gV:()=>s});var n=r(7827),i=r(8554);const s=Object.freeze({done:!0,value:void 0});class o{constructor(e){this._json=e}get schema(){return this._json.schema}get batches(){return this._json.batches||[]}get dictionaries(){return this._json.dictionaries||[]}}class a{tee(){return this._getDOMStream().tee()}pipe(e,t){return this._getNodeStream().pipe(e,t)}pipeTo(e,t){return this._getDOMStream().pipeTo(e,t)}pipeThrough(e,t){return this._getDOMStream().pipeThrough(e,t)}_getDOMStream(){return this._DOMStream||(this._DOMStream=this.toDOMStream())}_getNodeStream(){return this._nodeStream||(this._nodeStream=this.toNodeStream())}}class c extends a{constructor(){super(),this._values=[],this.resolvers=[],this._closedPromise=new Promise(e=>this._closedPromiseResolve=e)}get closed(){return this._closedPromise}cancel(e){return(0,n.sH)(this,void 0,void 0,function*(){yield this.return(e)})}write(e){this._ensureOpen()&&(this.resolvers.length>0?this.resolvers.shift().resolve({done:!1,value:e}):this._values.push(e))}abort(e){this._closedPromiseResolve&&(this.resolvers.length>0?this.resolvers.shift().reject({done:!0,value:e}):this._error={error:e})}close(){if(this._closedPromiseResolve){const{resolvers:e}=this;for(;e.length>0;)e.shift().resolve(s);this._closedPromiseResolve(),this._closedPromiseResolve=void 0}}[Symbol.asyncIterator](){return this}toDOMStream(e){return i.A.toDOMStream(this._closedPromiseResolve||this._error?this:this._values,e)}toNodeStream(e){return i.A.toNodeStream(this._closedPromiseResolve||this._error?this:this._values,e)}throw(e){return(0,n.sH)(this,void 0,void 0,function*(){return yield this.abort(e),s})}return(e){return(0,n.sH)(this,void 0,void 0,function*(){return yield this.close(),s})}read(e){return(0,n.sH)(this,void 0,void 0,function*(){return(yield this.next(e,"read")).value})}peek(e){return(0,n.sH)(this,void 0,void 0,function*(){return(yield this.next(e,"peek")).value})}next(){return this._values.length>0?Promise.resolve({done:!1,value:this._values.shift()}):this._error?Promise.reject({done:!0,value:this._error.error}):this._closedPromiseResolve?new Promise((e,t)=>{this.resolvers.push({resolve:e,reject:t})}):Promise.resolve(s)}_ensureOpen(){if(this._closedPromiseResolve)return!0;throw Error("AsyncQueue is closed")}}},3410:(e,t,r)=>{r.d(t,{D:()=>a,s:()=>c});var n=r(7585),i=r(3868),s=r(7991),o=r(1987);function a(e){const t=s.hb.from(e);return(0,i.yL)(t)?t.then(e=>a(e)):t.isAsync()?t.readAll().then(e=>new n.XI(e)):new n.XI(t.readAll())}function c(e){return("stream"===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"stream")?o.vs:o.NW).writeAll(e).toUint8Array(!0)}},4051:(e,t,r)=>{r.d(t,{NN:()=>p,R2:()=>w,RJ:()=>g,Yn:()=>D,_j:()=>S,mS:()=>b,mU:()=>B,vn:()=>m});var n=r(7827),i=r(4908),s=r(5217),o=r(268),a=r(3868),c=r(6724),h=r(7772),d=r(2070),u=r(2678);const l=e=>"Expected ".concat(i.LD[e]," Message in stream, but was null or length 0."),f=e=>"Header pointer of flatbuffer-encoded ".concat(i.LD[e]," Message is null or length 0."),y=(e,t)=>"Expected to read ".concat(e," metadata bytes, but only read ").concat(t,"."),_=(e,t)=>"Expected to read ".concat(e," bytes for message body, but only read ").concat(t,".");class g{constructor(e){this.source=e instanceof d.xj?e:new d.xj(e)}[Symbol.iterator](){return this}next(){let e;return(e=this.readMetadataLength()).done||-1===e.value&&(e=this.readMetadataLength()).done||(e=this.readMetadata(e.value)).done?u.gV:e}throw(e){return this.source.throw(e)}return(e){return this.source.return(e)}readMessage(e){let t;if((t=this.next()).done)return null;if(null!=e&&t.value.headerType!==e)throw Error(l(e));return t.value}readMessageBody(e){if(0>=e)return new Uint8Array(0);const t=(0,h.toUint8Array)(this.source.read(e));if(t.byteLength<e)throw Error(_(e,t.byteLength));return t.byteOffset%8!=0||t.byteOffset+t.byteLength>t.buffer.byteLength?t.slice():t}readSchema(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=i.LD.Schema,r=this.readMessage(t),n=null==r?void 0:r.header();if(e&&!n)throw Error(f(t));return n}readMetadataLength(){const e=this.source.read(v),t=e&&new s.$F(e),r=(null==t?void 0:t.readInt32(0))||0;return{done:0===r,value:r}}readMetadata(e){const t=this.source.read(e);if(!t)return u.gV;if(t.byteLength<e)throw Error(y(e,t.byteLength));return{done:!1,value:o.QB.decode(t)}}}class m{constructor(e,t){this.source=e instanceof d.V8?e:(0,a.zP)(e)?new c.o(e,t):new d.V8(e)}[Symbol.asyncIterator](){return this}next(){return(0,n.sH)(this,void 0,void 0,function*(){let e;return(e=yield this.readMetadataLength()).done||-1===e.value&&(e=yield this.readMetadataLength()).done||(e=yield this.readMetadata(e.value)).done?u.gV:e})}throw(e){return(0,n.sH)(this,void 0,void 0,function*(){return yield this.source.throw(e)})}return(e){return(0,n.sH)(this,void 0,void 0,function*(){return yield this.source.return(e)})}readMessage(e){return(0,n.sH)(this,void 0,void 0,function*(){let t;if((t=yield this.next()).done)return null;if(null!=e&&t.value.headerType!==e)throw Error(l(e));return t.value})}readMessageBody(e){return(0,n.sH)(this,void 0,void 0,function*(){if(0>=e)return new Uint8Array(0);const t=(0,h.toUint8Array)(yield this.source.read(e));if(t.byteLength<e)throw Error(_(e,t.byteLength));return t.byteOffset%8!=0||t.byteOffset+t.byteLength>t.buffer.byteLength?t.slice():t})}readSchema(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(0,n.sH)(this,void 0,void 0,function*(){const t=i.LD.Schema,r=yield this.readMessage(t),n=null==r?void 0:r.header();if(e&&!n)throw Error(f(t));return n})}readMetadataLength(){return(0,n.sH)(this,void 0,void 0,function*(){const e=yield this.source.read(v),t=e&&new s.$F(e),r=(null==t?void 0:t.readInt32(0))||0;return{done:0===r,value:r}})}readMetadata(e){return(0,n.sH)(this,void 0,void 0,function*(){const t=yield this.source.read(e);if(!t)return u.gV;if(t.byteLength<e)throw Error(y(e,t.byteLength));return{done:!1,value:o.QB.decode(t)}})}}class w extends g{constructor(e){super(new Uint8Array(0)),this._schema=!1,this._body=[],this._batchIndex=0,this._dictionaryIndex=0,this._json=e instanceof u.Kc?e:new u.Kc(e)}next(){const{_json:e}=this;if(!this._schema)return this._schema=!0,{done:!1,value:o.QB.fromJSON(e.schema,i.LD.Schema)};if(this._dictionaryIndex<e.dictionaries.length){const t=e.dictionaries[this._dictionaryIndex++];return this._body=t.data.columns,{done:!1,value:o.QB.fromJSON(t,i.LD.DictionaryBatch)}}if(this._batchIndex<e.batches.length){const t=e.batches[this._batchIndex++];return this._body=t.columns,{done:!1,value:o.QB.fromJSON(t,i.LD.RecordBatch)}}return this._body=[],u.gV}readMessageBody(e){return function e(t){return(t||[]).reduce((t,r)=>[...t,...r.VALIDITY&&[r.VALIDITY]||[],...r.TYPE&&[r.TYPE]||[],...r.OFFSET&&[r.OFFSET]||[],...r.DATA&&[r.DATA]||[],...e(r.children)],[])}(this._body)}readMessage(e){let t;if((t=this.next()).done)return null;if(null!=e&&t.value.headerType!==e)throw Error(l(e));return t.value}readSchema(){const e=i.LD.Schema,t=this.readMessage(e),r=null==t?void 0:t.header();if(!t||!r)throw Error(f(e));return r}}const v=4,b=new Uint8Array(6);for(let M=0;6>M;M+=1)b[M]="ARROW1".codePointAt(M);function p(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let r=-1,n=b.length;++r<n;)if(b[r]!==e[t+r])return!1;return!0}const D=b.length,S=D+v,B=2*D+v},5190:(e,t,r)=>{r.d(t,{k:()=>y,w:()=>l});var n=r(5089),i=r(1763),s=r(5217),o=r(462),a=r(4908),c=r(7772),h=s.v2,d=s.M$,u=s.$F;class l{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.Wg.V4,r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;this.schema=e,this.version=t,r&&(this._recordBatches=r),n&&(this._dictionaryBatches=n)}static decode(e){e=new u((0,c.toUint8Array)(e));const t=i.w.getRootAsFooter(e),r=o.S.decode(t.schema());return new f(r,t)}static encode(e){const t=new d,r=o.S.encode(t,e.schema);i.w.startRecordBatchesVector(t,e.numRecordBatches);for(const i of[...e.recordBatches()].slice().reverse())y.encode(t,i);const n=t.endVector();i.w.startDictionariesVector(t,e.numDictionaries);for(const i of[...e.dictionaryBatches()].slice().reverse())y.encode(t,i);const s=t.endVector();return i.w.startFooter(t),i.w.addSchema(t,r),i.w.addVersion(t,a.Wg.V4),i.w.addRecordBatches(t,n),i.w.addDictionaries(t,s),i.w.finishFooterBuffer(t,i.w.endFooter(t)),t.asUint8Array()}get numRecordBatches(){return this._recordBatches.length}get numDictionaries(){return this._dictionaryBatches.length}*recordBatches(){for(let e,t=-1,r=this.numRecordBatches;++t<r;)(e=this.getRecordBatch(t))&&(yield e)}*dictionaryBatches(){for(let e,t=-1,r=this.numDictionaries;++t<r;)(e=this.getDictionaryBatch(t))&&(yield e)}getRecordBatch(e){return e>=0&&e<this.numRecordBatches&&this._recordBatches[e]||null}getDictionaryBatch(e){return e>=0&&e<this.numDictionaries&&this._dictionaryBatches[e]||null}}class f extends l{constructor(e,t){super(e,t.version()),this._footer=t}get numRecordBatches(){return this._footer.recordBatchesLength()}get numDictionaries(){return this._footer.dictionariesLength()}getRecordBatch(e){if(e>=0&&e<this.numRecordBatches){const t=this._footer.recordBatches(e);if(t)return y.decode(t)}return null}getDictionaryBatch(e){if(e>=0&&e<this.numDictionaries){const t=this._footer.dictionaries(e);if(t)return y.decode(t)}return null}}class y{constructor(e,t,r){this.metaDataLength=e,this.offset="number"==typeof r?r:r.low,this.bodyLength="number"==typeof t?t:t.low}static decode(e){return new y(e.metaDataLength(),e.bodyLength(),e.offset())}static encode(e,t){const{metaDataLength:r}=t,i=new h(t.offset,0),s=new h(t.bodyLength,0);return n.e.createBlock(e,i,r,s)}}},7991:(e,t,r)=>{r.d(t,{fW:()=>w,hb:()=>m,t2:()=>b});var n=r(7827),i=r(835),s=r(5858),o=r(403),a=r(4908),c=r(5190),h=r(8554),d=r(2070),u=r(6724),l=r(8194),f=r(5760),y=r(2678),_=r(4051),g=r(3868);class m extends y.Qm{constructor(e){super(),this._impl=e}get closed(){return this._impl.closed}get schema(){return this._impl.schema}get autoDestroy(){return this._impl.autoDestroy}get dictionaries(){return this._impl.dictionaries}get numDictionaries(){return this._impl.numDictionaries}get numRecordBatches(){return this._impl.numRecordBatches}get footer(){return this._impl.isFile()?this._impl.footer:null}isSync(){return this._impl.isSync()}isAsync(){return this._impl.isAsync()}isFile(){return this._impl.isFile()}isStream(){return this._impl.isStream()}next(){return this._impl.next()}throw(e){return this._impl.throw(e)}return(e){return this._impl.return(e)}cancel(){return this._impl.cancel()}reset(e){return this._impl.reset(e),this._DOMStream=void 0,this._nodeStream=void 0,this}open(e){const t=this._impl.open(e);return(0,g.yL)(t)?t.then(()=>this):this}readRecordBatch(e){return this._impl.isFile()?this._impl.readRecordBatch(e):null}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}toDOMStream(){return h.A.toDOMStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this})}toNodeStream(){return h.A.toNodeStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this},{objectMode:!0})}static throughNode(e){throw Error('"throughNode" not available in this environment')}static throughDOM(e,t){throw Error('"throughDOM" not available in this environment')}static from(e){return e instanceof m?e:(0,g.qO)(e)?function(e){return new w(new A(e))}(e):(0,g.zP)(e)?function(e){return(0,n.sH)(this,void 0,void 0,function*(){const{size:t}=yield e.stat(),r=new u.o(e,t);return t>=_.mU&&(0,_.NN)(yield r.readAt(0,_.Yn+7&-8))?new p(new L(r)):new v(new B(r))})}(e):(0,g.yL)(e)?(()=>(0,n.sH)(this,void 0,void 0,function*(){return yield m.from(yield e)}))():(0,g.es)(e)||(0,g.Rv)(e)||(0,g.hy)(e)||(0,g.Td)(e)?function(e){return(0,n.sH)(this,void 0,void 0,function*(){const t=yield e.peek(_.Yn+7&-8);return t&&t.byteLength>=4?(0,_.NN)(t)?new b(new M(yield e.read())):new v(new B(e)):new v(new B(function(){return(0,n.AQ)(this,arguments,function*(){})}()))})}(new d.V8(e)):function(e){const t=e.peek(_.Yn+7&-8);return t&&t.byteLength>=4?(0,_.NN)(t)?new b(new M(e.read())):new w(new S(e)):new w(new S(function*(){}()))}(new d.xj(e))}static readAll(e){return e instanceof m?e.isSync()?I(e):R(e):(0,g.qO)(e)||ArrayBuffer.isView(e)||(0,g.xZ)(e)||(0,g.o_)(e)?I(e):R(e)}}class w extends m{constructor(e){super(e),this._impl=e}readAll(){return[...this]}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return(0,n.AQ)(this,arguments,function*(){yield(0,n.N3)(yield*(0,n.Me)((0,n.xN)(this[Symbol.iterator]())))})}}class v extends m{constructor(e){super(e),this._impl=e}readAll(){var e,t;return(0,n.sH)(this,void 0,void 0,function*(){const r=[];try{for(var i,s=(0,n.xN)(this);!(i=yield s.next()).done;){const e=i.value;r.push(e)}}catch(o){e={error:o}}finally{try{i&&!i.done&&(t=s.return)&&(yield t.call(s))}finally{if(e)throw e.error}}return r})}[Symbol.iterator](){throw Error("AsyncRecordBatchStreamReader is not Iterable")}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}}class b extends w{constructor(e){super(e),this._impl=e}}class p extends v{constructor(e){super(e),this._impl=e}}class D{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Map;this.closed=!1,this.autoDestroy=!0,this._dictionaryIndex=0,this._recordBatchIndex=0,this.dictionaries=e}get numDictionaries(){return this._dictionaryIndex}get numRecordBatches(){return this._recordBatchIndex}isSync(){return!1}isAsync(){return!1}isFile(){return!1}isStream(){return!1}reset(e){return this._dictionaryIndex=0,this._recordBatchIndex=0,this.schema=e,this.dictionaries=new Map,this}_loadRecordBatch(e,t){const r=this._loadVectors(e,t,this.schema.fields),n=(0,i.Hg)({type:new o._k(this.schema.fields),length:e.length,children:r});return new f.g(this.schema,n)}_loadDictionaryBatch(e,t){const{id:r,isDelta:n}=e,{dictionaries:i,schema:o}=this,a=i.get(r);if(n||!a){const i=o.dictionaries.get(r),c=this._loadVectors(e.data,t,[i]);return(a&&n?a.concat(new s.M(c)):new s.M(c)).memoize()}return a.memoize()}_loadVectors(e,t,r){return new l.P(t,e.nodes,e.buffers,this.dictionaries).visitMany(r)}}class S extends D{constructor(e,t){super(t),this._reader=(0,g.qO)(e)?new _.R2(this._handle=e):new _.RJ(this._handle=e)}isSync(){return!0}isStream(){return!0}[Symbol.iterator](){return this}cancel(){!this.closed&&(this.closed=!0)&&(this.reset()._reader.return(),this._reader=null,this.dictionaries=null)}open(e){return this.closed||(this.autoDestroy=x(this,e),this.schema||(this.schema=this._reader.readSchema())||this.cancel()),this}throw(e){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.throw(e):y.gV}return(e){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.return(e):y.gV}next(){if(this.closed)return y.gV;let e;const{_reader:t}=this;for(;e=this._readNextMessageAndValidate();)if(e.isSchema())this.reset(e.header());else{if(e.isRecordBatch()){this._recordBatchIndex++;const r=e.header(),n=t.readMessageBody(e.bodyLength);return{done:!1,value:this._loadRecordBatch(r,n)}}if(e.isDictionaryBatch()){this._dictionaryIndex++;const r=e.header(),n=t.readMessageBody(e.bodyLength),i=this._loadDictionaryBatch(r,n);this.dictionaries.set(r.id,i)}}return this.schema&&0===this._recordBatchIndex?(this._recordBatchIndex++,{done:!1,value:new f.M(this.schema)}):this.return()}_readNextMessageAndValidate(e){return this._reader.readMessage(e)}}class B extends D{constructor(e,t){super(t),this._reader=new _.vn(this._handle=e)}isAsync(){return!0}isStream(){return!0}[Symbol.asyncIterator](){return this}cancel(){return(0,n.sH)(this,void 0,void 0,function*(){!this.closed&&(this.closed=!0)&&(yield this.reset()._reader.return(),this._reader=null,this.dictionaries=null)})}open(e){return(0,n.sH)(this,void 0,void 0,function*(){return this.closed||(this.autoDestroy=x(this,e),this.schema||(this.schema=yield this._reader.readSchema())||(yield this.cancel())),this})}throw(e){return(0,n.sH)(this,void 0,void 0,function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.throw(e):y.gV})}return(e){return(0,n.sH)(this,void 0,void 0,function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.return(e):y.gV})}next(){return(0,n.sH)(this,void 0,void 0,function*(){if(this.closed)return y.gV;let e;const{_reader:t}=this;for(;e=yield this._readNextMessageAndValidate();)if(e.isSchema())yield this.reset(e.header());else{if(e.isRecordBatch()){this._recordBatchIndex++;const r=e.header(),n=yield t.readMessageBody(e.bodyLength);return{done:!1,value:this._loadRecordBatch(r,n)}}if(e.isDictionaryBatch()){this._dictionaryIndex++;const r=e.header(),n=yield t.readMessageBody(e.bodyLength),i=this._loadDictionaryBatch(r,n);this.dictionaries.set(r.id,i)}}return this.schema&&0===this._recordBatchIndex?(this._recordBatchIndex++,{done:!1,value:new f.M(this.schema)}):yield this.return()})}_readNextMessageAndValidate(e){return(0,n.sH)(this,void 0,void 0,function*(){return yield this._reader.readMessage(e)})}}class M extends S{constructor(e,t){super(e instanceof u.S?e:new u.S(e),t)}get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}isSync(){return!0}isFile(){return!0}open(e){if(!this.closed&&!this._footer){this.schema=(this._footer=this._readFooter()).schema;for(const e of this._footer.dictionaryBatches())e&&this._readDictionaryBatch(this._dictionaryIndex++)}return super.open(e)}readRecordBatch(e){var t;if(this.closed)return null;this._footer||this.open();const r=null===(t=this._footer)||void 0===t?void 0:t.getRecordBatch(e);if(r&&this._handle.seek(r.offset)){const e=this._reader.readMessage(a.LD.RecordBatch);if(null==e?void 0:e.isRecordBatch()){const t=e.header(),r=this._reader.readMessageBody(e.bodyLength);return this._loadRecordBatch(t,r)}}return null}_readDictionaryBatch(e){var t;const r=null===(t=this._footer)||void 0===t?void 0:t.getDictionaryBatch(e);if(r&&this._handle.seek(r.offset)){const e=this._reader.readMessage(a.LD.DictionaryBatch);if(null==e?void 0:e.isDictionaryBatch()){const t=e.header(),r=this._reader.readMessageBody(e.bodyLength),n=this._loadDictionaryBatch(t,r);this.dictionaries.set(t.id,n)}}}_readFooter(){const{_handle:e}=this,t=e.size-_._j,r=e.readInt32(t),n=e.readAt(t-r,r);return c.w.decode(n)}_readNextMessageAndValidate(e){var t;if(this._footer||this.open(),this._footer&&this._recordBatchIndex<this.numRecordBatches){const r=null===(t=this._footer)||void 0===t?void 0:t.getRecordBatch(this._recordBatchIndex);if(r&&this._handle.seek(r.offset))return this._reader.readMessage(e)}return null}}class L extends B{constructor(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;t>n;n++)r[n-1]=arguments[n];const i="number"!=typeof r[0]?r.shift():void 0,s=r[0]instanceof Map?r.shift():void 0;super(e instanceof u.o?e:new u.o(e,i),s)}get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}isFile(){return!0}isAsync(){return!0}open(e){const t=Object.create(null,{open:{get:()=>super.open}});return(0,n.sH)(this,void 0,void 0,function*(){if(!this.closed&&!this._footer){this.schema=(this._footer=yield this._readFooter()).schema;for(const e of this._footer.dictionaryBatches())e&&(yield this._readDictionaryBatch(this._dictionaryIndex++))}return yield t.open.call(this,e)})}readRecordBatch(e){var t;return(0,n.sH)(this,void 0,void 0,function*(){if(this.closed)return null;this._footer||(yield this.open());const r=null===(t=this._footer)||void 0===t?void 0:t.getRecordBatch(e);if(r&&(yield this._handle.seek(r.offset))){const e=yield this._reader.readMessage(a.LD.RecordBatch);if(null==e?void 0:e.isRecordBatch()){const t=e.header(),r=yield this._reader.readMessageBody(e.bodyLength);return this._loadRecordBatch(t,r)}}return null})}_readDictionaryBatch(e){var t;return(0,n.sH)(this,void 0,void 0,function*(){const r=null===(t=this._footer)||void 0===t?void 0:t.getDictionaryBatch(e);if(r&&(yield this._handle.seek(r.offset))){const e=yield this._reader.readMessage(a.LD.DictionaryBatch);if(null==e?void 0:e.isDictionaryBatch()){const t=e.header(),r=yield this._reader.readMessageBody(e.bodyLength),n=this._loadDictionaryBatch(t,r);this.dictionaries.set(t.id,n)}}})}_readFooter(){return(0,n.sH)(this,void 0,void 0,function*(){const{_handle:e}=this;e._pending&&(yield e._pending);const t=e.size-_._j,r=yield e.readInt32(t),n=yield e.readAt(t-r,r);return c.w.decode(n)})}_readNextMessageAndValidate(e){return(0,n.sH)(this,void 0,void 0,function*(){if(this._footer||(yield this.open()),this._footer&&this._recordBatchIndex<this.numRecordBatches){const t=this._footer.getRecordBatch(this._recordBatchIndex);if(t&&(yield this._handle.seek(t.offset)))return yield this._reader.readMessage(e)}return null})}}class A extends S{constructor(e,t){super(e,t)}_loadVectors(e,t,r){return new l.n(t,e.nodes,e.buffers,this.dictionaries).visitMany(r)}}function x(e,t){return t&&"boolean"==typeof t.autoDestroy?t.autoDestroy:e.autoDestroy}function*I(e){const t=m.from(e);try{if(!t.open({autoDestroy:!1}).closed)do{yield t}while(!t.reset().open().closed)}finally{t.cancel()}}function R(e){return(0,n.AQ)(this,arguments,function*(){const t=yield(0,n.N3)(m.from(e));try{if(!(yield(0,n.N3)(t.open({autoDestroy:!1}))).closed)do{yield yield(0,n.N3)(t)}while(!(yield(0,n.N3)(t.reset().open())).closed)}finally{yield(0,n.N3)(t.cancel())}})}},8196:(e,t,r)=>{r.d(t,{m:()=>o});var n=r(7827),i=r(2070),s=r(7991);function o(e,t){const r=new i.kb;let o=null;const a=new ReadableStream({cancel(){return(0,n.sH)(this,void 0,void 0,function*(){yield r.close()})},start(e){return(0,n.sH)(this,void 0,void 0,function*(){yield c(e,o||(o=yield function(){return(0,n.sH)(this,void 0,void 0,function*(){return yield(yield s.hb.from(r)).open(t)})}()))})},pull(e){return(0,n.sH)(this,void 0,void 0,function*(){o?yield c(e,o):e.close()})}});return{writable:new WritableStream(r,Object.assign({highWaterMark:16384},e)),readable:a};function c(e,t){return(0,n.sH)(this,void 0,void 0,function*(){let r=e.desiredSize,n=null;for(;!(n=yield t.next()).done;)if(e.enqueue(n.value),null!=r&&0>=--r)return;e.close()})}}},9654:(e,t,r)=>{r.d(t,{h:()=>s});var n=r(7827),i=r(1295);function s(e){return new o(e)}class o{constructor(e){this._numChunks=0,this._finished=!1,this._bufferedSize=0;const{readableStrategy:t,writableStrategy:r,queueingStrategy:s="count"}=e,o=(0,n.Tt)(e,["readableStrategy","writableStrategy","queueingStrategy"]);this._controller=null,this._builder=(0,i.k8)(o),this._getSize="bytes"!==s?a:c;const{highWaterMark:h=("bytes"===s?16384:1e3)}=Object.assign({},t),{highWaterMark:d=("bytes"===s?16384:1e3)}=Object.assign({},r);this.readable=new ReadableStream({cancel:()=>{this._builder.clear()},pull:e=>{this._maybeFlush(this._builder,this._controller=e)},start:e=>{this._maybeFlush(this._builder,this._controller=e)}},{highWaterMark:h,size:"bytes"!==s?a:c}),this.writable=new WritableStream({abort:()=>{this._builder.clear()},write:()=>{this._maybeFlush(this._builder,this._controller)},close:()=>{this._maybeFlush(this._builder.finish(),this._controller)}},{highWaterMark:d,size:e=>this._writeValueAndReturnChunkSize(e)})}_writeValueAndReturnChunkSize(e){const t=this._bufferedSize;return this._bufferedSize=this._getSize(this._builder.append(e)),this._bufferedSize-t}_maybeFlush(e,t){null!=t&&(this._bufferedSize<t.desiredSize||++this._numChunks&&this._enqueue(t,e.toVector()),e.finished&&((e.length>0||0===this._numChunks)&&++this._numChunks&&this._enqueue(t,e.toVector()),!this._finished&&(this._finished=!0)&&this._enqueue(t,null)))}_enqueue(e,t){this._bufferedSize=0,this._controller=null,null==t?e.close():e.enqueue(t)}}const a=e=>{var t;return null!==(t=null==e?void 0:e.length)&&void 0!==t?t:0},c=e=>{var t;return null!==(t=null==e?void 0:e.byteLength)&&void 0!==t?t:0}}}]);