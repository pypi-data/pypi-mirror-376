"use strict";(self.webpackChunkstreamlit_lightweight_charts_pro=self.webpackChunkstreamlit_lightweight_charts_pro||[]).push([[315],{2250:(e,t,n)=>{n.d(t,{T:()=>a});var r=n(9950),i=n(4414);const a=e=>{let{paneId:t,isCollapsed:n,onClick:a,config:o}=e;const[c,s]=r.useState(!1),l=o.buttonSize||16,u=o.buttonColor||"#787B86",d=o.buttonBackground||"rgba(255, 255, 255, 0.9)",h=o.buttonBorderRadius||3,p=o.buttonHoverColor||"#131722",f=o.buttonHoverBackground||"rgba(255, 255, 255, 1)",g={position:"absolute",width:"".concat(l,"px"),height:"".concat(l,"px"),background:c?f:d,border:"1px solid ".concat(c?p:u),borderRadius:"".concat(h,"px"),cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"10px",fontWeight:"bold",color:c?p:u,zIndex:1e3,transition:"all 0.2s ease",userSelect:"none"};return(0,i.jsx)("div",{className:"pane-collapse-button",style:g,onMouseEnter:()=>{s(!0)},onMouseLeave:()=>{s(!1)},onClick:e=>{e.preventDefault(),e.stopPropagation(),a()},children:n?"+":"âˆ’"})}},7812:(e,t,n)=>{n.d(t,{f:()=>a});var r=n(9950),i=n(4414);const a=e=>{var t;let{legendConfig:n,isPanePrimitive:a=!1}=e;const[o,c]=(0,r.useState)(null===(t=n.visible)||void 0===t||t),s=(0,r.useRef)(null);if((0,r.useEffect)(()=>{var e;c(null===(e=n.visible)||void 0===e||e)},[n.visible]),!o)return null;const l=n.text?(e=>{try{const t=document.createElement("div");t.innerHTML=e;let n=t.textContent||t.innerText||"";return n.trim()||(n=e.replace(/<[^>]*>/g,"").trim()),n}catch(t){return e.replace(/<[^>]*>/g,"").trim()}})(n.text):"";return(0,i.jsx)("div",{ref:s,className:"pane-legend",style:{position:"absolute",top:0,left:0,zIndex:n.zIndex||1e3,pointerEvents:"none",overflow:"visible"},"data-debug":"legend",children:n.text?(0,i.jsx)("div",{"data-legend-text":!0,dangerouslySetInnerHTML:{__html:n.text},"aria-label":l,style:{display:"block",color:n.textColor}}):(0,i.jsx)("span",{style:{color:"#666",fontStyle:"italic"},children:"No content"})})}},9665:(e,t,n)=>{n.d(t,{BV:()=>c,Mu:()=>o,Qu:()=>s,Yf:()=>i,i4:()=>a,zb:()=>l});const r={legend:{top:20,right:20,bottom:20,left:20},pane:{top:10,right:10,bottom:10,left:10},content:{top:5,right:5,bottom:5,left:5},tooltip:{top:10,right:10,bottom:10,left:10}},i={timeAxis:{defaultHeight:35,minHeight:25,maxHeight:50},priceScale:{defaultWidth:70,minWidth:50,maxWidth:100,rightScaleDefaultWidth:0},legend:{defaultHeight:80,minHeight:60,maxHeight:120,defaultWidth:200,minWidth:150},pane:{defaultHeight:200,minHeight:100,maxHeight:1e3},chart:{defaultWidth:800,defaultHeight:600,minWidth:300,minHeight:200}},a={paneHeight:200,paneWidth:800,chartWidth:800,chartHeight:600,timeScaleHeight:35,priceScaleWidth:70,containerWidth:800,containerHeight:600},o={background:0,chart:1,pane:10,series:20,overlay:30,legend:40,tooltip:50,modal:100},c={cacheExpiration:5e3,debounceDelay:100,throttleDelay:50,animationDuration:200};function s(e){return r[e]||r.content}function l(e){return a[e]||0}},9916:(e,t,n)=>{n.d(t,{A:()=>v});var r=n(2555),i=n(9950),a=n(559),o=n(3254),c=n(2578),s=n(7885),l=n(2587),u=n(1443),d=n(9107),h=(n(7008),n(7866)),p=n(2963),f=n(6403),g=n(4414);class y extends i.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){this.props.onError&&this.props.onError(e,t)}render(){return this.state.hasError?this.props.fallback?this.props.fallback:(0,g.jsxs)("div",{style:{padding:"20px",border:"1px solid #ff6b6b",borderRadius:"8px",backgroundColor:"#fff5f5",color:"#d63031",textAlign:"center",margin:"10px 0"},children:[(0,g.jsx)("h3",{children:"Chart Error"}),(0,g.jsx)("p",{children:"Something went wrong while rendering the chart."}),(0,g.jsx)("button",{onClick:()=>this.setState({hasError:!1,error:void 0}),style:{padding:"8px 16px",backgroundColor:"#ff6b6b",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",marginTop:"10px"},children:"Try Again"})]}):this.props.children}}const m=(e,t)=>{if(!t||0===t.length)return null;let n=null,r=1/0;for(const i of t){if(!i.time)continue;let t=null;if("number"==typeof i.time)t=i.time>1e12?Math.floor(i.time/1e3):i.time;else if("string"==typeof i.time){const e=new Date(i.time).getTime();isNaN(e)||(t=Math.floor(e/1e3))}if(null===t)continue;const a=Math.abs(t-e);r>a&&(r=a,n=t)}return n},w=async(e,t,n,r,i)=>{if(t.legend&&t.legend.visible)try{const i=t.paneId||0,a=(0,d.V)(i,r,n,t.legend);window.legendPrimitives||(window.legendPrimitives={});const o="".concat(n,"-").concat(r);window.legendPrimitives[o]=a;const c=e.panes();i<c.length&&c[i].attachPrimitive(a)}catch(a){}},v=i.memo(e=>{let{config:t,height:d=400,width:v=null,onChartsReady:b}=e;const C=(0,i.useRef)({}),x=(0,i.useRef)({}),S=(0,i.useRef)({}),P=(0,i.useRef)({}),k=(0,i.useRef)(null),E=(0,i.useRef)({}),R=(0,i.useRef)(!1),T=(0,i.useRef)(!1),A=(0,i.useRef)(null),I=(0,i.useRef)(null),M=(0,i.useRef)(null),O=(0,i.useRef)({}),j=(0,i.useRef)({}),L=(0,i.useRef)({addTradeVisualization:null,addAnnotations:null,addModularTooltip:null,addAnnotationLayers:null,addRangeSwitcher:null,addLegend:null,updateLegendPositions:null,setupAutoSizing:null,setupChartSynchronization:null,setupFitContent:null,setupPaneCollapseSupport:null,cleanupCharts:null}),z=(0,i.useCallback)(e=>{const t=e.getBoundingClientRect();return{width:t.width,height:t.height}},[]),H=(0,i.useCallback)((e,t,n,r)=>{j.current[e]&&clearTimeout(j.current[e]),j.current[e]=setTimeout(()=>{try{var e,i;const a=z(n),o=r.autoWidth?a.width:(null===(e=r.chart)||void 0===e?void 0:e.width)||v,c=(null===(i=r.chart)||void 0===i?void 0:i.height)||(r.autoHeight?a.height:d)||a.height;t.resize(o,c)}catch(a){}},100)},[v,d,z]),F=(0,i.useCallback)((e,t,n)=>{if(n.autoSize||n.autoWidth||n.autoHeight){const r=e.chartElement().id||"default",i="undefined"!=typeof ResizeObserver?new ResizeObserver(()=>{H(r,e,t,n)}):null;i&&"function"==typeof i.observe&&i.observe(t),k.current=i}},[H]),W=(0,i.useCallback)(function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;C.current[t]||(C.current[t]=e);const i=(e,t)=>t.time&&t.seriesData.get(e)||null;if(n.crosshair){if(!e._storageListenerAdded){let n=0;const i=50,a=a=>{if("chart_sync_data"===a.key&&a.newValue)try{const c=JSON.parse(a.newValue);if(c.chartId!==t&&c.groupId===r&&"crosshair"===c.type){const r=Date.now();if(i>r-n)return;if(n=r,c.time&&c.value){var o;const n=null===(o=x.current[t])||void 0===o?void 0:o[0];n&&(e._isExternalSync=!0,e.setCrosshairPosition(c.value,c.time,n),setTimeout(()=>{e._isExternalSync=!1},100))}}}catch(a){}};window.addEventListener("storage",a),e._storageListenerAdded=!0}e.subscribeCrosshairMove(n=>{if(e._isExternalSync)return;const a=x.current[t]||[];if(Object.entries(window.chartApiMap||{}).forEach(e=>{let[o,c]=e;if(o!==t&&c)try{var s;if(((null===(s=window.chartGroupMap)||void 0===s?void 0:s[o])||0)===r&&n.time){var l;const e=(null===(l=window.seriesRefsMap)||void 0===l?void 0:l[o])||[];if(a.length>0&&e.length>0){const t=i(a[0],n);((e,t,n)=>{n?e.setCrosshairPosition(n.value,n.time,t):e.clearCrosshairPosition()})(c,e[0],t)}}}catch(u){}}),n.time&&a.length>0){const e=i(a[0],n),c={time:n.time,value:e?e.value:null,chartId:t,groupId:r,timestamp:Date.now(),type:"crosshair"};try{localStorage.setItem("chart_sync_data",JSON.stringify(c))}catch(o){}}})}if(n.timeRange){const n=e.timeScale();if(n){if(!e._timeRangeStorageListenerAdded){let n=0;const i=100,a=a=>{if("chart_time_range_sync"===a.key&&a.newValue)try{const o=JSON.parse(a.newValue);if(o.chartId!==t&&o.groupId===r&&"timeRange"===o.type){const t=Date.now();if(i>t-n)return;if(n=t,o.timeRange){const t=e.timeScale();t&&(e._isExternalTimeRangeSync=!0,t.setVisibleLogicalRange(o.timeRange),setTimeout(()=>{e._isExternalTimeRangeSync=!1},150))}}}catch(a){}};window.addEventListener("storage",a),e._timeRangeStorageListenerAdded=!0}n.subscribeVisibleLogicalRangeChange(n=>{if(!e._isExternalTimeRangeSync&&(Object.entries(window.chartApiMap||{}).forEach(e=>{let[i,a]=e;if(i!==t&&a)try{var o;if(((null===(o=window.chartGroupMap)||void 0===o?void 0:o[i])||0)===r){const e=a.timeScale();e&&n&&e.setVisibleLogicalRange(n)}}catch(c){}}),n)){const e={timeRange:n,chartId:t,groupId:r,timestamp:Date.now(),type:"timeRange"};try{localStorage.setItem("chart_time_range_sync",JSON.stringify(e))}catch(i){}}})}}},[]),D=(0,i.useCallback)((e,t,n)=>{try{window.paneWrappers=window.paneWrappers||{},window.paneWrappers[t]={},window.chartInstances=window.chartInstances||{},window.chartInstances[t]=e}catch(r){}},[]),$=(0,i.useCallback)((e,t)=>{var n,r,i,a,o,c;if(!e||"function"!=typeof e.timeScale)return;const s=e.timeScale();if(!s)return;let l=0;if(!1!==(null===(n=t.chart)||void 0===n||null===(r=n.timeScale)||void 0===r?void 0:r.fitContentOnLoad)&&!1!==(null===(i=t.chart)||void 0===i?void 0:i.fitContentOnLoad)){const e=async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(50>t)try{if(0===Object.values(x.current).flat().length)return void setTimeout(()=>e(t+1),100);const n=s.getVisibleRange();n&&n.from&&n.to?s.fitContent():setTimeout(async()=>{try{s.fitContent()}catch(e){}},100)}catch(n){}};A.current&&clearTimeout(A.current),A.current=setTimeout(async()=>{await e()},1e3)}!1!==(null===(a=t.chart)||void 0===a||null===(o=a.timeScale)||void 0===o?void 0:o.handleDoubleClick)&&!1!==(null===(c=t.chart)||void 0===c?void 0:c.handleDoubleClick)&&e.subscribeClick(e=>{const t=Date.now();if(300>t-l){try{s.fitContent()}catch(n){}l=0}else l=t})},[]),_=(0,i.useCallback)(()=>{if(null!==M.current&&(T.current=!0),Object.values(j.current).forEach(e=>{e&&clearTimeout(e)}),j.current={},A.current&&(clearTimeout(A.current),A.current=null),I.current&&(clearTimeout(I.current),I.current=null),k.current){try{k.current.disconnect()}catch(t){}k.current=null}Object.entries(S.current).forEach(e=>{let[n,r]=e;try{r.destroy()}catch(t){}}),Object.values(E.current).forEach(e=>{try{e.disconnect()}catch(t){}}),window.paneCollapsePlugins&&(Object.entries(window.paneCollapsePlugins).forEach(e=>{let[n,r]=e;Array.isArray(r)&&r.forEach(e=>{try{e&&"function"==typeof e.detached&&e.detached()}catch(t){}})}),window.paneCollapsePlugins={});const e=u.Y.getInstance();Object.keys(C.current).forEach(t=>{e.unregisterChart(t)}),Object.values(C.current).forEach(e=>{try{e&&"function"==typeof e.remove&&e.remove()}catch(t){}}),C.current={},x.current={},S.current={},P.current={},E.current={},O.current={},R.current=!1},[]),V=(0,i.useCallback)(async(e,t,n,r,i)=>{if(n&&0!==n.length)try{const e=[];if("rectangles"===r.style||"both"===r.style){const t=n.map((e,t)=>{const n="string"==typeof e.entryTime?Math.floor(new Date(e.entryTime).getTime()/1e3):e.entryTime,a="string"==typeof e.exitTime?Math.floor(new Date(e.exitTime).getTime()/1e3):e.exitTime;let o=n,s=a;if(i&&i.length>0){const e=m(n,i),t=m(a,i);e&&(o=e),t&&(s=t)}let l="";if(!1!==r.rectangleShowText){const t=[];if(!1!==r.showTradeId&&e.id&&t.push("ID: ".concat(e.id)),!1!==r.showQuantity&&e.quantity&&t.push("Qty: ".concat(e.quantity)),!1!==r.showTradeType){const n=e.isProfitable?"Profit":"Loss";t.push(n)}e.pnl?t.push("P&L: ".concat(e.pnl.toFixed(2))):e.pnlPercentage&&t.push("P&L: ".concat(e.pnlPercentage.toFixed(1),"%")),l=t.length>0?t.join(" | "):e.notes||e.text||""}const u={time1:o,time2:s,price1:e.entryPrice,price2:e.exitPrice,fillColor:e.isProfitable?r.rectangleColorProfit||"rgba(76, 175, 80, 0.2)":r.rectangleColorLoss||"rgba(244, 67, 54, 0.2)",borderColor:e.isProfitable?r.rectangleColorProfit||"rgb(76, 175, 80)":r.rectangleColorLoss||"rgb(244, 67, 54)",borderWidth:r.rectangleBorderWidth||1,borderStyle:"solid",opacity:r.rectangleFillOpacity||.2,label:l,textPosition:r.rectangleTextPosition||"inside",textFontSize:r.rectangleTextFontSize||10,textColor:r.rectangleTextColor||"#FFFFFF",textBackground:r.rectangleTextBackground||"rgba(0, 0, 0, 0.7)"};return new c.j(u)}).filter(e=>null!==e);e.push(...t)}if(e.length>0&&e.forEach((e,n)=>{try{t.attachPrimitive(e)}catch(r){}}),"markers"===r.style||"both"===r.style){const e=[];if(n.forEach((t,n)=>{const a="string"==typeof t.entryTime?Math.floor(new Date(t.entryTime).getTime()/1e3):t.entryTime,o="string"==typeof t.exitTime?Math.floor(new Date(t.exitTime).getTime()/1e3):t.exitTime;let c=a,s=o;if(i&&i.length>0){const e=m(a,i),t=m(o,i);e&&(c=e),t&&(s=t)}if(c&&"number"==typeof t.entryPrice){const n="long"===t.tradeType,i=r.showPnlInMarkers?"Entry: ".concat(t.entryPrice):t.notes||t.text||"";e.push({time:c,position:n?"belowBar":"aboveBar",color:n?r.entryMarkerColorLong||"#2196F3":r.entryMarkerColorShort||"#FF9800",shape:n?"arrowUp":"arrowDown",size:r.markerSize||5,text:i})}if(s&&"number"==typeof t.exitPrice){const n="long"===t.tradeType,i=t.isProfitable||t.pnl&&t.pnl>=0;let a="";r.showPnlInMarkers&&(a="Exit: ".concat(t.exitPrice),t.pnl?a+=" (".concat(t.pnl>0?"+":"").concat(t.pnl.toFixed(2),")"):t.pnlPercentage&&(a+=" (".concat(t.pnlPercentage>0?"+":"").concat(t.pnlPercentage.toFixed(1),"%)"))),e.push({time:s,position:n?"aboveBar":"belowBar",color:i?r.exitMarkerColorProfit||"#4CAF50":r.exitMarkerColorLoss||"#F44336",shape:n?"arrowDown":"arrowUp",size:r.markerSize||5,text:a})}}),e.length>0)try{(0,a.hR)(t,e)}catch(o){}}"lines"===r.style||"arrows"===r.style||r.style}catch(o){}},[]),B=(0,i.useCallback)((e,t)=>{let n=[];if(t&&"object"==typeof t)if("layers"in t&&t.layers)try{const e=Object.values(t.layers);Array.isArray(e)&&e.forEach(e=>{e&&!1!==e.visible&&e.annotations&&Array.isArray(e.annotations)&&n.push(...e.annotations)})}catch(c){}else Array.isArray(t)&&(n=t);if(!n||!Array.isArray(n))return;try{if("function"!=typeof n.forEach)return}catch(c){return}const r=n.filter(e=>e&&"object"==typeof e&&e.time);if(0===r.length)return;if(!Array.isArray(r)||"function"!=typeof r.forEach)return;const i=(0,o.TB)(r);if(i.markers.length>0){const e=Object.values(x.current).flat();e.length>0&&(0,a.hR)(e[0],i.markers)}if(i.shapes.length>0){const e=Object.values(x.current).flat();e.length>0&&i.shapes.forEach(t=>{try{e[0].addShape?e[0].addShape(t):e[0].setShapes&&e[0].setShapes([t])}catch(c){}})}},[]),N=(0,i.useCallback)((e,t)=>{let n=[];if(t&&"object"==typeof t)if("layers"in t&&t.layers)try{const e=Object.values(t.layers);Array.isArray(e)&&(n=e)}catch(r){}else Array.isArray(t)&&(n=t);n&&Array.isArray(n)&&n.forEach((t,n)=>{try{if(!t||"object"!=typeof t)return;!1!==t.visible&&t.annotations&&L.current.addAnnotations(e,t.annotations)}catch(r){}})},[]),G=(0,i.useCallback)((e,t,r,i)=>{if(i.tooltipConfigs&&0!==Object.keys(i.tooltipConfigs).length)try{n.e(755).then(n.bind(n,3755)).then(n=>{let{createTooltipPlugin:r}=n;const a=r(e,t,i.chartId||"chart-".concat(Date.now()),i.tooltipConfigs,i);a.enable(),window.chartPlugins||(window.chartPlugins=new Map),window.chartPlugins.set(e,a)}).catch(e=>{})}catch(a){}},[]),q=(0,i.useCallback)((e,t)=>{},[]),J=(0,i.useCallback)(async(e,t)=>{if(!T.current&&e&&t&&0!==Object.keys(t).length){try{e.chartElement()}catch(n){return}try{e.timeScale()}catch(n){return}T.current}},[]),U=(0,i.useRef)(new Map),K=(0,i.useRef)(new Map),Q=(0,i.useCallback)((e,t,n)=>{const i=K.current.get(t);i&&n.time&&i.forEach((e,i)=>{let{series:a,legendConfig:o,paneId:c,seriesName:s,seriesIndex:l}=e;try{let e={};try{"function"==typeof a.options?e=a.options():a.options&&(e=a.options)}catch(u){}let i="Unknown";try{"function"==typeof a.seriesType?i=a.seriesType()+"":a.seriesType&&"string"==typeof a.seriesType&&(i=a.seriesType)}catch(u){}const d=a.data();if(!d||0===d.length)return;let h=null,p=1/0;for(const t of d)if(t.time&&n.time&&"number"==typeof t.time&&"number"==typeof n.time){const e=Math.abs(t.time-n.time);p>e&&(p=e,h=t)}if(!h){const e="".concat(t,"-").concat(l);return void(window.legendPrimitives&&window.legendPrimitives[e]&&window.legendPrimitives[e].updateValue(null))}let f="#2196f3";e.color?f=e.color:"Candlestick"===i?f="#26a69a":"Histogram"===i?f="#ff9800":"Area"===i&&(f=e.topColor||"#4caf50");const g=(0,r.A)({title:s,value:h.value||h.close||h.high||"",time:h.time||"",color:f,type:i},h),y="".concat(t,"-").concat(l);window.legendPrimitives&&window.legendPrimitives[y]&&window.legendPrimitives[y].updateValue(g.value);const m=U.current.get("".concat(t,"-pane-").concat(c));if(!m)return;m.querySelectorAll("[data-series-name]").forEach(e=>{const t=e;if(t.getAttribute("data-series-name")===s)if(o.text){let e=o.text;if(e.includes("$$value$$")){let t="";if(null!==g.value&&void 0!==g.value&&""!==g.value)if("number"==typeof g.value){const e=o.valueFormat||".2f";if(e.includes(".")&&e.includes("f")){const n=e.split(".")[1].split("f")[0],r=n?parseInt(n):2;t=g.value.toFixed(r)}else t=g.value.toFixed(2)}else t=g.value+"";e=e.replace(/\$\$value\$\$/g,t)}t.innerHTML=e;const n="#131722",r='-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',i="10px",a="2px",c="left";t.style.setProperty("color",n,"important"),t.style.setProperty("font-family",r,"important"),t.style.setProperty("font-size",i,"important"),t.style.setProperty("letter-spacing",a,"important"),t.style.setProperty("text-align",c,"important"),t.querySelectorAll("*").forEach(e=>{e instanceof HTMLElement&&(e.style.setProperty("color",n,"important"),e.style.setProperty("font-family",r,"important"),e.style.setProperty("font-size",i,"important"),e.style.setProperty("letter-spacing",a,"important"),e.style.setProperty("text-align",c,"important"))})}else{const e=t.querySelector("span:last-child");if(e){const t=g.value;if(!1===o.updateOnCrosshair)return;let n="N/A";if(null!=t&&""!==t)if("number"==typeof t){const e=o.valueFormat||".2f";if(e.includes(".")&&e.includes("f")){const r=e.split(".")[1].split("f")[0],i=r?parseInt(r):2;n=t.toFixed(i)}else n=t.toFixed(2)}else n=t+"";!1!==o.showValues?e.textContent="".concat(s,": ").concat(n):e.textContent=s}}})}catch(u){}})},[]),Y=(0,i.useCallback)(async(e,t,n)=>{if(T.current)return;if(!e||!t||0===Object.keys(t).length||0===n.length)return;try{e.chartElement()}catch(l){return}try{e.timeScale()}catch(l){return}if(T.current)return;try{await async function(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;for(let i=0;n>i;i++)try{return await e()}catch(l){if(t=l,i===n-1)throw t;const a=r*Math.pow(2,i)+100*Math.random();await new Promise(e=>setTimeout(e,a))}throw t}(async()=>{if(T.current)throw Error("Component disposed during retry");try{let n=[];if(e&&"function"==typeof e.panes)try{n=e.panes()}catch(l){n=[]}const r=Math.max(...Object.keys(t).map(e=>parseInt(e)));if(n.length<=r)throw Error("Not enough panes in chart API. Found: ".concat(n.length,", Need: ").concat(r+1));return n}catch(l){throw Error("Chart panes not ready: ".concat(l))}},10,200,"Chart API readiness check")}catch(l){return void(l instanceof Error&&l.message)}const r=e.chartElement().id||"default",i=[],a=e.chartElement().querySelectorAll("*"),o=Array.from(a).filter(e=>{const t=e.textContent||"";return t.includes("Know Sure Thing")||t.includes("KST")||t.includes("Legend")||e.className.includes("legend")||e.id.includes("legend")});if(o.length>0){const e=o.find(e=>{var t;return null===(t=e.textContent)||void 0===t?void 0:t.includes("Know Sure Thing")});if(e)try{e.remove()}catch(l){}}const c=new Map;n.forEach((e,t)=>{let n,r=0,i={};try{"function"==typeof e.options?i=e.options():e.options&&(i=e.options)}catch(l){}void 0!==e.paneId?n=e.paneId:i&&void 0!==i.paneId&&(n=i.paneId),r=void 0!==n?n:0,e.assignedPaneId=r,c.has(r)||c.set(r,[]),c.get(r).push(e)}),Object.keys(t).forEach(r=>{const a=parseInt(r),o=t[a];if(!o)return;if(!o.visible)return;const s=c.get(a)||[];let u;try{if(e&&"function"==typeof e.panes)try{u=e.panes()[a]}catch(l){u=null}else u=null;if(!u)return}catch(l){return}s.forEach((e,t)=>{const r=n.findIndex(t=>t===e);i.push({series:e,legendConfig:o,paneId:a,seriesName:"Pane ".concat(a),seriesIndex:0>r?t:r})})}),K.current.set(r,i);const s=Object.values(t).some(e=>{const t=!1!==e.updateOnCrosshair,n=e.text&&e.text.includes("$$value$$");return t||n});s&&(Object.entries(t).forEach(e=>{let[t,n]=e;if(n.text&&n.text.includes("$$value$$")){const e=i.findIndex(e=>e.seriesName===t);if(e>=0){const t="".concat(r,"-").concat(e);window.legendPrimitives&&window.legendPrimitives[t]&&window.legendPrimitives[t].updateValue(null)}}}),e.subscribeCrosshairMove(t=>{t.time&&t.point?Q(e,r,t):Q(e,r,{time:null,point:null,seriesData:new Map})}))},[Q]),X=(0,i.useMemo)(()=>t&&t.charts&&0!==t.charts.length?t.charts.map((e,t)=>{var n,i,a,o;const c=e.chartId||"chart-".concat(t);return(0,r.A)((0,r.A)({},e),{},{chartId:c,containerId:"chart-container-".concat(c),chartOptions:(0,h.L)((0,r.A)({width:null!==(n=e.chart)&&void 0!==n&&n.autoWidth?void 0:(null===(i=e.chart)||void 0===i?void 0:i.width)||v||void 0,height:null!==(a=e.chart)&&void 0!==a&&a.autoHeight?void 0:(null===(o=e.chart)||void 0===o?void 0:o.height)||d||void 0},e.chart))})}):[],[t,v,d]),Z=(0,i.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];R.current&&!T.current||T.current&&!e||X&&0!==X.length&&(e||L.current.cleanupCharts(),X&&0!==X.length&&(window.chartApiMap||(window.chartApiMap={}),window.chartGroupMap||(window.chartGroupMap={}),window.seriesRefsMap||(window.seriesRefsMap={}),X.forEach((e,n)=>{const i=e.chartId,o=e.containerId||"chart-container-".concat(i);let c=document.getElementById(o);if(c)O.current[i]=c;else{c=document.createElement("div"),c.id=o,c.style.width="100%",c.style.height="100%";let t=(0,f.$$)('[data-testid="stHorizontalBlock"]');if(t||(t=(0,f.$$)(".stHorizontalBlock")),t||(t=(0,f.$$)('[data-testid="stVerticalBlock"]')),t||(t=(0,f.$$)(".stVerticalBlock")),t||(t=(0,f.$$)('[data-testid="stBlock"]')),t||(t=(0,f.$$)(".stBlock")),t||(t=document.body),!t)return;{var g;t.appendChild(c),c.style.width="100%";const n=null!==(g=e.chart)&&void 0!==g&&g.height?"".concat(e.chart.height,"px"):"100%";c.style.height=n,c.style.minHeight="300px",c.style.minWidth="200px",c.style.display="block",c.style.position="relative",c.style.overflow="hidden",O.current[i]=c}}try{var y,m,b,k,R,A,I;if(!c||!c.isConnected)return;const n=e.chartOptions||e.chart||{};let o;try{o=(0,a.R9)(c,n)}catch(M){return}if(!o)return;const f=o.chartElement();f&&(f.id=i),C.current[i]=o,u.Y.getInstance().registerChart(i,o),window.chartApiMap||(window.chartApiMap={}),window.chartApiMap[i]=o,window.legendRefreshCallbacks||(window.legendRefreshCallbacks={}),window.legendRefreshCallbacks[i]||(window.legendRefreshCallbacks[i]=[]);const g="undefined"!=typeof ResizeObserver?new ResizeObserver(e=>{for(const t of e)t.target===c&&setTimeout(()=>{U.current},100)}):null;g&&"function"==typeof g.observe&&g.observe(c),window.chartResizeObservers||(window.chartResizeObservers={}),window.chartResizeObservers[i]=g;const O=c.getBoundingClientRect(),z=e.autoWidth?O.width:n&&n.width||v||O.width,H=n&&n.height||(e.autoHeight?O.height:d)||O.height,F=Math.max(z,200),W=Math.max(H,200);o.resize(F,W),n.layout&&n.layout.panes&&o.applyOptions({layout:{panes:n.layout.panes}});const $=new Map;let _=[];if(o&&"function"==typeof o.panes)try{_=o.panes()}catch(j){_=[]}e.series.forEach(e=>{const t=e.paneId||0;if(!$.has(t))if(t<_.length)$.set(t,_[t]);else{let e=null;if(o&&"function"==typeof o.addPane)try{e=o.addPane()}catch(j){e=null}if(e&&($.set(t,e),o&&"function"==typeof o.panes))try{_=o.panes()}catch(j){}}}),null!==(y=e.chart)&&void 0!==y&&y.overlayPriceScales&&Object.entries(e.chart.overlayPriceScales).forEach(e=>{let[t,n]=e;try{const e=o.priceScale(t);e&&e.applyOptions((0,h.L)(n))}catch(j){}});const B=[];if(e.series&&Array.isArray(e.series)&&e.series.forEach((t,n)=>{try{if(!t||"object"!=typeof t)return;0===n&&e.trades&&e.trades.length>0&&e.tradeVisualizationOptions&&(t.trades=e.trades,t.tradeVisualizationOptions=e.tradeVisualizationOptions);const c=(0,p.w)(o,t,{signalPluginRefs:S},i,n);if(c){var r,a;if(B.push(c),t.legend&&t.legend.visible)try{l.ChartReadyDetector.waitForChartReady(o,o.chartElement(),{minWidth:200,minHeight:200}).then(e=>{e?w(o,t,i,n):setTimeout(()=>{l.ChartReadyDetector.waitForChartReady(o,o.chartElement(),{minWidth:200,minHeight:200}).then(e=>{e&&w(o,t,i,n)})},300)})}catch(j){}if(t.priceScaleId&&"right"!==t.priceScaleId&&"left"!==t.priceScaleId&&null!==(r=e.chart)&&void 0!==r&&null!==(a=r.overlayPriceScales)&&void 0!==a&&a[t.priceScaleId]){const n=e.chart.overlayPriceScales[t.priceScaleId];try{const e=c.priceScale();e&&e.applyOptions((0,h.L)(n))}catch(j){}}if(t.trades&&t.tradeVisualizationOptions)try{setTimeout(async()=>{try{if(await l.ChartReadyDetector.waitForChartReadyForPrimitives(o,c,{maxAttempts:100,baseDelay:100,requireData:!0}))await V(o,c,t.trades,t.tradeVisualizationOptions,t.data);else try{await V(o,c,t.trades,t.tradeVisualizationOptions,t.data)}catch(e){}}catch(j){}},50)}catch(j){}t.annotations&&L.current.addAnnotations(o,t.annotations)}}catch(c){}}),x.current[i]=B,window.seriesRefsMap&&(window.seriesRefsMap[i]=B),null!==(m=e.chart)&&void 0!==m&&null!==(b=m.layout)&&void 0!==b&&b.paneHeights){let t=[];if(o&&"function"==typeof o.panes)try{t=o.panes()}catch(j){t=[]}Object.entries(e.chart.layout.paneHeights).forEach(e=>{let[n,r]=e;const i=parseInt(n),a=r;if(i<t.length&&a.factor)try{t[i].setStretchFactor(a.factor)}catch(j){}})}L.current.addModularTooltip(o,c,B,e),P.current[i]=e,e.annotations&&L.current.addAnnotations(o,e.annotations),e.annotationLayers&&L.current.addAnnotationLayers(o,e.annotationLayers),e.priceLines&&B.length>0&&e.priceLines.forEach(e=>{B[0].createPriceLine(e)}),null!==(k=e.chart)&&void 0!==k&&k.rangeSwitcher&&e.chart.rangeSwitcher.visible&&setTimeout(()=>{L.current.addRangeSwitcher(o,e.chart.rangeSwitcher)},100);const N={};if(B.forEach((t,n)=>{const r=e.series[n];if(null!=r&&r.legend&&r.legend.visible){const e=r.paneId||0;N[e.toString()]=r.legend}}),Object.keys(N).length>0&&setTimeout(()=>{L.current.addLegend(o,N,B)},200),setTimeout(()=>{if(!T.current&&C.current[i]){try{o.timeScale().fitContent()}catch(j){}if(g&&"function"==typeof g.observe){const e=o.chartElement();e&&g.observe(e)}E.current[i]=g,setTimeout(()=>{try{window.legendRefreshCallbacks&&window.legendRefreshCallbacks[i]&&window.legendRefreshCallbacks[i].forEach(e=>{e()})}catch(j){}},500)}},200),L.current.setupAutoSizing(o,c,e),t.syncConfig&&t.syncConfig.enabled){const n=e.chartGroupId||0;window.chartGroupMap||(window.chartGroupMap={}),window.seriesRefsMap||(window.seriesRefsMap={}),window.chartGroupMap[i]=n;let r=t.syncConfig;t.syncConfig.groups&&t.syncConfig.groups[n]&&(r=t.syncConfig.groups[n]),L.current.setupChartSynchronization(o,i,r,n)}L.current.setupFitContent(o,e);const G=e.paneCollapse||{enabled:!0};if(!1!==G.enabled)try{let e=[];if(o&&"function"==typeof o.panes)try{e=o.panes()}catch(j){e=[]}e.length>1&&(D(o,i,e.length),e.forEach((e,t)=>{const n=(0,s.vI)(t,(0,r.A)({},G));e.attachPrimitive(n),window.paneCollapsePlugins||(window.paneCollapsePlugins={}),window.paneCollapsePlugins[i]||(window.paneCollapsePlugins[i]=[]),window.paneCollapsePlugins[i].push(n)}))}catch(j){}!1!==(null===(R=e.chart)||void 0===R||null===(A=R.timeScale)||void 0===A?void 0:A.fitContentOnLoad)&&!1!==(null===(I=e.chart)||void 0===I?void 0:I.fitContentOnLoad)&&B.length>0&&setTimeout(()=>{try{const e=o.timeScale();e&&e.fitContent()}catch(j){}},100)}catch(j){}}),R.current=!0,setTimeout(()=>{b&&b()},50)))},[X,null==t?void 0:t.syncConfig,v,d,b,V,D]);(0,i.useEffect)(()=>{L.current={addTradeVisualization:V,addAnnotations:B,addModularTooltip:G,addAnnotationLayers:N,addRangeSwitcher:q,addLegend:Y,updateLegendPositions:J,setupAutoSizing:F,setupChartSynchronization:W,setupFitContent:$,setupPaneCollapseSupport:D,cleanupCharts:_}},[V,B,G,N,q,Y,J,F,W,$,D,_]);const ee=(0,i.useMemo)(()=>t,[t]);(0,i.useEffect)(()=>{ee&&ee.charts&&ee.charts.length>0&&Z(!0)},[ee,Z]),(0,i.useEffect)(()=>()=>{_()},[_]);const te=(0,i.useMemo)(()=>t&&t.charts&&0!==t.charts.length?t.charts.map((e,t)=>{const n=e.chartId||"chart-".concat(t),i="chart-container-".concat(n),a=e.autoSize||e.autoWidth||e.autoHeight,o=e.chart||{},c=(0,f.a1)(v,d,!!a,o),s=(0,r.A)((0,r.A)({},c.container),{},{minWidth:o.minWidth||e.minWidth||(a?200:void 0),minHeight:o.minHeight||e.minHeight||(a?200:void 0),maxWidth:o.maxWidth||e.maxWidth,maxHeight:o.maxHeight||e.maxHeight}),l=c.chartContainer;return(0,g.jsx)("div",{style:s,children:(0,g.jsx)("div",{id:i,style:l})},n)}):[],[t,v,d]);return t&&t.charts&&0!==t.charts.length?(0,g.jsx)(y,{children:(0,g.jsx)("div",{style:{display:"flex",flexDirection:"column"},children:te})}):(0,g.jsx)("div",{children:"No charts configured"})})}}]);