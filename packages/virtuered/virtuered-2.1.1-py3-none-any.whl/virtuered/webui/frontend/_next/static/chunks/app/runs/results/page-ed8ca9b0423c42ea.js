(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[128],{16505:e=>{e.exports={ranking:"VulnerabilityRanking_ranking__6LA_U"}},37123:(e,a,s)=>{"use strict";s.d(a,{Q:()=>n});let t=()=>window.__NEXT_PUBLIC_API_URL__||"https://api.yourproduction.com",n=new Proxy({runs:{refresh:"/datasets/refresh",testchat:"/scan/testchat",list:"/scan/list",progress:"/scan/progress",action:"/api/runs/action",filterRuns:"/scan/list",image:e=>"/scan/images/".concat(e),start:"/scan/start",pause:e=>"/scan/pause/".concat(e),resume:e=>"/scan/resume/".concat(e),delete:e=>"/scan/delete/".concat(e),info:e=>"/scan/info/".concat(e),compare:e=>"/scan/compare_scans/".concat(e),getById:e=>"/api/runs/".concat(e),error:e=>"/scan/error/".concat(e),merge:"/scan/merge",mergeEligible:"/scan/eligible_for_merge"},datasets:{list:"/datasets/list",refresh:"/datasets/refresh"},model:{list:"/scan/models",listAll:"/scan/filter_models",scans:e=>"/scan/list?filter_model=".concat(e),chartData:e=>"/scan/line_charts/".concat(e)},analytics:e=>"/api/analytics/".concat(e),vulnerabilities:{list:"/scan/summary/"},results:e=>"/scan/summary/".concat(e),downloadFailures:e=>"/scan/download_failures/".concat(e),downloadResults:e=>"/scan/download_results/".concat(e),generatePdf:e=>"/scan/generate_pdf/".concat(e),clientAddress:"/getclientaddress",dashboard:{stats:"/dashboard/stats",activities:"/dashboard/activities"},images:{serve:e=>"/api/images/".concat(e)}},{get(e,a){let s=t(),n=e[a];return"object"==typeof n?new Proxy(n,{get(e,a){let t=e[a];return"function"==typeof t?function(){for(var e=arguments.length,a=Array(e),n=0;n<e;n++)a[n]=arguments[n];return"".concat(s).concat(t(...a))}:"".concat(s).concat(t)}}):"function"==typeof n?function(){for(var e=arguments.length,a=Array(e),t=0;t<e;t++)a[t]=arguments[t];return"".concat(s).concat(n(...a))}:"".concat(s).concat(n)}})},42874:e=>{e.exports={datasets:"DatasetTags_datasets__ycMje",tags:"DatasetTags_tags__EMtjf",singleLineTags:"DatasetTags_singleLineTags__T0gkJ",tag:"DatasetTags_tag__bA61h"}},45063:e=>{e.exports={spinner:"Spinner_spinner__lWskE",spinnerRing:"Spinner_spinnerRing__FAG9d",spin:"Spinner_spin__y94gD"}},46121:e=>{e.exports={banner:"TerminationWarningBanner_banner__AKvZX",dismissed:"TerminationWarningBanner_dismissed__RXjNo",content:"TerminationWarningBanner_content__My1Ch",icon:"TerminationWarningBanner_icon__hOhIu",textContent:"TerminationWarningBanner_textContent__6VP_Z",title:"TerminationWarningBanner_title__4AjED",description:"TerminationWarningBanner_description__wHvu4",highlight:"TerminationWarningBanner_highlight__YMTlP",errorMessage:"TerminationWarningBanner_errorMessage__qzGBI",downloadHint:"TerminationWarningBanner_downloadHint__6YsvH",dismissButton:"TerminationWarningBanner_dismissButton__hNhlp"}},48263:(e,a,s)=>{"use strict";s.d(a,{y:()=>i});var t=s(95155);s(12115);var n=s(45063),r=s.n(n);let i=e=>{let{className:a}=e;return(0,t.jsx)("div",{className:"".concat(r().spinner," ").concat(a||""),children:(0,t.jsx)("div",{className:r().spinnerRing})})}},53625:e=>{e.exports={container:"results_container__cv6e_",topSection:"results_topSection__o6iIo",subSectionTitle:"results_subSectionTitle__iQMmE",leftColumn:"results_leftColumn__PlM2V",rightColumn:"results_rightColumn__5J959",comparisonSection:"results_comparisonSection__KNq2p",dropdownMenu:"results_dropdownMenu__iY7cs",dropdownItem:"results_dropdownItem__A4_EY",scanInfo:"results_scanInfo__IyLuu",scanName:"results_scanName__C0aTe",modelInfo:"results_modelInfo__nfEDj",charts:"results_charts__p3lAE"}},54091:e=>{e.exports={header:"ScanResultsHeader_header__Mt3BC",resultsTitle:"ScanResultsHeader_resultsTitle__CM71V",info:"ScanResultsHeader_info__B3z9l",details:"ScanResultsHeader_details__mABtn",actions:"ScanResultsHeader_actions__FgZVb",downloadButton:"ScanResultsHeader_downloadButton__mD16T",failuresButton:"ScanResultsHeader_failuresButton__3cmyN",downloadButtonIconWarning:"ScanResultsHeader_downloadButtonIconWarning__od_f6",resultsButton:"ScanResultsHeader_resultsButton__da6p6",reportButton:"ScanResultsHeader_reportButton__HgfdW",spinnerContainer:"ScanResultsHeader_spinnerContainer__Cn1SS",spinningIcon:"ScanResultsHeader_spinningIcon__KYD1r",spin:"ScanResultsHeader_spin__LfItx",breadcrumb:"ScanResultsHeader_breadcrumb__9VsaI",shareButton:"ScanResultsHeader_shareButton__8ENGq"}},62496:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>es});var t=s(95155),n=s(12115),r=s(35695),i=s(37123),o=s(53625),l=s.n(o),c=s(54091),d=s.n(c);function u(e){let{scanName:a,scanId:s}=e,[r,o]=(0,n.useState)(!1),[l,c]=(0,n.useState)(!1),u=(e,a)=>{var s,t;return(null==e||null==(t=e.split("filename=")[1])||null==(s=t.replace(/["']/g,""))?void 0:s.trim())||a},m=async()=>{if(!r){o(!0);try{let e=await fetch(i.Q.downloadFailures(s));if(!e.ok)throw Error("Download failed");let a=u(e.headers.get("Content-Disposition"),"failures.zip"),t=await e.blob(),n=window.URL.createObjectURL(t),r=document.createElement("a");r.href=n,r.download=a,document.body.appendChild(r),r.click(),r.remove(),window.URL.revokeObjectURL(n)}catch(e){console.error("Failed to download failure cases:",e)}finally{o(!1)}}},_=async()=>{if(!l){c(!0);try{let e=new AbortController,a=setTimeout(()=>e.abort(),6e5),t=await fetch(i.Q.generatePdf(s),{signal:e.signal,headers:{"Cache-Control":"no-cache",Pragma:"no-cache"}});if(clearTimeout(a),!t.ok){if(504===t.status||408===t.status)throw Error("Report generation timed out. This may be due to a large scan. Please try again or contact support if the issue persists.");throw Error("Failed to generate report: ".concat(t.status," ").concat(t.statusText))}let n=u(t.headers.get("Content-Disposition"),"report.pdf"),r=await t.blob(),o=window.URL.createObjectURL(r),l=document.createElement("a");l.href=o,l.download=n,document.body.appendChild(l),l.click(),l.remove(),window.URL.revokeObjectURL(o)}catch(e){if(console.error("Failed to download report:",e),e instanceof Error&&"AbortError"===e.name)alert("Report generation timed out (10 minutes). This scan may be too large. Please try again later or contact support.");else{let a=e instanceof Error?e.message:"Unknown error occurred";alert("Failed to download report: ".concat(a))}}finally{c(!1)}}};return(0,t.jsxs)("div",{className:d().header,children:[(0,t.jsx)("div",{className:d().info,children:(0,t.jsxs)("h2",{className:d().resultsTitle,children:["Results: ",a]})}),(0,t.jsxs)("div",{className:d().actions,children:[(0,t.jsx)("button",{className:"".concat(d().downloadButton," ").concat(d().reportButton," ").concat(l?d().loading:""),onClick:_,disabled:l,children:l?(0,t.jsxs)("span",{className:d().spinnerContainer,children:[(0,t.jsx)("svg",{className:d().spinningIcon,viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,t.jsx)("path",{d:"M12 6v3l4-4-4-4v3c-4.42 0-8 3.58-8 8 0 1.57.46 3.03 1.24 4.26L6.7 14.8c-.45-.83-.7-1.79-.7-2.8 0-3.31 2.69-6 6-6zm6.76 1.74L17.3 9.2c.44.84.7 1.79.7 2.8 0 3.31-2.69 6-6 6v-3l-4 4 4 4v-3c4.42 0 8-3.58 8-8 0-1.57-.46-3.03-1.24-4.26z"})}),"Generating Report..."]}):"\uD83D\uDCC4 Download Report"}),(0,t.jsx)("button",{className:"".concat(d().downloadButton," ").concat(d().failuresButton," ").concat(r?d().loading:""),onClick:m,disabled:r,children:r?(0,t.jsxs)("span",{className:d().spinnerContainer,children:[(0,t.jsx)("svg",{className:d().spinningIcon,viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,t.jsx)("path",{d:"M12 6v3l4-4-4-4v3c-4.42 0-8 3.58-8 8 0 1.57.46 3.03 1.24 4.26L6.7 14.8c-.45-.83-.7-1.79-.7-2.8 0-3.31 2.69-6 6-6zm6.76 1.74L17.3 9.2c.44.84.7 1.79.7 2.8 0 3.31-2.69 6-6 6v-3l-4 4 4 4v-3c4.42 0 8-3.58 8-8 0-1.57-.46-3.03-1.24-4.26z"})}),"Downloading..."]}):(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:d().downloadButtonIconWarning,children:"⚠️"}),(0,t.jsx)("span",{children:"Download Failure Cases"})]})})]})]})}var m=s(88175),_=s.n(m);function h(e){let{progress:a,createTime:s,scanName:n,modelName:r,totalSamples:i}=e;return(0,t.jsxs)("div",{className:_().overview,children:[(0,t.jsxs)("div",{className:_().progress,children:[(0,t.jsx)("h2",{children:"Scanning Progress"}),(0,t.jsxs)("div",{className:_().progressValue,children:[a,"%"]})]}),(0,t.jsxs)("div",{className:_().details,children:[(0,t.jsxs)("div",{className:_().detailItem,children:[(0,t.jsx)("label",{children:"Create Time"}),(0,t.jsx)("span",{children:s})]}),(0,t.jsxs)("div",{className:_().detailItem,children:[(0,t.jsx)("label",{children:"Scan Name"}),(0,t.jsx)("span",{children:n})]}),(0,t.jsxs)("div",{className:_().detailItem,children:[(0,t.jsx)("label",{children:"Model Name"}),(0,t.jsx)("span",{children:r})]}),(0,t.jsxs)("div",{className:_().detailItem,children:[(0,t.jsx)("label",{children:"Total Scanned Samples"}),(0,t.jsx)("span",{children:i})]})]})]})}var g=s(42874),p=s.n(g);function x(e){let{datasets:a}=e,s=a.length<5;return(0,t.jsxs)("div",{className:p().datasets,children:[(0,t.jsx)("h3",{children:"Selected Tests"}),(0,t.jsx)("div",{className:"".concat(p().tags," ").concat(s?p().singleLineTags:""),children:a.map(e=>(0,t.jsx)("div",{className:p().tag,children:e},e))})]})}var v=s(83540),j=s(3401),b=s(94754),f=s(96025),y=s(16238),C=s(94517),N=s(83394),k=s(54811),w=s(70098),R=s(68238),S=s(11832),B=s(57313),I=s(89190),T=s(70611),A=s.n(T);let E="rgb(255, 99, 132)",O="rgb(255, 206, 86)",D="rgb(54, 162, 235)",F="rgb(75, 192, 192)",L=(e,a,s)=>{let t=e.match(/\d+/g).map(Number),n=a.match(/\d+/g).map(Number),r=Math.round(t[0]+(n[0]-t[0])*s),i=Math.round(t[1]+(n[1]-t[1])*s),o=Math.round(t[2]+(n[2]-t[2])*s);return"rgb(".concat(r,",").concat(i,",").concat(o,")")},V=e=>e<=50?L(E,O,e/50):L(O,F,(e-50)/50);function H(e){let{scores:a,comparisonScores:s={},scanName:r,scanId:o,comparisonNames:l={},comparisonScans:c,onComparisonSelect:d,selectedComparisonIds:u=[],hideComparisonSelect:m=!1,tickFontSize:_=11,useScoreColors:h=!1,className:g,barChartClassName:p,radarChartOuterRadius:x="90%",radarChartCy:T}=e,[E,O]=(0,n.useState)(!1),[D,F]=(0,n.useState)(400),[L,H]=(0,n.useState)(!1),z=(0,n.useRef)(null),M=(0,n.useRef)(null),W=(0,n.useRef)(null),P=(e,a)=>{var s,t;return(null==e||null==(t=e.split("filename=")[1])||null==(s=t.replace(/["']/g,""))?void 0:s.trim())||a},U=async()=>{if(!L){H(!0);try{let e=await fetch(i.Q.downloadResults(o));if(!e.ok)throw Error("Download failed");let a=P(e.headers.get("Content-Disposition"),"scan_results.zip"),s=await e.blob(),t=window.URL.createObjectURL(s),n=document.createElement("a");n.href=t,n.download=a,document.body.appendChild(n),n.click(),n.remove(),window.URL.revokeObjectURL(t)}catch(e){console.error("Failed to download scan results:",e)}finally{H(!1)}}};(0,n.useEffect)(()=>{let e=()=>{z.current&&F(z.current.clientHeight)};e();let a=new ResizeObserver(a=>{e()});return z.current&&a.observe(z.current),()=>{a.disconnect()}},[]),(0,n.useEffect)(()=>{let e=e=>{var a;null!=(a=W.current)&&a.contains(e.target)||M.current&&!M.current.contains(e.target)&&O(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]);let Q=["#60A5FA","#34D399","#F472B6","#FBBF24","#A78BFA"],K=Object.entries(a).map(e=>{let[t,n]=e,r={subject:t,value:n,fullMark:100};return Object.entries(a).length>2?(T="50%",x="90%"):(T="50%",x="80%"),Object.keys(s).forEach((e,a)=>{var n;r["comparisonValue".concat(a)]=(null==(n=s[e])?void 0:n[t])||0}),r}),G=Object.entries(a).map(e=>{let[a,t]=e,n={name:a,value:t};return Object.keys(s).forEach((e,t)=>{var r;n["comparisonValue".concat(t)]=(null==(r=s[e])?void 0:r[a])||0}),n}),Y=e=>{let a=e.split(" "),s=[],t="";return a.forEach(e=>{(t+" "+e).length<=15?t=t?"".concat(t," ").concat(e):e:(t&&s.push(t),t=e)}),t&&s.push(t),s},q=Object.keys(a).length<3;return(0,t.jsxs)("div",{className:A().radarChart,children:[(0,t.jsx)("div",{className:A().header,children:!m&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:A().comparisonSection,children:[(0,t.jsx)("button",{ref:W,className:A().comparisonButton,onClick:()=>O(!E),title:"Models are comparable when they share some of the same tests as the current scan",children:"Select Comparison Models"}),E&&(0,t.jsx)("div",{ref:M,className:A().dropdownMenu,children:c.length>0?c.map(e=>{let a=u.includes(e.scan_id);return(0,t.jsx)("div",{className:"".concat(A().dropdownItem," ").concat(a?A().selected:""),onClick:()=>{d(e,!a)},children:(0,t.jsxs)("div",{className:A().scanInfo,children:[(0,t.jsxs)("div",{className:A().scanName,children:[a&&(0,t.jsx)("span",{className:A().checkmark,children:"✓"}),"Scan: ",e.scan_name]}),(0,t.jsxs)("div",{className:A().modelInfo,children:[e.model_name," • ",e.scan_time]})]})},e.scan_id)}):(0,t.jsx)("div",{className:A().dropdownItem,children:(0,t.jsx)("div",{className:A().scanInfo,children:(0,t.jsx)("div",{className:A().scanName,children:"No comparable models available"})})})})]}),(0,t.jsx)("button",{className:"".concat(A().downloadButton," ").concat(L?A().loading:""),onClick:U,disabled:L,children:L?(0,t.jsxs)("span",{className:A().spinnerContainer,children:[(0,t.jsx)("svg",{className:A().spinningIcon,viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,t.jsx)("path",{d:"M12 6v3l4-4-4-4v3c-4.42 0-8 3.58-8 8 0 1.57.46 3.03 1.24 4.26L6.7 14.8c-.45-.83-.7-1.79-.7-2.8 0-3.31 2.69-6 6-6zm6.76 1.74L17.3 9.2c.44.84.7 1.79.7 2.8 0 3.31-2.69 6-6 6v-3l-4 4 4 4v-3c4.42 0 8-3.58 8-8 0-1.57-.46-3.03-1.24-4.26z"})}),"Downloading..."]}):(0,t.jsxs)("div",{className:A().buttonContent,children:[(0,t.jsx)("span",{className:A().buttonIcon,children:"\uD83D\uDCE6"}),(0,t.jsx)("span",{children:"Download Scan Results"})]})})]})}),(0,t.jsxs)("div",{className:A().chartKey,children:[(0,t.jsxs)("div",{className:A().legendItem,children:[(0,t.jsx)("div",{className:A().keyIcon,style:h&&q?{background:V(Object.values(a)[0]||0),border:"1px solid",borderColor:V(Object.values(a)[0]||0),opacity:.5}:void 0}),(0,t.jsx)("span",{children:r})]}),Object.keys(s).map((e,a)=>(0,t.jsxs)("div",{className:A().legendItem,children:[(0,t.jsx)("div",{className:"".concat(A().keyIcon," ").concat(A().comparison),style:h&&q?{background:V(Object.values(s[e])[0]||0),border:"1px solid",borderColor:V(Object.values(s[e])[0]||0),opacity:.5}:{background:Q[a%Q.length]}}),(0,t.jsx)("span",{children:l[e]||"Comparison ".concat(a+1)})]},e))]}),(0,t.jsx)("div",{ref:z,className:"".concat(A().chartContainer," ").concat(g||""),children:(0,t.jsx)(v.u,{width:"100%",height:"100%",children:q?(0,t.jsx)("div",{className:"".concat(A().barChartContainer," ").concat(p||""),children:(0,t.jsx)(v.u,{width:m?"94%":"92%",height:"50%",children:(0,t.jsxs)(j.E,{data:G,layout:"vertical",margin:m?{top:80,right:20,left:75,bottom:20}:{top:60,right:20,left:20,bottom:40},children:[(0,t.jsx)(b.d,{stroke:"#374151",strokeDasharray:"1 1",horizontal:!0,vertical:!0}),(0,t.jsx)(f.W,{type:"number",axisLine:{stroke:"#374151"},tickLine:{stroke:"#374151"},domain:[0,100],label:{value:"Risk Score",position:"bottom",fill:"var(--main-text)",offset:0}}),(0,t.jsx)(y.h,{type:"category",dataKey:"name",axisLine:{stroke:"#374151"},tickLine:{stroke:"#374151"},tick:{fill:"var(--main-text)",fontSize:"0.9rem",width:"100"}}),(0,t.jsx)(C.m,{contentStyle:{backgroundColor:"var(--tile-bg2)",border:"1px solid var(--tile-border)",borderRadius:"var(--radius-small)",color:"var(--main-text)"},formatter:e=>["Risk Score: ".concat(e),""],cursor:!1,separator:""}),(0,t.jsx)(N.y,{dataKey:"value",fill:h?V(G[0].value):"#9333EA",stroke:h?V(G[0].value):"#9333EA",fillOpacity:.3,name:r,children:h&&G.map((e,a)=>(0,t.jsx)(k.f,{fill:V(e.value)},"cell-".concat(a)))}),Object.keys(s).map((e,a)=>(0,t.jsx)(N.y,{dataKey:"comparisonValue".concat(a),fill:h?V(Object.values(s[e])[0]||0):Q[a%Q.length],stroke:h?V(Object.values(s[e])[0]||0):Q[a%Q.length],fillOpacity:.3,name:l[e]||"Comparison ".concat(a+1),children:h&&G.map((e,s)=>(0,t.jsx)(k.f,{fill:V(e["comparisonValue".concat(a)])},"cell-comparison-".concat(s)))},e))]})})}):(0,t.jsxs)(w.V,{outerRadius:m?"65%":x,data:K,margin:m?{top:60,right:60,bottom:20,left:70}:{top:40,right:60,bottom:30,left:70},cy:m?"35%":T,children:[(0,t.jsx)(R.z,{stroke:"#374151"}),(0,t.jsx)(S.r,{dataKey:"subject",tick:e=>{let{payload:a,x:s,y:n,textAnchor:r}=e,{value:i}=a,o=Y(i),l=1.2*_,c=D/2,d=s,u=n,m=(o.length-1)*l;return"end"===r?d-=2:"start"===r?d+=2:"middle"===r&&(n<c?u-=8:u+=8),n<c?u-=2:u+=2,(0,t.jsx)("g",{children:o.map((e,a)=>(0,t.jsx)("text",{x:d,y:u+a*l-m/2,textAnchor:r,fill:"#FFFFFF",fontSize:_,children:e},a))})},tickLine:!1}),(0,t.jsx)(B.E,{angle:90,domain:[0,100],tickCount:6,tick:{fill:"#FFFFFF",dy:15,textAnchor:"middle",fontSize:_,width:"100"}}),(0,t.jsx)(I.V,{name:r,dataKey:"value",stroke:"#9333EA",fill:"#9333EA",fillOpacity:.4}),Object.keys(s).map((e,a)=>(0,t.jsx)(I.V,{name:l[e]||"Comparison ".concat(a+1),dataKey:"comparisonValue".concat(a),stroke:Q[a%Q.length],fill:Q[a%Q.length],fillOpacity:.4},e))]})})})]})}var z=s(16505),M=s.n(z);function W(e){let{rankings:a}=e,s=a.total,n=e=>Number((100*e/s).toFixed(1)),r=[{name:"High Risk",value:n(a.high),fill:E,stroke:E},{name:"Low Risk",value:n(a.low),fill:O,stroke:O},{name:"No Response",value:n(a.noResponse),fill:D,stroke:D},{name:"No Risk",value:n(a.none),fill:F,stroke:F}];return(0,t.jsxs)("div",{className:M().container,children:[(0,t.jsx)("h2",{className:M().subSectionTitle,children:"Vulnerability Ranking"}),(0,t.jsx)(v.u,{width:"95%",height:300,children:(0,t.jsxs)(j.E,{data:r,layout:"vertical",margin:{top:20,right:30,left:80,bottom:40},children:[(0,t.jsx)(b.d,{stroke:"#374151",strokeDasharray:"0 0",horizontal:!0,vertical:!0}),(0,t.jsx)(f.W,{type:"number",tickCount:10,axisLine:{stroke:"#374151"},tickLine:{stroke:"#374151"},tick:{fill:"#9CA3AF"},label:{value:"Percentages",position:"bottom",fill:"var(--main-text)",offset:0}}),(0,t.jsx)(y.h,{type:"category",dataKey:"name",tick:{fill:"var(--main-text)",width:100,fontSize:"0.9rem"},axisLine:{stroke:"#374151"},tickLine:{stroke:"#374151"}}),(0,t.jsx)(C.m,{content:(0,t.jsx)(e=>{let{active:a,payload:s}=e;if(a&&s&&s.length){let e=s[0].payload.fill,a=s[0].payload.name,n=s[0].payload.value;return(0,t.jsxs)("div",{style:{backgroundColor:"var(--bg2)",border:"1px solid var(--tile-border)",borderRadius:"var(--radius-small)",color:"var(--main-text)",padding:"8px"},children:[(0,t.jsx)("p",{style:{color:e,fontWeight:700},children:a}),(0,t.jsxs)("p",{children:["Total Risk Count: ",n,"%"]})]})}return null},{}),cursor:!1}),(0,t.jsx)(N.y,{dataKey:"value",fillOpacity:.3})]})})]})}var P=s(99590),U=s.n(P),Q=s(66766),K=s(90792);function G(e){let{categories:a,scanId:s=""}=e,[r,o]=(0,n.useState)([]);return(0,t.jsxs)("div",{className:U().categories,children:[(0,t.jsx)("h2",{children:"Risk by Category"}),Object.entries(a).map(e=>{let[a,n]=e;return(0,t.jsxs)("div",{className:U().category,children:[(0,t.jsxs)("button",{className:U().categoryHeader,onClick:()=>{o(e=>e.includes(a)?e.filter(e=>e!==a):[...e,a])},children:[(0,t.jsxs)("div",{className:U().categoryTitle,children:[(0,t.jsx)("span",{children:a}),(0,t.jsx)("span",{className:U().score,style:{color:V(n.score)},children:n.score.toFixed(2)})]}),(0,t.jsx)("span",{className:U().arrow,children:r.includes(a)?"▼":"▶"})]}),r.includes(a)&&(0,t.jsxs)("div",{className:U().categoryDetails,children:[(0,t.jsx)("div",{className:U().subcategoryChart,children:(0,t.jsx)(H,{scores:n.subcategories||{},scanName:a,scanId:s,comparisonScans:[],onComparisonSelect:()=>{},hideComparisonSelect:!0,tickFontSize:10,useScoreColors:!0,className:U().riskCategoryRadarChart,barChartClassName:U().riskCategoryBarChartContainer})}),n.details&&n.details.length>0?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h3",{children:"Top Failures"}),(0,t.jsx)("div",{className:U().failures,children:n.details.map((e,a)=>(0,t.jsx)("div",{className:U().failure,children:(0,t.jsxs)("div",{className:U().failureCard,children:[(0,t.jsxs)("div",{className:U().failureHeader,children:[(0,t.jsxs)("div",{className:U().conversationHeader,children:[(0,t.jsx)("span",{className:U().conversationIcon,children:"\uD83D\uDCAC"}),(0,t.jsx)("h4",{children:"Chat History"})]}),(0,t.jsx)("span",{className:U().subcategory,children:e.subcategory})]}),(0,t.jsx)("div",{className:U().conversation,children:(0,t.jsx)("div",{className:U().chatContainer,children:e.prompt.map((a,s)=>(0,t.jsx)("div",{className:"".concat(U().conversationTurn," ").concat("user"===a.role?U().userTurn:U().assistantTurn),children:(0,t.jsx)("div",{className:U().messageRow,children:(0,t.jsxs)("div",{className:U().messageBubbleContainer,children:[(0,t.jsxs)("div",{className:U().messageHeader,children:[(0,t.jsx)("div",{className:"".concat(U().roleAvatar," ").concat("user"===a.role?U().userAvatar:U().assistantAvatar),children:"user"===a.role?"\uD83D\uDC64":"\uD83E\uDD16"}),(0,t.jsx)("span",{className:U().roleLabel,children:"user"===a.role?"User":"AI Assistant"})]}),(0,t.jsx)("div",{className:"".concat(U().messageBubble," ").concat("user"===a.role?U().userBubble:U().assistantBubble),children:Array.isArray(a.content)?a.content.map((a,s)=>(0,t.jsxs)("div",{className:U().failureContent,children:[a.text&&(0,t.jsx)("div",{className:U().contentText,children:(0,t.jsx)(K.oz,{children:a.text})}),"image_url"===a.type&&a.image_url&&(0,t.jsxs)("div",{className:U().mediaContainer,children:[(0,t.jsx)("div",{className:U().imageContainer,children:(0,t.jsx)(Q.default,{src:i.Q.runs.image(a.image_url.url),alt:"Content visualization",className:U().contentImage,width:e.input_modalities&&e.input_modalities.includes("video")?700:500,height:e.input_modalities&&e.input_modalities.includes("video")?500:350,unoptimized:!0})}),e.input_modalities&&e.input_modalities.includes("video")&&(0,t.jsx)("div",{className:U().videoNoteContainer,style:{textAlign:"center",marginTop:"8px"},children:(0,t.jsxs)("div",{className:U().videoNote,title:"This content shows 3 frames extracted from a video",children:[(0,t.jsx)("span",{className:U().videoIcon,style:{marginRight:"8px"},children:"\uD83C\uDFAC"}),"Video Input Snapshot (3 frames)"]})})]})]},s)):(0,t.jsx)("div",{className:U().failureContent,children:"string"==typeof a.content?(0,t.jsx)("div",{className:U().contentText,children:(0,t.jsx)(K.oz,{children:a.content})}):a.content.text?(0,t.jsx)("div",{className:U().contentText,children:(0,t.jsx)(K.oz,{children:a.content.text})}):null})})]})})},s))})}),(0,t.jsx)("div",{className:"".concat(U().conversationTurn," ").concat(U().assistantTurn),children:(0,t.jsx)("div",{className:U().messageRow,children:(0,t.jsxs)("div",{className:U().messageBubbleContainer,children:[(0,t.jsxs)("div",{className:U().messageHeader,children:[(0,t.jsx)("div",{className:"".concat(U().roleAvatar," ").concat(U().assistantAvatar),children:"\uD83E\uDD16"}),(0,t.jsx)("span",{className:U().roleLabel,children:"AI Assistant"})]}),(0,t.jsx)("div",{className:"".concat(U().messageBubble," ").concat(U().assistantBubble),children:e.output_modalities&&(e.output_modalities.includes("image")||e.output_modalities.includes("video"))?(0,t.jsxs)("div",{className:U().mediaContainer,children:[(0,t.jsx)("div",{className:U().imageContainer,children:(0,t.jsx)(Q.default,{src:i.Q.runs.image(e.answer),alt:"Answer visualization",className:U().contentImage,width:e.output_modalities&&e.output_modalities.includes("video")?700:500,height:e.output_modalities&&e.output_modalities.includes("video")?500:350,unoptimized:!0})}),e.output_modalities&&e.output_modalities.includes("video")&&(0,t.jsx)("div",{className:U().videoNoteContainer,style:{textAlign:"center",marginTop:"8px"},children:(0,t.jsxs)("div",{className:U().videoNote,title:"This content shows 3 frames extracted from a video",style:{display:"inline-flex"},children:[(0,t.jsx)("span",{className:U().videoIcon,style:{marginRight:"8px"},children:"\uD83C\uDFAC"})," Video Output Snapshot (3 frames)"]})})]}):(0,t.jsx)("div",{className:U().failureContent,children:(0,t.jsx)("div",{className:U().contentText,children:(0,t.jsx)(K.oz,{children:e.answer})})})})]})})})]})},a))})]}):(0,t.jsx)("div",{className:U().noFailures,children:(0,t.jsx)("h3",{children:"No Failures Found"})})]})]},a)})]})}var Y=s(48263),q=s(6874),X=s.n(q);function J(e){let{items:a}=e;return(0,t.jsx)("nav",{className:"flex mb-2","aria-label":"Breadcrumb",children:(0,t.jsx)("ol",{className:"flex items-center bg-[var(--bg2)] py-2 px-4 rounded",children:a.map((e,s)=>(0,t.jsxs)("li",{className:"flex items-center",children:[s>0&&(0,t.jsx)("span",{className:"mx-2 text-gray-400",children:">"}),s===a.length-1?(0,t.jsx)("span",{className:"text-purple-400 font-medium",children:e.label}):(0,t.jsx)(X(),{href:e.href,className:"text-gray-300 hover:text-white transition-colors",children:e.label})]},e.href))})})}var Z=s(46121),$=s.n(Z);function ee(e){var a,s;let{scanId:r}=e,[o,l]=(0,n.useState)(null),[c,d]=(0,n.useState)(!0),[u,m]=(0,n.useState)(!1);return((0,n.useEffect)(()=>{(async()=>{try{let e=await fetch(i.Q.runs.error(r));if(e.ok){let a=await e.json();a.terminated&&a.termination_info&&l(a.termination_info)}}catch(e){console.error("Failed to fetch termination info:",e)}finally{d(!1)}})()},[r]),c||!o||u)?null:(0,t.jsxs)("div",{className:$().banner,children:[(0,t.jsxs)("div",{className:$().content,children:[(0,t.jsx)("span",{className:$().icon,children:"⚠️"}),(0,t.jsxs)("div",{className:$().textContent,children:[(0,t.jsx)("div",{className:$().title,children:"Scan Terminated Early - Partial Results"}),(0,t.jsxs)("div",{className:$().description,children:["This scan was terminated after ",o.consecutive_failures," consecutive failures. The dashboard shows partial results based on ",(0,t.jsxs)("span",{className:$().highlight,children:[o.total_processed," successfully processed samples"]})," before termination."]}),(0,t.jsxs)("div",{className:$().errorMessage,children:[(0,t.jsx)("strong",{children:"Last Error:"})," ",(null==(a=o.last_error)?void 0:a.message)?o.last_error.message:(null==(s=o.last_error)?void 0:s.details)?o.last_error.details:"Multiple consecutive failures detected"]}),(0,t.jsxs)("div",{className:$().downloadHint,children:["\uD83D\uDCA1 ",(0,t.jsx)("strong",{children:"Download Scan Results"})," to view detailed error information in ",(0,t.jsx)("code",{children:"termination_info.json"})," and ",(0,t.jsx)("code",{children:"results.jsonl"})]})]})]}),(0,t.jsx)("button",{className:$().dismissButton,onClick:()=>m(!0),"aria-label":"Dismiss banner",children:"\xd7"})]})}function ea(){let e=(0,r.useSearchParams)().get("id"),[a,s]=(0,n.useState)(null),[o,c]=(0,n.useState)(null),[d,m]=(0,n.useState)(!0),[_,g]=(0,n.useState)(null),[p,v]=(0,n.useState)([]),[j,b]=(0,n.useState)({}),f=(0,n.useRef)(!1),y=(0,n.useCallback)(async()=>{if(e&&!f.current)try{f.current=!0,m(!0);let a={cache:"no-store",headers:{"Cache-Control":"no-cache",Pragma:"no-cache"}},t=await Promise.all([fetch(i.Q.runs.info(e),a),fetch(i.Q.results(e),a),fetch(i.Q.runs.compare(e),a)]);t.forEach((e,a)=>{if(!e.ok)throw Error("Failed to fetch ".concat(["scan info","results","comparison scans"][a],": ").concat(e.statusText))});let[n,r,o]=await Promise.all(t.map(e=>e.json()));s(n),c(r),v(o),g(null)}catch(e){console.error("Error loading scan data:",e),g(e instanceof Error?e.message:"Failed to load scan data"),s(null),c(null),v([])}finally{m(!1),f.current=!1}},[e]);(0,n.useEffect)(()=>{y()},[y]);let C=async(e,a)=>{if(a)try{let a=await fetch(i.Q.results(e.scan_id));if(!a.ok)throw Error("Failed to fetch comparison results");let s=await a.json();b(a=>({...a,[e.scan_id]:s}))}catch(e){console.error("Failed to load comparison results:",e)}else b(a=>{let s={...a};return delete s[e.scan_id],s})};if(d)return(0,t.jsx)("div",{className:l().loading,children:(0,t.jsx)(Y.y,{})});if(_)return(0,t.jsx)("div",{className:l().container,children:_});if(!a)return(0,t.jsx)("div",{className:l().container,children:"No scan info found"});if(!o)return(0,t.jsx)("div",{className:l().container,children:"No results found"});let N={scanning_progress:100,create_time:a.time,scan_name:a.scan_name,model_name:o.model_name,total_scanned_samples:o.total_length,selected_datasets:Object.keys(o.averages_sub||{}),vulnerability_scores:o.averages||{},vulnerability_ranking:{high:o.scores["High Risk"]||0,low:o.scores["Low Risk"]||0,none:o.scores["No Risk"]||0,noResponse:o.scores["No Response"]||0,total:o.total_length||0},risk_by_category:{...Object.entries(o.averages_sub||{}).reduce((e,a)=>{let[s,t]=a;return{...e,[s]:{score:o.averages[s]||0,details:o.failures[s]||[],subcategories:t}}},{})}};return(0,t.jsxs)("div",{className:l().container,children:[(0,t.jsx)(J,{items:[{label:"Runs",href:"/runs"},{label:"Results",href:"/runs/results/".concat(e||"")}]}),(0,t.jsx)(ee,{scanId:o.scan_id}),(0,t.jsx)(u,{scanName:a.scan_name,scanId:o.scan_id}),(0,t.jsxs)("div",{className:l().topSection,children:[(0,t.jsxs)("div",{className:l().leftColumn,children:[(0,t.jsx)(h,{progress:N.scanning_progress,createTime:N.create_time,scanName:N.scan_name,modelName:N.model_name,totalSamples:N.total_scanned_samples}),(0,t.jsx)(x,{datasets:N.selected_datasets})]}),(0,t.jsx)("div",{className:l().rightColumn,children:(0,t.jsx)(H,{scores:N.vulnerability_scores,comparisonScores:Object.entries(j).reduce((e,a)=>{let[s,t]=a;return{...e,[s]:t.averages}},{}),scanName:o.scan_id,scanId:o.scan_id,comparisonNames:Object.entries(j).reduce((e,a)=>{let[s,t]=a;return{...e,[s]:t.scan_id}},{}),comparisonScans:p,onComparisonSelect:C,selectedComparisonIds:Object.keys(j),useScoreColors:!0})})]}),(0,t.jsx)(W,{rankings:N.vulnerability_ranking}),(0,t.jsx)(G,{categories:N.risk_by_category,scanId:o.scan_id})]})}function es(){return(0,t.jsx)(n.Suspense,{fallback:(0,t.jsx)("div",{className:l().loading,children:(0,t.jsx)(Y.y,{})}),children:(0,t.jsx)(ea,{})})}},70611:e=>{e.exports={radarChart:"VulnerabilityRadar_radarChart__GA__a",header:"VulnerabilityRadar_header__rYrPG",chartContainer:"VulnerabilityRadar_chartContainer__O2jPO",barChartContainer:"VulnerabilityRadar_barChartContainer__cLxUq",chartKey:"VulnerabilityRadar_chartKey__6DwMO",legendItem:"VulnerabilityRadar_legendItem__OWXvl",keyIcon:"VulnerabilityRadar_keyIcon__t9ZAg",comparison:"VulnerabilityRadar_comparison__g13My",comparisonSection:"VulnerabilityRadar_comparisonSection__cJqHg",comparisonButton:"VulnerabilityRadar_comparisonButton__WGPAg",dropdownMenu:"VulnerabilityRadar_dropdownMenu__pW35c",dropdownItem:"VulnerabilityRadar_dropdownItem__hIYWT",selected:"VulnerabilityRadar_selected__QlrSk",checkmark:"VulnerabilityRadar_checkmark__XXLkv",scanName:"VulnerabilityRadar_scanName__WtJLo",scanInfo:"VulnerabilityRadar_scanInfo__bGQEj",modelInfo:"VulnerabilityRadar_modelInfo___IbbQ",shareButton:"VulnerabilityRadar_shareButton__cULHw","recharts-text":"VulnerabilityRadar_recharts-text__WTr68",downloadButton:"VulnerabilityRadar_downloadButton__zdSCN",buttonContent:"VulnerabilityRadar_buttonContent__bk9l_",buttonIcon:"VulnerabilityRadar_buttonIcon__tqZwm",spinnerContainer:"VulnerabilityRadar_spinnerContainer__i0rBi",spinningIcon:"VulnerabilityRadar_spinningIcon__ClMNV",spin:"VulnerabilityRadar_spin__ngYMJ"}},77059:(e,a,s)=>{Promise.resolve().then(s.bind(s,62496))},88175:e=>{e.exports={overview:"ScanOverview_overview__I_0Gq",progress:"ScanOverview_progress__3QOLn",progressValue:"ScanOverview_progressValue__6_P8W",details:"ScanOverview_details__lK18D",detailItem:"ScanOverview_detailItem__kVJje"}},99590:e=>{e.exports={categories:"RiskCategories_categories__X_l3Y",category:"RiskCategories_category__Gm6yt",categoryHeader:"RiskCategories_categoryHeader__EMdqz",categoryTitle:"RiskCategories_categoryTitle__zFSWG",score:"RiskCategories_score__PCarA",arrow:"RiskCategories_arrow__LMEW9",categoryDetails:"RiskCategories_categoryDetails__Frwy9",failureCard:"RiskCategories_failureCard__OS_bU",failure:"RiskCategories_failure__46zj0",failureHeader:"RiskCategories_failureHeader__iBgQU",failureContent:"RiskCategories_failureContent__JU50R",noFailures:"RiskCategories_noFailures__052j2",subcategory:"RiskCategories_subcategory__ajydq",promptSection:"RiskCategories_promptSection__s_UB8",input:"RiskCategories_input__uCzMH",answer:"RiskCategories_answer__et9IO",imageContainer:"RiskCategories_imageContainer__G9b_x",contentText:"RiskCategories_contentText__CVQJY",answerText:"RiskCategories_answerText__6yHpe",contentImage:"RiskCategories_contentImage__zvpiz",subcategoryChart:"RiskCategories_subcategoryChart__eGScY",riskCategoryRadarChart:"RiskCategories_riskCategoryRadarChart__V5DY2",riskCategoryBarChartContainer:"RiskCategories_riskCategoryBarChartContainer__DBsiu",conversationHeader:"RiskCategories_conversationHeader__wf0KC",conversationIcon:"RiskCategories_conversationIcon__Mf9tT",answerIcon:"RiskCategories_answerIcon__ragKc",conversation:"RiskCategories_conversation__2DBKZ",chatContainer:"RiskCategories_chatContainer__OcxXH",conversationTurn:"RiskCategories_conversationTurn__qvjyh",userTurn:"RiskCategories_userTurn__4EIzv",assistantTurn:"RiskCategories_assistantTurn__mb7vd",messageRow:"RiskCategories_messageRow__UtszY",messageBubbleContainer:"RiskCategories_messageBubbleContainer__hMQF8",messageHeader:"RiskCategories_messageHeader__ZOQb1",roleAvatar:"RiskCategories_roleAvatar__ma6BS",assistantAvatar:"RiskCategories_assistantAvatar__fAbGF",roleLabel:"RiskCategories_roleLabel__hDXsH",messageBubble:"RiskCategories_messageBubble__419vn",userBubble:"RiskCategories_userBubble__MydBp",assistantBubble:"RiskCategories_assistantBubble__cAQGk",mediaContainer:"RiskCategories_mediaContainer__qzTXp"}}},e=>{var a=a=>e(e.s=a);e.O(0,[770,802,946,766,874,201,808,441,684,358],()=>a(77059)),_N_E=e.O()}]);