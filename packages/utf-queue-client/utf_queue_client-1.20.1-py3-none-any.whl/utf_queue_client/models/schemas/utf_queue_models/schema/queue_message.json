{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "definitions": {
    "QueueMessage": {
      "type": "object",
      "properties": {
        "recordType": {
          "description": "Type of record",
          "enum": [
            "ARTIFACT_UPLOAD_REQUEST",
            "DATALAKE_DATA",
            "EXCEPTION_EVENT",
            "LOG_EVENT",
            "OPENTELEMETRY_DATA",
            "TEST_RAIL_EVENT",
            "UTF_TEST_EVENT",
            "XRAY_EVENT"
          ],
          "type": "string"
        },
        "recordSubType": {
          "description": "Subtype of record. Not all types have a subtype, but it is required when they have one.",
          "enum": [
            "BUILD_RESULT",
            "IMPORT_TEST_EXECUTION",
            "SESSION_START",
            "SESSION_STOP",
            "TEST_RESULT",
            "TEST_RESULT_APP"
          ],
          "type": "string"
        },
        "tenantKey": {
          "description": "Unique string that identifies the app/group sending the message.\nForward looking to match the data lake infrastructure.",
          "type": "string"
        },
        "recordTimestamp": {
          "description": "UTC datetime.\nUse ISO-8601 format with time zone\n2022-03-10T18:50:05Z",
          "type": "string"
        },
        "payload": {
          "$ref": "#/definitions/QueueRecord",
          "description": "Record Payload.\nThis is flexible to allow different fields for different record types and DB tables"
        },
        "messageId": {
          "description": "Unique client-generated UUID",
          "type": "string"
        }
      },
      "required": [
        "payload",
        "recordTimestamp",
        "recordType",
        "tenantKey"
      ]
    },
    "QueueMessageV1": {
      "type": "object",
      "properties": {
        "recordType": {
          "description": "Type of record",
          "enum": [
            "ARTIFACT_UPLOAD_REQUEST",
            "EXCEPTION_EVENT",
            "LOG_EVENT",
            "TEST_EVENT",
            "UTF_TEST_EVENT"
          ],
          "type": "string"
        },
        "payload": {
          "$ref": "#/definitions/QueueRecord",
          "description": "Record Payload"
        },
        "timestamp": {
          "description": "UTC Timestamp\nGiven in seconds since epoch (unix time)",
          "type": "number"
        }
      },
      "required": [
        "payload",
        "recordType",
        "timestamp"
      ]
    },
    "QueueRecord": {
      "type": "object",
      "additionalProperties": {}
    },
    "DataLakeData": {
      "type": "object",
      "properties": {
        "dataFormat": {
          "enum": [
            "CSV",
            "JSON",
            "JSONSTR",
            "NDJSON",
            "PARQUET"
          ],
          "type": "string"
        },
        "object_id": {
          "type": "string"
        },
        "data": {
          "anyOf": [
            {
              "type": "object",
              "properties": {},
              "additionalProperties": true
            },
            {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {},
                "additionalProperties": true
              }
            },
            {
              "type": "string"
            }
          ]
        },
        "compression": {
          "enum": [
            "GZIP",
            "NONE",
            "SNAPPY"
          ],
          "type": "string"
        }
      },
      "required": [
        "data",
        "dataFormat"
      ]
    },
    "TelemetryData": {
      "type": "object",
      "properties": {
        "dataType": {
          "enum": [
            "LOGS",
            "METRICS",
            "TRACES"
          ],
          "type": "string"
        },
        "base64ProtobufData": {
          "type": "string"
        },
        "compression": {
          "type": "string"
        }
      },
      "required": [
        "base64ProtobufData",
        "dataType"
      ]
    },
    "ArtifactUploadRequest": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string"
        },
        "extension": {
          "type": "string"
        },
        "metadata": {
          "anyOf": [
            {
              "$ref": "#/definitions/ArtifactMetadata"
            },
            {
              "$ref": "#/definitions/ArtifactBuildMetadata"
            }
          ]
        },
        "base64Content": {
          "type": "string"
        },
        "validateMetadata": {
          "type": "boolean"
        }
      },
      "required": [
        "base64Content",
        "extension",
        "metadata",
        "name",
        "validateMetadata"
      ]
    },
    "ArtifactMetadata": {
      "type": "object",
      "additionalProperties": {
        "type": "string"
      }
    },
    "ArtifactBuildMetadata": {
      "type": "object",
      "properties": {
        "branch": {
          "type": "string"
        },
        "stack": {
          "type": "string"
        },
        "build_number": {
          "type": "string"
        },
        "target": {
          "type": "string"
        },
        "studio": {
          "type": "string"
        },
        "compiler": {
          "type": "string"
        },
        "app_name": {
          "type": "string"
        },
        "test_suite": {
          "type": "string"
        },
        "chip_id": {
          "type": "string"
        },
        "studio_build_version": {
          "type": "string"
        },
        "compiler_build_version": {
          "type": "string"
        }
      }
    },
    "SqaAppBuildResult": {
      "description": "Tied to the table: testdatabase.appBuildResults",
      "type": "object",
      "properties": {
        "session_pk_id": {
          "description": "Logical FK to dbo.jobStatusTable.\nNot creating the constraint in case this comes in before the session record.",
          "type": "string"
        },
        "app_name": {
          "description": "Name of the application",
          "maxLength": 512,
          "type": "string"
        },
        "app_description": {
          "description": "Description of what the application does",
          "maxLength": 1024,
          "type": "string"
        },
        "test_suite_name": {
          "description": "Description of the grouping of applications",
          "maxLength": 512,
          "type": "string"
        },
        "test_result_type": {
          "description": "Need table for validation created from the existing java enum",
          "maxLength": 256,
          "type": "string"
        },
        "executor_name": {
          "description": "Where the application was built",
          "maxLength": 256,
          "type": "string"
        },
        "feature_name": {
          "description": "Feature being tested by this test",
          "maxLength": 256,
          "type": "string"
        },
        "module_name": {
          "description": "Description of the device type that the application runs on",
          "maxLength": 256,
          "type": "string"
        },
        "phy_name": {
          "description": "Radio configuration used by the device",
          "maxLength": 256,
          "type": "string"
        },
        "test_result": {
          "description": "Did the application build",
          "enum": [
            "FAIL",
            "PASS",
            "block",
            "fail",
            "pass",
            "skip"
          ],
          "type": "string"
        },
        "engineer_name": {
          "description": "Name of the engineer who created the test",
          "maxLength": 256,
          "type": "string"
        },
        "exception_msg": {
          "description": "Stack dump exception message from build",
          "type": "string"
        },
        "iot_req_id": {
          "description": "JIRA IOT Req Number",
          "maxLength": 256,
          "type": "string"
        },
        "tool_chain": {
          "description": "Need table for validation.\nThis is the tool and version used to build the application with colon separation\niar:7.80.1",
          "maxLength": 256,
          "type": "string"
        },
        "notes": {
          "maxLength": 256,
          "type": "string"
        },
        "test_duration_sec": {
          "description": "Length of time to build the application",
          "type": "number"
        },
        "package_info": {
          "type": "string"
        },
        "artifact_id": {
          "maxLength": 36,
          "type": "string"
        },
        "app_version": {
          "maxLength": 50,
          "type": "string"
        }
      },
      "required": [
        "app_name",
        "session_pk_id",
        "test_duration_sec",
        "test_result",
        "test_result_type"
      ]
    },
    "SqaTestResult": {
      "description": "Tied to the table: testdatabase.testResults_new",
      "type": "object",
      "properties": {
        "session_pk_id": {
          "description": "Logical FK to dbo.jobStatusTable.\nNot creating the constraint in case this comes in before the session record.",
          "type": "string"
        },
        "test_case_id": {
          "description": "Passed in from the test executor.\nFrom the test management system or git.",
          "maxLength": 512,
          "type": "string"
        },
        "test_case_version_num": {
          "type": "integer"
        },
        "test_suite_name": {
          "description": "Named group of tests",
          "maxLength": 512,
          "type": "string"
        },
        "test_description": {
          "description": "What does the test case actually do",
          "maxLength": 1024,
          "type": "string"
        },
        "test_result_type": {
          "description": "Need to create a table for verification of this field",
          "maxLength": 256,
          "type": "string"
        },
        "test_parametric_data": {
          "description": "Test Parametric Data",
          "type": "string"
        },
        "test_case_name": {
          "description": "Human readable version of the test case ID\nShort summary/description",
          "maxLength": 512,
          "type": "string"
        },
        "executor_name": {
          "description": "Where the test actually ran",
          "maxLength": 256,
          "type": "string"
        },
        "feature_name": {
          "description": "Feature being tested by this test",
          "maxLength": 256,
          "type": "string"
        },
        "test_creation_date": {
          "description": "Date the test was created\nISO-8601 format",
          "type": "string"
        },
        "testbed_name": {
          "description": "Grouping of all of the hardware used to execute the test",
          "maxLength": 256,
          "type": "string"
        },
        "module_name": {
          "description": "Testbed component list",
          "maxLength": 256,
          "type": "string"
        },
        "phy_name": {
          "description": "Radio configuration used by the device",
          "maxLength": 256,
          "type": "string"
        },
        "test_result": {
          "enum": [
            "block",
            "fail",
            "metrics",
            "pass",
            "skip"
          ],
          "type": "string"
        },
        "engineer_name": {
          "description": "Name of the engineer who created the test",
          "maxLength": 256,
          "type": "string"
        },
        "exception_msg": {
          "description": "If an error occurs, this is the message returned.",
          "type": "string"
        },
        "iot_req_id": {
          "maxLength": 256,
          "type": "string"
        },
        "tool_chain": {
          "description": "Need table for validation.\nThis is the tool and version used to build the application with colon separation\niar:7.80.1",
          "maxLength": 256,
          "type": "string"
        },
        "vendor_name": {
          "maxLength": 256,
          "type": "string"
        },
        "vendor_build": {
          "maxLength": 256,
          "type": "string"
        },
        "vendor_result": {
          "maxLength": 256,
          "type": "string"
        },
        "notes": {
          "maxLength": 1024,
          "type": "string"
        },
        "portal_watch": {
          "description": "Change this to boolean - default false",
          "type": "string"
        },
        "test_duration_sec": {
          "description": "Test duration in seconds",
          "type": "number"
        },
        "test_bed_label": {
          "maxLength": 256,
          "type": "string"
        },
        "req_id": {
          "maxLength": 256,
          "type": "string"
        },
        "product_line": {
          "maxLength": 256,
          "type": "string"
        },
        "product_type": {
          "maxLength": 256,
          "type": "string"
        },
        "customer_type": {
          "maxLength": 256,
          "type": "string"
        },
        "jenkins_test_case_results_url": {
          "maxLength": 1500,
          "type": "string"
        },
        "test_case_uuid": {
          "description": "UUID generated by the client software",
          "type": "string"
        }
      },
      "required": [
        "executor_name",
        "feature_name",
        "iot_req_id",
        "module_name",
        "session_pk_id",
        "test_case_id",
        "test_case_name",
        "test_case_version_num",
        "test_creation_date",
        "test_duration_sec",
        "test_result",
        "test_result_type",
        "testbed_name",
        "tool_chain"
      ]
    },
    "SqaTestSession": {
      "description": "Tied to the table: dbo.jobStatusTable",
      "type": "object",
      "properties": {
        "PK_ID": {
          "description": "UUID generated by the Jenkins client software",
          "type": "string"
        },
        "startTime": {
          "description": "ISO-8601 Datetime",
          "type": "string"
        },
        "stopTime": {
          "description": "ISO-8601 datetime",
          "type": "string"
        },
        "jenkinsJobStatus": {
          "description": "Status of the Jenkins job",
          "enum": [
            "COMPLETE",
            "FAIL",
            "IN PROGRESS"
          ],
          "type": "string"
        },
        "duration": {
          "description": "Elapsed number of seconds for the Jenkins job.\nShould be close to stop time - start time.\nChange the data type in the DB to integer.",
          "type": "integer"
        },
        "jobType": {
          "description": "Type of Jenkins job",
          "maxLength": 256,
          "type": "string"
        },
        "releaseName": {
          "maxLength": 256,
          "type": "string"
        },
        "branchName": {
          "maxLength": 256,
          "type": "string"
        },
        "stackName": {
          "maxLength": 256,
          "type": "string"
        },
        "SDKBuildNum": {
          "type": "number"
        },
        "SDKUrl": {
          "maxLength": 1500,
          "type": "string"
        },
        "studioUrl": {
          "maxLength": 1500,
          "type": "string"
        },
        "totalTests": {
          "type": "integer"
        },
        "PASS_cnt": {
          "type": "integer"
        },
        "FAIL_cnt": {
          "type": "integer"
        },
        "SKIP_cnt": {
          "type": "integer"
        },
        "BLOCK_cnt": {
          "type": "integer"
        },
        "jenkinsServerName": {
          "maxLength": 256,
          "type": "string"
        },
        "jenkinRunNum": {
          "type": "integer"
        },
        "jenkinsJobName": {
          "maxLength": 1500,
          "type": "string"
        },
        "jenkinsTestResultsUrl": {
          "maxLength": 1500,
          "type": "string"
        },
        "traceId": {
          "maxLength": 500,
          "type": "string"
        },
        "testFramework": {
          "maxLength": 256,
          "type": "string"
        },
        "SDKVersion": {
          "maxLength": 256,
          "type": "string"
        },
        "test_run_by": {
          "maxLength": 256,
          "type": "string"
        },
        "package_name": {
          "maxLength": 500,
          "type": "string"
        },
        "package_version": {
          "maxLength": 50,
          "type": "string"
        },
        "package_datetime": {
          "description": "ISO-8601 Datetime",
          "type": "string"
        },
        "from_branch_name": {
          "description": "Branch from which the test originated",
          "maxLength": 250,
          "type": "string"
        },
        "from_build_num": {
          "description": "Build number from which the test originated",
          "type": "number"
        }
      },
      "required": [
        "PK_ID",
        "SDKBuildNum",
        "branchName",
        "jenkinRunNum",
        "jenkinsJobName",
        "jenkinsJobStatus",
        "jenkinsServerName",
        "jenkinsTestResultsUrl",
        "releaseName",
        "stackName",
        "startTime"
      ]
    },
    "LogEvent": {
      "type": "object"
    },
    "ExceptionEvent": {
      "type": "object"
    },
    "TestRailResult": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string"
        },
        "run_id": {
          "type": "integer"
        },
        "status": {
          "type": "string"
        },
        "comment": {
          "type": "string"
        },
        "version": {
          "type": "string"
        },
        "defects": {
          "type": "string"
        },
        "assigned_to_id": {
          "type": "integer"
        },
        "custom_props": {
          "$ref": "#/definitions/TestResultCustomProps"
        }
      },
      "required": [
        "id",
        "run_id",
        "status"
      ]
    },
    "TestResultCustomProps": {
      "type": "object",
      "additionalProperties": {
        "type": "string"
      }
    },
    "XrayInfo": {
      "type": "object",
      "properties": {
        "project": {
          "type": "string"
        },
        "summary": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "version": {
          "type": "string"
        },
        "revision": {
          "type": "string"
        },
        "user": {
          "type": "string"
        },
        "start_date": {
          "type": "string"
        },
        "finish_date": {
          "type": "string"
        },
        "test_plan_key": {
          "type": "string"
        },
        "test_environments": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "XrayStep": {
      "type": "object",
      "properties": {
        "action": {
          "type": "string"
        },
        "data": {
          "type": "string"
        },
        "result": {
          "type": "string"
        }
      },
      "required": [
        "action",
        "data",
        "result"
      ]
    },
    "XrayParameter": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string"
        },
        "value": {
          "type": "string"
        }
      },
      "required": [
        "name",
        "value"
      ]
    },
    "XrayCustomField": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string"
        },
        "id": {
          "type": "integer"
        },
        "value": {
          "type": "string"
        }
      },
      "required": [
        "name",
        "value"
      ]
    },
    "XrayIteration": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string"
        },
        "id": {
          "type": "integer"
        },
        "parameters": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/XrayParameter"
          }
        },
        "status": {
          "enum": [
            "ABORTED",
            "BLOCK",
            "EXECUTING",
            "FAIL",
            "PASS",
            "SKIP",
            "TODO"
          ],
          "type": "string"
        }
      },
      "required": [
        "parameters",
        "status"
      ]
    },
    "XrayTestInfo": {
      "type": "object",
      "properties": {
        "project_key": {
          "type": "string"
        },
        "summary": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "test_type": {
          "type": "string"
        },
        "requirement_keys": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "labels": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "steps": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/XrayStep"
          }
        }
      },
      "required": [
        "project_key"
      ]
    },
    "XrayTestExecUpdate": {
      "type": "object",
      "properties": {
        "test_key": {
          "type": "string"
        },
        "status": {
          "enum": [
            "ABORTED",
            "BLOCK",
            "EXECUTING",
            "FAIL",
            "PASS",
            "SKIP",
            "TODO"
          ],
          "type": "string"
        },
        "test_info": {
          "$ref": "#/definitions/XrayTestInfo"
        },
        "test_version": {
          "type": "string"
        },
        "start": {
          "type": "string"
        },
        "finish": {
          "type": "string"
        },
        "comment": {
          "type": "string"
        },
        "executed_by": {
          "type": "string"
        },
        "assignee": {
          "type": "string"
        },
        "steps": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/XrayStep"
          }
        },
        "iterations": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/XrayIteration"
          }
        },
        "custom_fields": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/XrayCustomField"
          }
        }
      },
      "required": [
        "status",
        "test_key"
      ]
    },
    "XrayImportTestExecution": {
      "type": "object",
      "properties": {
        "test_execution_key": {
          "type": "string"
        },
        "tests": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/XrayTestExecUpdate"
          }
        },
        "test_map_field_name": {
          "type": "string"
        },
        "info": {
          "$ref": "#/definitions/XrayInfo"
        },
        "add_tests_to_plan": {
          "type": "boolean"
        },
        "create_test_for_execution": {
          "type": "boolean"
        }
      },
      "required": [
        "test_execution_key",
        "tests"
      ]
    },
    "SqaTestResultApps": {
      "type": "object",
      "properties": {
        "test_case_uuid": {
          "maxLength": 36,
          "type": "string"
        },
        "artifact_id": {
          "maxLength": 36,
          "type": "string"
        }
      },
      "required": [
        "artifact_id",
        "test_case_uuid"
      ]
    }
  }
}