import{G as B,u as v,P as L,d as P,a as U,b as q,r as f,g as V,o as E,c as M,e as j,f as c,h as n,w as u,_ as N,i as R,j as a,k as G,l as I,m as T,B as D,n as O,t as $,p as z,s as A,q as F,v as H}from"./index-KHiidVve.js";import{_ as J,a as K}from"./FormItem-BLErRK4c.js";function Q(p){return L(v.login,p)}function W(p){return B(v.clientStatus,p)}const X={class:"h-full"},Y={class:"absolute top-1/2 left-1/2 -translate-1/2 rounded-2xl p-5 w-2xl"},Z={class:"flex items-center justify-between"},le=P({__name:"LoginView",setup(p){const{t,locale:h}=U(),b=q(),g=f(!1),m=f(null),l=f({default_language:V(),server_addr:"http://127.0.0.1:80"}),k={default_language:{required:!0},cache_dir:{required:!0,message:t("login.localCacheErrMsg")},user_token:{required:!0,message:t("login.tokenErrMsg")},server_addr:{required:!0,message:t("login.cloudServerErrMsg")}},x=o=>{A(o),h.value=o},w=()=>{var o;g.value||(g.value=!0,(o=m.value)==null||o.validate(async e=>{if(e){g.value=!1;return}const[s,r]=await Q(l.value);if(g.value=!1,!s&&r&&r.status===0){const[d,i]=await F({user_id:r.data.user_id});!d&&(i==null?void 0:i.status)===0&&H({...r.data,...i.data}),b.push({path:"/"})}}))};return E(async()=>{const[o,e]=await W({default_language:l.value.default_language});if(!o&&e&&e.status===0){const s=e.data;l.value={...l.value,default_language:s.default_language,cache_dir:s.cache_dir,user_token:s.set_user_token,server_addr:s.cloud_server_addr}}}),(o,e)=>{const s=R,r=G,d=K,i=I,y=D,C=J,S=z;return j(),M("div",X,[e[6]||(e[6]=c("div",{class:"fixed inset-0 select-none h-screen w-screen",style:{"background-image":`linear-gradient(
          13deg,
          #cdd5e0,
          rgb(205, 213, 224),
          #e6e6e6,
          #bbc8d0
        )`}},null,-1)),c("div",Y,[n(S,null,{default:u(()=>[e[5]||(e[5]=c("div",{class:"flex items-center justify-center mb-5"},[c("img",{src:N,alt:"Logo",class:"h-12"})],-1)),n(s),n(C,{ref_key:"formRef",ref:m,model:a(l),rules:k},{default:u(()=>[n(d,{label:"Cloud Server",path:"server_addr"},{default:u(()=>[n(r,{value:a(l).server_addr,"onUpdate:value":e[0]||(e[0]=_=>a(l).server_addr=_),placeholder:a(t)("login.cloudServerPlaceholder")},null,8,["value","placeholder"])]),_:1}),n(d,{label:"Token",path:"user_token"},{default:u(()=>[n(r,{value:a(l).user_token,"onUpdate:value":e[1]||(e[1]=_=>a(l).user_token=_),placeholder:a(t)("login.tokenPlaceholder")},null,8,["value","placeholder"])]),_:1}),n(d,{label:a(t)("login.localCacheLabel"),path:"cache_dir"},{default:u(()=>[n(r,{value:a(l).cache_dir,"onUpdate:value":e[2]||(e[2]=_=>a(l).cache_dir=_),placeholder:a(t)("login.localCachePlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),n(d,{label:a(t)("login.language"),path:"default_language"},{default:u(()=>[n(i,{"onUpdate:value":[x,e[3]||(e[3]=_=>a(l).default_language=_)],placeholder:a(t)("login.languagePlaceholder"),value:a(l).default_language,options:a(T)},null,8,["placeholder","value","options"])]),_:1},8,["label"]),c("div",Z,[e[4]||(e[4]=c("div",{class:"flex items-center"},null,-1)),n(d,null,{default:u(()=>[n(y,{type:"primary",loading:a(g),onClick:w},{default:u(()=>[O($(a(t)("login.submitBtn")),1)]),_:1},8,["loading"])]),_:1})])]),_:1},8,["model"])]),_:1})])])}}});export{le as default};
