import{d as F,c as V,e as f,f as r,aF as jt,ad as qe,a2 as he,r as D,C as B,w as i,h as s,p as we,R as Ut,j as e,J as oe,I as ye,Y as Ct,i as Se,a1 as qt,aM as Bt,z as Me,b as Ve,Z as zt,a$ as Ft,a as Ee,F as At,x as L,k as St,B as Mt,n as R,t as u,o as Vt,aV as Et,aT as pe,$ as Ht,A as Rt,a4 as gt,N as ue,O as Qt,D as Jt,a7 as Wt,aW as Gt,V as Kt,a0 as Yt,b1 as ht,a8 as wt,ac as me,aX as Zt,aY as Xt,E as ea,aZ as ge,a_ as yt,aK as ta,K as _}from"./index-KHiidVve.js";import{b as aa,c as sa,e as oa,f as na,h as la,s as ia,i as ra,d as ca,j as pa,k as ua,g as da}from"./exp-B9hhSwm7.js";import{A as bt,d as It,f as _a,F as kt}from"./FileSaver.min-BIkVFdAe.js";import{u as fa}from"./useInterval-BH-fUIwH.js";import{u as xe,n as ma}from"./exp-BsGMuzkz.js";import{u as xa}from"./groupDetail-D3IL5OYD.js";import{o as Ce,P as va}from"./index-DKys7GAE.js";import{D as ga,R as ha,E as wa}from"./ExpsTpl-RqauAMFF.js";import{i as ya}from"./json-editor-vue-CQYZvFYh.js";import{_ as ba}from"./DynamicFormItem.vue_vue_type_script_setup_true_lang-DZP8b5Hp.js";import{_ as Ia,a as ka}from"./FormItem-BLErRK4c.js";import{A as Ca}from"./Add-CUVNZISR.js";import{_ as qa}from"./Alert-JPiDiWyN.js";import{_ as za}from"./Badge-CscNEgft.js";import{_ as Sa,a as Ma}from"./Tabs-7QiGpSYZ.js";import"./index-kXdYNgTn.js";import"./Copy16Filled-BsDfRmvo.js";import"./HandRight24Filled-D_76ns5U.js";import"./Popconfirm-Dt2TFIl_.js";import"./task-DoNTrAeq.js";import"./DynamicForm.vue_vue_type_script_setup_true_lang-6MzDvbBp.js";import"./InputNumber-nTwBv73q.js";import"./Add-CUOykUgu.js";import"./debounce-MHG2Ws0B.js";const Va={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},Ea=F({name:"AttachArrowRight20Filled",render:function(l,c){return f(),V("svg",Va,c[0]||(c[0]=[r("g",{fill:"none"},[r("path",{d:"M5.28 10.609l5.304-5.304a2.75 2.75 0 0 1 4.064 3.697a5.487 5.487 0 0 1 1.611.285a4.252 4.252 0 0 0-6.736-5.042L4.22 9.548a.75.75 0 0 0 1.06 1.06zm2.829 4.95l.893-.894a5.48 5.48 0 0 0 .349 1.773l-.182.181A2.75 2.75 0 0 1 5.28 12.73l5.657-5.657a.75.75 0 1 1 1.06 1.06l-5.656 5.658a1.25 1.25 0 0 0 1.768 1.768zM19 14.5a4.5 4.5 0 1 1-9 0a4.5 4.5 0 0 1 9 0zm-2.147.354l.003-.003a.499.499 0 0 0 .144-.348v-.006a.5.5 0 0 0-.146-.35l-2-2a.5.5 0 0 0-.708.707L15.293 14H12.5a.5.5 0 0 0 0 1h2.793l-1.147 1.146a.5.5 0 0 0 .708.708l2-2z",fill:"currentColor"})],-1)]))}}),Ra={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},$a=F({name:"BookDatabase20Regular",render:function(l,c){return f(),V("svg",Ra,c[0]||(c[0]=[r("g",{fill:"none"},[r("path",{d:"M4 4v12a2 2 0 0 0 2 2h9.5a.5.5 0 0 0 0-1H6a1 1 0 0 1-1-1h10a1 1 0 0 0 1-1V4a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2zm10-1a1 1 0 0 1 1 1v11H5V4a1 1 0 0 1 1-1h8zM8.483 6.345C8.126 6.552 8 6.787 8 7c0 .213.126.448.483.655C8.841 7.863 9.374 8 10 8c.626 0 1.159-.137 1.517-.345c.357-.207.483-.442.483-.655c0-.213-.126-.448-.483-.655C11.159 6.137 10.626 6 10 6c-.626 0-1.159.137-1.517.345zM12 8.531c-.544.31-1.254.469-2 .469c-.747 0-1.456-.16-2-.47V11c0 .123.107.365.496.607c.367.228.9.393 1.504.393s1.137-.165 1.504-.393c.389-.242.496-.484.496-.607V8.53zM7 7c0-.687.434-1.202.981-1.52C8.528 5.163 9.245 5 10 5c.755 0 1.472.163 2.019.48c.547.318.981.833.981 1.52v4c0 .627-.452 1.135-.968 1.456c-.538.334-1.256.544-2.032.544s-1.494-.21-2.032-.544C7.452 12.136 7 11.627 7 11V7z",fill:"currentColor"})],-1)]))}}),La={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},$t=F({name:"Play24Regular",render:function(l,c){return f(),V("svg",La,c[0]||(c[0]=[r("g",{fill:"none"},[r("path",{d:"M7.608 4.615a.75.75 0 0 0-1.108.659v13.452a.75.75 0 0 0 1.108.659l12.362-6.726a.75.75 0 0 0 0-1.318L7.608 4.615zM5 5.274c0-1.707 1.826-2.792 3.325-1.977l12.362 6.726c1.566.853 1.566 3.101 0 3.953L8.325 20.702C6.826 21.518 5 20.432 5 18.726V5.274z",fill:"currentColor"})],-1)]))}}),Da={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 32 32"},Oa=F({name:"QuadrantPlot",render:function(l,c){return f(),V("svg",Da,c[0]||(c[0]=[jt('<path d="M30 15H17V2h-2v13H2v2h13v13h2V17h13v-2z" fill="currentColor"></path><path d="M5 30a3 3 0 1 1 3-3a3.003 3.003 0 0 1-3 3zm0-4a1 1 0 1 0 1 1a1.001 1.001 0 0 0-1-1z" fill="currentColor"></path><path d="M8 8a3 3 0 1 1 3-3a3.003 3.003 0 0 1-3 3zm0-4a1 1 0 1 0 1 1a1.001 1.001 0 0 0-1-1z" fill="currentColor"></path><path d="M22 13a3 3 0 1 1 3-3a3.003 3.003 0 0 1-3 3zm0-4a1 1 0 1 0 1 1a1.001 1.001 0 0 0-1-1z" fill="currentColor"></path><circle cx="11" cy="11" r="2" fill="currentColor"></circle><circle cx="11" cy="21" r="2" fill="currentColor"></circle><circle cx="21" cy="21" r="2" fill="currentColor"></circle><circle cx="22" cy="28" r="2" fill="currentColor"></circle><circle cx="28" cy="24" r="2" fill="currentColor"></circle><circle cx="4" cy="11" r="2" fill="currentColor"></circle><circle cx="28" cy="4" r="2" fill="currentColor"></circle>',11)]))}}),Ta={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 32 32"},Na=F({name:"ScriptReference",render:function(l,c){return f(),V("svg",Ta,c[0]||(c[0]=[r("path",{d:"M4 20v2h4.586L2 28.586L3.414 30L10 23.414V28h2v-8H4z",fill:"currentColor"},null,-1),r("path",{d:"M27.17 26l-2.58 2.58L26 30l4-4l-4-4l-1.42 1.41L27.17 26z",fill:"currentColor"},null,-1),r("path",{d:"M18.83 26l2.58-2.58L20 22l-4 4l4 4l1.42-1.41L18.83 26z",fill:"currentColor"},null,-1),r("path",{d:"M25.7 9.3l-7-7A.909.909 0 0 0 18 2H8a2.006 2.006 0 0 0-2 2v12h2V4h8v6a2.006 2.006 0 0 0 2 2h6v6h2v-8a.91.91 0 0 0-.3-.7zM18 10V4.4l5.6 5.6z",fill:"currentColor"},null,-1)]))}}),Pa={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},ja=F({name:"BellOutlined",render:function(l,c){return f(),V("svg",Pa,c[0]||(c[0]=[r("path",{d:"M816 768h-24V428c0-141.1-104.3-257.7-240-277.1V112c0-22.1-17.9-40-40-40s-40 17.9-40 40v38.9c-135.7 19.4-240 136-240 277.1v340h-24c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h216c0 61.8 50.2 112 112 112s112-50.2 112-112h216c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM512 888c-26.5 0-48-21.5-48-48h96c0 26.5-21.5 48-48 48zM304 768V428c0-55.6 21.6-107.8 60.9-147.1S456.4 220 512 220c55.6 0 107.8 21.6 147.1 60.9S720 372.4 720 428v340H304z",fill:"currentColor"},null,-1)]))}});function ze(v){var n,m,t,d,z,b,I,O,g,E,H,re,ce,T,S,Q,J,C,Z,j,W,G,K,P,A;const l=xe();l.expInfo=v.data,l.program={waveform_script:(m=(n=v.data)==null?void 0:n.exp)==null?void 0:m.waveform_script,space_parameter_script:(d=(t=v.data)==null?void 0:t.exp)==null?void 0:d.space_parameter_script},l.running={formValue:{title:(b=(z=v.data)==null?void 0:z.exp)==null?void 0:b.title,desc:(O=(I=v.data)==null?void 0:I.exp)==null?void 0:O.desc,...(E=(g=v.data)==null?void 0:g.exp)==null?void 0:E.options},paramsList:[]};const c=JSON.parse(JSON.stringify(l.allQubits));let y=[];qe((ce=(re=(H=v.data)==null?void 0:H.exp)==null?void 0:re.wave_circuit)==null?void 0:ce.gates,N=>{y=y.concat(N.entity)}),y.length>0&&c.forEach(N=>{y.includes(N.value)?N.visible=!0:N.visible=!1}),l.allQubits=c,he((Q=(S=(T=v.data)==null?void 0:T.exp)==null?void 0:S.wave_circuit)==null?void 0:Q.gates)||(l.gates=(Z=(C=(J=v.data)==null?void 0:J.exp)==null?void 0:C.wave_circuit)==null?void 0:Z.gates),he((G=(W=(j=v.data)==null?void 0:j.exp)==null?void 0:W.wave_circuit)==null?void 0:G.layers)||(l.layers=Object.values((A=(P=(K=v.data)==null?void 0:K.exp)==null?void 0:P.wave_circuit)==null?void 0:A.layers))}const Ua=F({__name:"MsgView",setup(v,{expose:l}){const c=xe(),y=D(!1),n=[{title:"Message Id",key:"message_id",width:100},{title:"Sub Process Id",key:"sub_process_id",width:130},{title:"Message Level",key:"message_level",width:130},{title:"Message",key:"message"},{title:"Timestamp",key:"timestamp",width:180,render:d=>d.timestamp?new Date(d.timestamp).toLocaleString():""}],m=d=>{d||t()},t=()=>{y.value=!1};return l({open:()=>y.value=!0,close:t}),(d,z)=>{const b=Ut,I=we,O=ye;return f(),B(O,{show:e(y),"onUpdate:show":z[0]||(z[0]=g=>oe(y)?y.value=g:null),"on-update:show":m},{default:i(()=>[s(I,{style:{width:"80vw"},size:"huge",bordered:!1,role:"dialog","aria-modal":"true",class:"!pt-0"},{default:i(()=>{var g,E;return[s(b,{columns:n,data:(E=(g=e(c))==null?void 0:g.expInfo)==null?void 0:E.exp_msg,pagination:!1,"scroll-x":1e3,"max-height":"500px"},null,8,["data"])]}),_:1})]),_:1},8,["show"])}}}),Ba=F({__name:"TemplateData",props:{templateData:{}},setup(v,{expose:l}){const c=D(),y=Ct(),n=D(!1);return l({open:()=>{n.value=!0}}),(t,d)=>{const z=Se,b=qt,I=we,O=ye;return f(),B(O,{show:e(n),"onUpdate:show":d[0]||(d[0]=g=>oe(n)?n.value=g:null)},{default:i(()=>[s(I,{style:{width:"700px"},"aria-hidden":""},{default:i(()=>[d[1]||(d[1]=r("div",{class:"text-xl text-center"},"Template Data",-1)),s(z,{class:"!my-2"}),s(b,{style:{"max-height":"600px","min-height":"200px"}},{default:i(()=>[s(e(ya),{class:Bt(["w-full",[e(y).baseColor==="#000"?"jse-theme-dark":""]]),"model-value":t.templateData,mode:"text",ref_key:"jsonEditorRef",ref:c},null,8,["class","model-value"])]),_:1})]),_:1})]),_:1},8,["show"])}}}),Fa={key:1,class:"pr-3"},Aa={class:"mt-7 w-full flex"},Ha=F({__name:"ExpSubmit",setup(v){const l=xe(),c=Me(),y=Ve(),n=zt(),{expInfo:m,layers:t,gates:d,program:z,expOptions:b,running:I}=Ft(l),O=D(),{t:g}=Ee(),E=D(!1),H=At(()=>{const T={title:{required:!0,message:g("common.required")},desc:{required:!0,message:g("common.required")},options:{required:!0,message:g("common.required")}};return Object.keys(b.value||[]).forEach(S=>{T[S]={required:!0,message:g("common.required")}}),T}),re=async()=>{var W,G,K,P,A,N,U,ne,Y,$,ve,de,X;if(E.value)return;E.value=!0;const T={};t.value.forEach((be,le)=>{T[String(le)]=be});const{title:S,desc:Q,...J}=(W=I.value)==null?void 0:W.formValue,C={template_name:(K=(G=m==null?void 0:m.value)==null?void 0:G.exp)==null?void 0:K.template.split("/")[1],device_group_name:c.query.device_group_name,space_id:c.query.space_id,task_id:(P=m.value)==null?void 0:P.task_id,experiment_json:{...m.value||{},title:S,desc:Q,template:(N=(A=m==null?void 0:m.value)==null?void 0:A.exp)==null?void 0:N.template,template_data:(ne=(U=m==null?void 0:m.value)==null?void 0:U.exp)==null?void 0:ne.template_data,wave_circuit:{gates:d.value||{},layers:T},waveform_script:((Y=z.value)==null?void 0:Y.waveform_script)||[],space_parameter_script:(($=z.value)==null?void 0:$.space_parameter_script)||[],options:J}};(ve=C==null?void 0:C.experiment_json)!=null&&ve.exp&&((de=C==null?void 0:C.experiment_json)==null||delete de.exp),(X=C==null?void 0:C.experiment_json)==null||delete X.nr;const[Z,j]=await aa(C);E.value=!1,!Z&&(j==null?void 0:j.status)===0&&(n.success("Experiment Running"),l.showPlotParamsModal=!1,y.replace({name:"finalSetting",query:{...c.query,exp_id:j.data.exp_id}}).then(()=>{window.location.reload()}))},ce=T=>{T||(l.showPlotParamsModal=!1)};return(T,S)=>{const Q=St,J=ka,C=qt,Z=Se,j=Mt,W=Ia,G=we,K=ye;return f(),B(K,{show:e(l).showPlotParamsModal,"onUpdate:show":S[2]||(S[2]=P=>e(l).showPlotParamsModal=P),onChange:ce},{default:i(()=>[s(G,{style:{width:"800px",position:"fixed",right:"50px",top:"50px"}},{default:i(()=>{var P,A;return[s(W,{model:e(I).formValue,rules:e(H),ref_key:"formRef",ref:O,class:"min-w-[340px]",disabled:!!((A=(P=e(l))==null?void 0:P.expInfo)!=null&&A.exp_id)},{default:i(()=>{var N,U,ne,Y;return[s(C,{style:{"max-height":"calc(100vh - 370px)","padding-right":"12px"}},{default:i(()=>[r("div",null,[s(J,{label:"Exp Title",path:"title"},{default:i(()=>[s(Q,{value:e(I).formValue.title,"onUpdate:value":S[0]||(S[0]=$=>e(I).formValue.title=$)},null,8,["value"])]),_:1}),s(J,{label:"Exp Desc",path:"desc"},{default:i(()=>[s(Q,{type:"textarea",value:e(I).formValue.desc,"onUpdate:value":S[1]||(S[1]=$=>e(I).formValue.desc=$)},null,8,["value"])]),_:1})]),e(b)?(f(),B(ba,{key:0,paramsCfg:e(b),"form-value":e(I).formValue},null,8,["paramsCfg","form-value"])):L("",!0)]),_:1}),(U=(N=e(l))==null?void 0:N.expInfo)!=null&&U.exp_id?L("",!0):(f(),B(Z,{key:0,class:"!mb-0"})),(Y=(ne=e(l))==null?void 0:ne.expInfo)!=null&&Y.exp_id?L("",!0):(f(),V("div",Fa,[r("div",Aa,[s(j,{type:"primary",size:"small",loading:e(E),onClick:re,class:"w-full flex-1"},{icon:i(()=>[s(e($t))]),default:i(()=>[R(" "+u(e(g)("expInfo.submit")),1)]),_:1},8,["loading"])])]))]}),_:1},8,["model","rules","disabled"])]}),_:1})]),_:1},8,["show"])}}}),Qa={class:"min-h-[98px] flex justify-between"},Ja={key:0,class:"flex flex-col pr-4 mr-5",style:{"border-right":"1px solid rgba(56, 137, 197, 0.35)"}},Wa={class:"text-xl font-bold mr-2"},Ga={class:"text-xl font-bold"},Ka={class:"text-sm font-light mt-2 opacity-60"},Ya={class:"flex-1 flex"},Za={class:"flex flex-col gap-1.5 min-w-[260px] pr-5 mr-5",style:{"border-right":"1px solid rgba(56, 137, 197, 0.35)"}},Xa={class:"flex"},es={class:"inline-block pr-1"},ts={class:"font-bold"},as={class:"inline-flex items-center"},ss={class:"flex-1 flex gap-1.5 min-w-[260px]"},os={class:"flex flex-col gap-1.5 flex-1"},ns={class:"flex"},ls={key:0,class:"pr-1"},is={class:"font-bold"},rs={class:"flex items-center"},cs={key:0,class:"italic opacity-70 pr-1 text-xs"},ps={key:1,class:"italic pr-1 text-xs"},us={class:"flex"},ds={key:1,class:"flex flex-col gap-2 min-w-52"},_s={class:"flex gap-4 justify-between"},fs={key:1},ms={class:"flex gap-2"},xs={class:"flex items-center gap-2"},vs={class:"text-lg mb-4 flex justify-between"},gs={class:"text-lg mb-4 flex justify-between"},hs={class:"relative"},ws=F({__name:"ExpInfoView",setup(v){const{t:l}=Ee(),c=Ct(),y=zt(),n=Me(),m=Ve(),t=xe(),d=xa(),z=D(),b=D(),I=()=>{var o,a,p;(a=(o=t.expInfo)==null?void 0:o.exp)!=null&&a.template&&((p=b.value)==null||p.open())},O=D(),g=async()=>{const o=n.query.device_group_name;if(!o)return;const[a,p]=await ea({device_group_name:o});if(!a&&(p==null?void 0:p.status)===0){const{space_list:x,...k}=p.data;d.groupInfo=k,d.spaceList=x.map(h=>({...h,label:h.space_name,value:h.space_id}))}},E=async()=>{var p;if(n.query.exp_id===void 0||n.query.exp_id==="")return;const[o,a]=await da({exp_id:n.query.exp_id,device_group_name:n.query.device_group_name,space_id:n.query.space_id});!o&&(a==null?void 0:a.status)===0&&((p=a.data)!=null&&p.data&&(a.data.data=JSON.parse(a.data.data)),t.result=a.data)},H=async()=>{t.loading=!0;const{device_group_name:o,exp_id:a}=n.query;if(!o||!a){t.loading=!1;return}const[p,x]=await pa({device_group_name:o,exp_id:a});t.loading=!1,!p&&(x==null?void 0:x.status)===0&&(ze(x),pe(()=>{n.query.dup&&(W(),pe(()=>{setTimeout(()=>{m.replace({name:"waveforms",query:Ce(n.query,"dup")})},300)}))}),E())},re=async()=>{var p;if((p=t==null?void 0:t.expInfo)!=null&&p.status&&[me.COMPLETE,me.CANCELED,me.ERROR].includes(t.expInfo.status)){S();return}if(!n.query.exp_id)return;const[o,a]=await ua({device_group_name:n.query.device_group_name,exp_id:n.query.exp_id});!o&&(a==null?void 0:a.status)===0&&(t.expInfo={...t.expInfo,...a.data||{}})},ce=async()=>{var p,x;const[o,a]=await sa();if(!o&&(a==null?void 0:a.status)===0){const k={};Object.keys(a.data).forEach(ee=>{k[ee]=a.data[ee].default?a.data[ee].default:void 0});const h=(x=(p=t.expInfo)==null?void 0:p.exp)==null?void 0:x.options;t.expOptions=a.data,t.running={...t.running,formValue:{...t.running.formValue,...he(h)?k:{}}}}},{start:T,stop:S}=fa(re,{isManual:!0,duration:3*1e3}),Q=async()=>{const[o,a]=await oa();!o&&(a==null?void 0:a.status)===0&&(t.waveCompiler=a.data)},J=async()=>{const[o,a]=await na();!o&&(a==null?void 0:a.status)===0&&(t.waveFunctions=a.data)},C=async()=>{const[o,a]=await la({device_group_name:n.query.device_group_name,space_id:n.query.space_id});if(!o&&(a==null?void 0:a.status)===0){let p=[];if(qe(a.data,(x,k)=>{p=p.concat(x.map((h,ee)=>({id:ma(),value:h,visible:ee<10,type:k})))}),t.allQubits=p,!n.query.exp_id){const x=JSON.parse(JSON.stringify(t.allQubits));let k=[];qe(t==null?void 0:t.gates,h=>{k=k.concat(h.entity)}),k.length>0&&x.forEach(h=>{k.includes(h.value)?h.visible=!0:h.visible=!1}),t.allQubits=x;return}pe(()=>{H(),T()})}},Z=()=>{var o;(o=O.value)==null||o.open()},j=()=>{const o=new URLSearchParams({device_group_name:n.query.device_group_name,task_id:n.query.task_id,task_title:n.query.task_title,space_id:n.query.space_id,exp_id:n.query.exp_id,dup:String(1)});window.open(`/experiment/waveforms?${o.toString()}`,"_blank")},W=()=>{const o=JSON.parse(JSON.stringify(t.expInfo));delete o.exp_id,delete o.progress,delete o.status,delete o.exp_msg,t.expInfo=o,t.result=void 0,pe(()=>{y.success("Duplicated successfully"),m.replace({name:"waveforms",query:Ce(n.query,["exp_id"])})})},G=async()=>{const[o,a]=await ia({exp_id:n.query.exp_id});!o&&(a==null?void 0:a.status)===0&&y.success("实验终止成功")},K=()=>{var o;(o=z.value)==null||o.open()};Vt(()=>{if(ce(),C(),g(),setTimeout(()=>{Q(),J()},100),n.query.create=="1"){const o=Et("t");o&&(ze(o),pe(()=>{setTimeout(()=>{m.replace({name:"waveforms",query:Ce(n.query,"combine")}).then(()=>{localStorage.removeItem("t")})},200)}))}});const P=()=>{t.showPlotParamsModal=!0};Ht(S);const A=async()=>{var p,x;const[o,a]=await ra({group_name:n.query.device_group_name,exp_id:String((p=t==null?void 0:t.expInfo)==null?void 0:p.exp_id)});!o&&(a==null?void 0:a.status)===0&&kt.saveAs(`${ge(location.origin)}/${ge((x=a==null?void 0:a.data)==null?void 0:x.filename)}`,yt(a.data.filename))},N=async()=>{var p,x;const[o,a]=await ca({group_name:n.query.device_group_name,space_id:n.query.space_id,version:String((p=t.expInfo)==null?void 0:p.space_timestamp)});!o&&(a==null?void 0:a.status)===0&&kt.saveAs(`${ge(location.origin)}/${ge((x=a==null?void 0:a.data)==null?void 0:x.filename)}`,yt(a.data.filename))},U=D(!1),ne=o=>{o||(U.value=!1)},Y=D(),$=D(),ve=()=>{var o;(o=Y.value)==null||o.refresh()},de=()=>{U.value=!0},X=D(!1),be=o=>{o||(X.value=!1,$.value="")},le=D(!1),Lt=o=>{o||(le.value=!1)},Dt=()=>{var o;(o=t.expInfo)!=null&&o.exp_id?le.value=!0:X.value=!0};return(o,a)=>{const p=ue,x=Rt("router-link"),k=Wt,h=Mt,ee=Gt,Ot=Kt,Tt=za,Nt=qa,Re=Se,Ie=we,ke=ye,Pt=St;return f(),V(gt,null,[s(Nt,{type:"info","show-icon":!1},{default:i(()=>{var M,te,ae,se,ie,_e,$e,Le,De,Oe,Te,Ne,Pe,je,Ue,Be,Fe,Ae,He,Qe,Je,We,Ge,Ke,Ye,Ze,Xe,et,tt,at,st,ot,nt,lt,it,rt,ct,pt,ut,dt,_t,ft,mt,xt;return[r("div",Qa,[(M=e(d))!=null&&M.groupInfo?(f(),V("div",Ja,[s(x,{class:"underline underline-offset-4 inline-flex items-center gap-0.5",to:{name:"deviceGroup",query:{org:(ae=(te=e(d))==null?void 0:te.groupInfo)==null?void 0:ae.organization_id}}},{default:i(()=>{var w;return[r("span",Wa,[s(p,{component:e(Qt)},null,8,["component"]),R(" "+u((w=e(d).groupInfo)==null?void 0:w.organization_name),1)])]}),_:1},8,["to"]),s(x,{class:"underline underline-offset-4 inline-flex items-center gap-0.5",to:{name:"taskList",query:{device_group_name:e(n).query.device_group_name}}},{default:i(()=>{var w,q;return[s(p,{component:e(Jt)},null,8,["component"]),r("span",Ga,u((q=(w=e(d))==null?void 0:w.groupInfo)==null?void 0:q.device_group_name),1)]}),_:1},8,["to"]),r("span",Ka,u((ie=(se=e(d))==null?void 0:se.groupInfo)==null?void 0:ie.description),1)])):L("",!0),r("div",Ya,[(_e=e(t))!=null&&_e.expInfo?(f(),V(gt,{key:0},[r("div",Za,[r("div",Xa,[r("span",es,[s(k,{type:"success",size:"small",color:{color:"#ff5722",textColor:"#fff"}},{default:i(()=>{var w,q;return[R(u(e(l)("expInfo.task"))+" "+u((q=(w=e(t))==null?void 0:w.expInfo)==null?void 0:q.task_id),1)]}),_:1})]),s(x,{to:{name:"experimentList",query:{device_group_name:e(n).query.device_group_name,task_id:(Le=($e=e(t))==null?void 0:$e.expInfo)==null?void 0:Le.task_id,task_title:(Oe=(De=e(t))==null?void 0:De.expInfo)==null?void 0:Oe.task_title,space_id:e(n).query.space_id}},class:"underline underline-offset-4"},{default:i(()=>{var w,q;return[r("span",ts,u((q=(w=e(t))==null?void 0:w.expInfo)==null?void 0:q.task_title),1)]}),_:1},8,["to"]),s(h,{type:"primary",size:"small",class:"!ml-2 !h-[22px]",onClick:K},{icon:i(()=>[s(e(Ca))]),default:i(()=>[R(" "+u(e(l)("expInfo.create")),1)]),_:1})]),r("div",null,[r("span",as,[R(u(e(l)("expInfo.space"))+"： ",1),s(k,{size:"small",class:"!cursor-pointer",type:"warning",onClick:Dt},{default:i(()=>{var w,q,fe,vt;return[R(u((q=(w=e(t))==null?void 0:w.expInfo)==null?void 0:q.space_name)+" ( "+u((vt=(fe=e(t))==null?void 0:fe.expInfo)==null?void 0:vt.space_time_str)+" ) ",1)]}),_:1}),s(ee,{trigger:"hover"},{trigger:i(()=>[s(h,{type:"info",class:"!ml-1",size:"tiny",onClick:N},{icon:i(()=>[s(e(bt))]),_:1})]),default:i(()=>[R(" "+u(e(l)("expInfo.downloadSpaceParams")),1)]),_:1})])]),r("div",null,u((Ne=(Te=e(t))==null?void 0:Te.expInfo)==null?void 0:Ne.task_desc),1)]),r("div",ss,[(Pe=e(t).result)!=null&&Pe.small_picture_url?(f(),B(Ot,{key:0,src:e(ht)((je=e(t).result)==null?void 0:je.small_picture_url,"t",String(+new Date)),"preview-src":((Ue=e(t).result)==null?void 0:Ue.big_picture_url)||e(ht)((Be=e(t).result)==null?void 0:Be.small_picture_url,"t",String(+new Date)),alt:"",class:"mr-2 h-fit p-[1px] w-[100px]",style:Yt({border:`1px solid ${e(c).dividerColor}`})},null,8,["src","preview-src","style"])):L("",!0),r("div",os,[r("div",ns,[(Ae=(Fe=e(t))==null?void 0:Fe.expInfo)!=null&&Ae.exp_id?(f(),V("span",ls,[s(k,{color:{color:"#7816ff",textColor:"#fff"},size:"small"},{default:i(()=>{var w,q;return[R(u(e(l)("expInfo.exp"))+" "+u((q=(w=e(t))==null?void 0:w.expInfo)==null?void 0:q.exp_id),1)]}),_:1})])):L("",!0),r("span",is,u((Qe=(He=e(t))==null?void 0:He.expInfo)==null?void 0:Qe.exp_title),1)]),r("div",rs,[(Je=e(t).expInfo)!=null&&Je.exp_id?(f(),V("span",cs,u((Ge=(We=e(t))==null?void 0:We.expInfo)==null?void 0:Ge.create_time),1)):(f(),V("span",ps,[s(k,{size:"small",bordered:!1,color:{color:"#f00",textColor:"#fff"}},{default:i(()=>[R(u(e(l)("expInfo.unsumbit")),1)]),_:1})])),r("span",null,[s(k,{type:"warning",size:"small",onClick:I,class:"!cursor-pointer"},{default:i(()=>{var w,q,fe;return[R(u(((fe=(q=(w=e(t))==null?void 0:w.expInfo)==null?void 0:q.exp)==null?void 0:fe.template)||e(l)("expInfo.notpl")),1)]}),_:1})]),(Ke=e(t).expInfo)!=null&&Ke.exp_id?(f(),B(ee,{key:2,trigger:"hover"},{trigger:i(()=>[s(h,{type:"info",class:"!ml-1",size:"tiny",onClick:A},{icon:i(()=>[s(e(bt))]),_:1})]),default:i(()=>[R(" "+u(e(l)("expInfo.downloadExp")),1)]),_:1})):L("",!0)]),r("div",us,u((Ze=(Ye=e(t))==null?void 0:Ye.expInfo)==null?void 0:Ze.exp_desc),1)])])],64)):L("",!0)]),(Xe=e(t))!=null&&Xe.expInfo?(f(),V("div",ds,[r("div",_s,[(tt=(et=e(t))==null?void 0:et.expInfo)!=null&&tt.status?(f(),B(k,{key:0,color:{color:e(wt)[e(t).expInfo.status].color,textColor:"#fff"},size:"small"},{default:i(()=>[R(u(e(l)(e(wt)[e(t).expInfo.status].text)),1)]),_:1},8,["color"])):L("",!0),(st=(at=e(t))==null?void 0:at.expInfo)!=null&&st.progress?(f(),V("span",fs,u((nt=(ot=e(t))==null?void 0:ot.expInfo)==null?void 0:nt.progress),1)):L("",!0),s(Tt,{value:(it=(lt=e(t).expInfo)==null?void 0:lt.exp_msg)==null?void 0:it.length,max:15,class:"cursor-pointer",onClick:Z},{default:i(()=>[s(p,{size:22},{default:i(()=>[s(e(ja))]),_:1})]),_:1},8,["value"])]),r("div",ms,[s(h,{type:"info",size:"small",class:"flex-1",onClick:j,disabled:((pt=(ct=(rt=e(t))==null?void 0:rt.expInfo)==null?void 0:ct.exp)==null?void 0:pt.exp_mode)==="batch_circuit"||!e(n).query.exp_id},{icon:i(()=>[s(e(ga))]),default:i(()=>[R(u(e(l)("expInfo.duplicate"))+" ",1)]),_:1},8,["disabled"]),s(h,{type:"info",size:"small",class:"flex-1",disabled:![e(me).RUNNING,e(me).HOST_DOWNLOADED].includes((ut=e(t).expInfo)==null?void 0:ut.status),onClick:G},{icon:i(()=>[s(e(ha))]),default:i(()=>[R(u(e(l)("expInfo.stop"))+" ",1)]),_:1},8,["disabled"])]),r("div",xs,[s(h,{class:"flex-1",type:"primary",size:"small",onClick:P,disabled:!!((_t=(dt=e(t))==null?void 0:dt.expInfo)!=null&&_t.exp_id)},{icon:i(()=>[s(e($t))]),default:i(()=>[R(u(e(l)("expInfo.run"))+" ",1)]),_:1},8,["disabled"])])])):L("",!0),s(Ua,{ref_key:"msgViewRef",ref:O},null,512)]),s(wa,{ref_key:"expsTplRef",ref:z},null,512),s(Ba,{ref_key:"tempalteDataRef",ref:b,"template-data":(xt=(mt=(ft=e(t))==null?void 0:ft.expInfo)==null?void 0:mt.exp)==null?void 0:xt.template_data},null,8,["template-data"]),s(Ha)]}),_:1}),s(ke,{show:e(le),"onUpdate:show":[a[0]||(a[0]=M=>oe(le)?le.value=M:null),Lt],size:"huge"},{default:i(()=>[s(Ie,{style:{"min-height":"82vh",overflow:"auto",width:"1200px","min-width":"500px"}},{default:i(()=>{var M,te,ae,se,ie,_e;return[r("div",vs,[r("div",null,u(e(l)("expInfo.space"))+"： "+u((te=(M=e(t))==null?void 0:M.expInfo)==null?void 0:te.space_name)+" ( "+u((se=(ae=e(t))==null?void 0:ae.expInfo)==null?void 0:se.space_time_str)+" ) ",1)]),s(Re,{class:"!my-4"}),e(n).query.space_id?(f(),B(It,{key:0,ref_key:"paramsLatestRef",ref:Y,"max-height":"65vh","read-only":"",version:(_e=(ie=e(t))==null?void 0:ie.expInfo)==null?void 0:_e.space_timestamp,"space-id":+e(n).query.space_id},null,8,["version","space-id"])):L("",!0)]}),_:1})]),_:1},8,["show"]),s(ke,{show:e(X),"onUpdate:show":[a[2]||(a[2]=M=>oe(X)?X.value=M:null),be],size:"huge"},{default:i(()=>[s(Ie,{style:{"min-height":"82vh",overflow:"auto",width:"1200px","min-width":"500px"}},{default:i(()=>{var M,te,ae,se;return[r("div",gs,[r("div",null,u(e(l)("expInfo.space"))+"： "+u((te=(M=e(t))==null?void 0:M.expInfo)==null?void 0:te.space_name)+" ( "+u((se=(ae=e(t))==null?void 0:ae.expInfo)==null?void 0:se.space_time_str)+" ) ",1),r("div",hs,[s(Pt,{style:{width:"310px","padding-right":"20px"},value:e($),"onUpdate:value":a[1]||(a[1]=ie=>oe($)?$.value=ie:null),valueModifiers:{trim:!0},onKeyup:Zt(de,["enter"]),placeholder:e(l)("groupDetail.parameterManager.searchPlaceholder")},null,8,["value","placeholder"]),r("div",{class:"absolute -right-4 top-1/2 -translate-1/2 h-full w-8 flex items-center justify-center cursor-pointer",onClick:de},[s(p,{color:e(c).primaryColor,component:e(Xt)},null,8,["color","component"])])])]),s(Re,{class:"!my-4"}),e(n).query.space_id?(f(),B(It,{key:0,ref_key:"paramsLatestRef",ref:Y,"max-height":"65vh","space-id":+e(n).query.space_id},null,8,["space-id"])):L("",!0)]}),_:1})]),_:1},8,["show"]),s(ke,{show:e(U),"onUpdate:show":a[4]||(a[4]=M=>oe(U)?U.value=M:null),size:"huge",onUpdateShow:ne},{default:i(()=>[s(Ie,{style:{"min-height":"82vh",overflow:"auto",width:"1300px","max-width":"95vw","min-width":"500px"}},{default:i(()=>[e(n).query.space_id?(f(),B(_a,{key:0,search:"","space-id":+e(n).query.space_id,"hide-history-option":"",modelValue:e($),"onUpdate:modelValue":a[3]||(a[3]=M=>oe($)?$.value=M:null),onRefresh:ve},null,8,["space-id","modelValue"])):L("",!0)]),_:1})]),_:1},8,["show"])],64)}}}),ys={class:"flex mt-5"},bs={class:"ml-5 flex-1"},Js=F({__name:"ExperimentView",setup(v){const{t:l}=Ee(),c=Me(),y=Ve(),n=xe(),m=D(),t=d=>{y.push({name:d,query:c.query})};return ta(c,d=>{m.value=d.name},{deep:!0,immediate:!0}),Vt(()=>{const d=Et("t");he(d)||(n.reset(),pe(()=>{ze(d),localStorage.removeItem("t")}))}),(d,z)=>{const b=Sa,I=Ma,O=Rt("router-view");return f(),V("div",null,[s(ws),r("div",ys,[s(I,{type:"card",animated:"",placement:"left",class:"!h-full !w-auto",value:e(m),"onUpdate:value":z[0]||(z[0]=g=>oe(m)?m.value=g:null),onUpdateValue:t},{default:i(()=>{var g,E,H;return[s(b,{name:"waveforms",tab:_("div",{class:"flex items-center gap-2"},[_("div",{class:"flex items-center"},_(e(ue),{size:20},{default:()=>_(e(va))})),_("div",[_("div",{class:"font-bold"},e(l)("expInfo.waveforms"))])])},null,8,["tab"]),s(b,{name:"program",tab:_("div",{class:"flex items-center gap-2"},[_("div",{class:"flex items-center"},_(e(ue),{size:20},{default:()=>_(e(Na))})),_("div",[_("div",{class:"font-bold"},e(l)("expInfo.program"))])])},null,8,["tab"]),s(b,{name:"finalSetting",disabled:!((g=e(n).expInfo)!=null&&g.exp_id),tab:_("div",{class:"flex items-center gap-2"},[_("div",{class:"flex items-center"},_(e(ue),{size:20},{default:()=>_(e(Oa))})),_("div",[_("div",{class:"font-bold"},e(l)("expInfo.plotter"))])])},null,8,["disabled","tab"]),s(b,{name:"result",disabled:!((E=e(n).expInfo)!=null&&E.exp_id),tab:_("div",{class:"flex items-center gap-2"},[_("div",{class:"flex items-center"},_(e(ue),{size:20},{default:()=>_(e($a))})),_("div",[_("div",{class:"font-bold"},e(l)("expInfo.fitting"))])])},null,8,["disabled","tab"]),s(b,{name:"attachment",disabled:!((H=e(n).expInfo)!=null&&H.exp_id),tab:_("div",{class:"flex items-center gap-2"},[_("div",{class:"flex items-center"},_(e(ue),{size:20},{default:()=>_(e(Ea))})),_("div",[_("div",{class:"font-bold"},e(l)("expInfo.attachment"))])])},null,8,["disabled","tab"])]}),_:1},8,["value"]),r("div",bs,[s(O)])])])}}});export{Js as default};
