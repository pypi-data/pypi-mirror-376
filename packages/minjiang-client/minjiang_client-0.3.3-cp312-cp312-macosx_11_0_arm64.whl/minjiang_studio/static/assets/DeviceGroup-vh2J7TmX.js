import{d as X,a as Y,b as Z,z as ee,r as p,L as te,M as ae,o as oe,K as L,y as P,a7 as ne,aL as se,c as q,e as N,f,h as s,n as x,j as t,O as ie,N as re,t as g,w as r,a4 as le,a5 as ue,C as de,cx as S,J as C,B as ce,cy as pe,R as _e,S as me,p as ve,k as fe,I as ge,cz as ye,cA as he,U as Ge,cB as ke,cC as xe,aT as be,H as ze}from"./index-KHiidVve.js";import{A as we}from"./Add-CUVNZISR.js";import{_ as Le,a as Ne}from"./Tabs-7QiGpSYZ.js";import{_ as Ce}from"./Alert-JPiDiWyN.js";import{_ as Ie,a as Ue}from"./FormItem-BLErRK4c.js";import"./Add-CUOykUgu.js";import"./debounce-MHG2Ws0B.js";const Be={class:"flex"},Me={class:"text-xl mt-[26px] flex items-center gap-1"},Re={class:"flex justify-between items-center w-full"},$e={class:"flex-1"},Pe={class:"text-xl"},qe={class:"flex justify-end"},Se=X({__name:"DeviceGroup",setup(Te){const{t:n}=Y(),T=Z(),I=ee(),_=p(!1),U=p(),c=p({description:void 0,device_group_name:void 0}),V={description:{required:!0,message:n("deviceGroup.descriptionErrMsg")},device_group_name:{required:!0,message:n("deviceGroup.groupNameErrMsg")}},B=()=>{_.value=!1,c.value={description:void 0,device_group_name:void 0}},O=()=>{var o;d.value||(d.value=!0,(o=U.value)==null||o.validate(async e=>{if(e){d.value=!1;return}const[i,l]=await ye({...c.value,organization_id:u.value});d.value=!1,!i&&l&&l.status===0&&m()}))},j=o=>{o||B()},b=p(),y=te({page:1,per_page:ae,total:0}),d=p(!1),u=p(),m=async o=>{d.value=!0,b.value=void 0;const[e,i]=await he({...Ge(y),org_id:o||u.value});d.value=!1,!e&&i&&i.status===0&&(b.value=i.data.list,y.total=i.data.total),_.value&&B()},A=async(o,e)=>{const[i,l]=await ke({device_id:e,hidden:!o});!i&&(l==null?void 0:l.status)===0&&m()},h=p(),E=async()=>{var i,l;const[o,e]=await xe();if(!o&&(e==null?void 0:e.status)===0){h.value=(i=e.data)==null?void 0:i.organizations;const G=(l=e.data)==null?void 0:l.organizations;if(I.query.org)u.value=+I.query.org,be(()=>{m()});else if(G&&G.length>0){const v=G[0].organization_id;v&&(u.value=v,m(v))}}};oe(()=>{E()});const H=[{title:n("deviceGroup.id"),key:"create_uid"},{title:n("deviceGroup.groupId"),key:"device_group_id"},{title:n("deviceGroup.groupName"),key:"device_group_name"},{title:n("deviceGroup.description"),key:"description"},{title:n("deviceGroup.createTime"),key:"create_time"},{title:n("createuser"),key:"user_name"},{title:n("deviceGroup.status"),key:"status",render:o=>{var e;if(o.status)return L(ne,{type:((e=P[o.status])==null?void 0:e.type)||"default",bordered:!1},{default:()=>{var i;return n((i=P[o.status])==null?void 0:i.text)}})}},{title:n("deviceGroup.show2desktop"),key:"status",render:o=>{if(o.status)return L("div",{onClick:e=>e.stopPropagation()},L(se,{value:!o.hidden,onUpdateValue:e=>A(e,o.device_group_id)}))}}],K=({device_group_name:o})=>({class:"cursor-pointer",onClick:()=>{T.push({name:"taskList",query:{device_group_name:o}})}});return(o,e)=>{var R,$;const i=re,l=Le,G=Ne,v=ce,F=_e,J=Ce,z=Ue,M=fe,D=Ie,Q=ve,W=ge;return N(),q("div",Be,[f("div",null,[f("div",Me,[s(i,{component:t(ie)},null,8,["component"]),x(" "+g(t(n)("org.orgList")),1)]),s(G,{placement:"left","bar-width":300,type:"card",value:t(u),"onUpdate:value":[e[0]||(e[0]=a=>C(u)?u.value=a:null),m],class:"pr-5 mt-7"},{default:r(()=>[(N(!0),q(le,null,ue(t(h),a=>(N(),de(l,{key:a.organization_id,name:a.organization_id,disabled:t(d),class:"min-w-[200px]"},{default:r(()=>[f("div",Re,[x(g(a.organization_name)+" ",1),s(S,{role:a.user_role},null,8,["role"])])]),_:2},1032,["name","disabled"]))),128))]),_:1},8,["value"])]),f("div",$e,[s(pe,{title:($=(R=t(h))==null?void 0:R.find(a=>a.organization_id==t(u)))==null?void 0:$.organization_name},{tag:r(()=>{var a,k;return[s(S,{role:(k=(a=t(h))==null?void 0:a.find(w=>w.organization_id==t(u)))==null?void 0:k.user_role},null,8,["role"])]}),extra:r(()=>[s(v,{type:"primary",onClick:e[1]||(e[1]=a=>_.value=!0)},{icon:r(()=>[s(t(we))]),default:r(()=>[x(" "+g(t(n)("deviceGroup.create")),1)]),_:1})]),_:1},8,["title"]),s(F,{columns:H,data:t(b),pagination:!1,loading:t(d),"row-props":K},null,8,["data","loading"]),s(me,{"page-info":t(y),"onUpdate:pageInfo":e[2]||(e[2]=a=>C(y)?y.value=a:null),onUpdateList:m},null,8,["page-info"]),s(W,{show:t(_),"onUpdate:show":e[5]||(e[5]=a=>C(_)?_.value=a:null),"on-update:show":j},{default:r(()=>[s(Q,{style:{width:"600px"},size:"huge",bordered:!1,role:"dialog","aria-modal":"true"},{default:r(()=>[s(J,{type:"info",class:"mb-5",bordered:!1},{default:r(()=>[x(g(t(n)("deviceGroup.tips")),1)]),_:1}),s(D,{ref_key:"formRef",ref:U,model:t(c),rules:V},{default:r(()=>[s(z,{label:t(n)("deviceGroup.orgName"),path:"device_group_name"},{default:r(()=>{var a,k;return[f("div",Pe,g((k=(a=t(h))==null?void 0:a.find(w=>w.organization_id==t(u)))==null?void 0:k.organization_name),1)]}),_:1},8,["label"]),s(z,{label:t(n)("deviceGroup.groupNameLabel"),path:"device_group_name"},{default:r(()=>[s(M,{value:t(c).device_group_name,"onUpdate:value":e[3]||(e[3]=a=>t(c).device_group_name=a),placeholder:t(n)("deviceGroup.groupNamePlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),s(z,{label:t(n)("deviceGroup.descriptionLabel"),path:"description"},{default:r(()=>[s(M,{value:t(c).description,"onUpdate:value":e[4]||(e[4]=a=>t(c).description=a),placeholder:t(n)("deviceGroup.descriptionPlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),f("div",qe,[s(v,{type:"primary",loading:t(d),onClick:O},{default:r(()=>[x(g(t(n)("deviceGroup.create")),1)]),_:1},8,["loading"])])]),_:1},8,["model"])]),_:1})]),_:1},8,["show"])])])}}}),Fe=ze(Se,[["__scopeId","data-v-8aa88ca5"]]);export{Fe as default};
