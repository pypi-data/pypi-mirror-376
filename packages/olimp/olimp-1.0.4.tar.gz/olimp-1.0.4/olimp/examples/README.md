# –ü—Ä–∏–º–µ—Ä—ã –Ω–æ–≤—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞

## –ü—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–º–∏ (–Ω–µ –Ω–µ–π—Ä–æ—Å–µ—Ç–µ–≤—ã–º–∏ –º–µ—Ç–æ–¥–∞–º–∏)

### –ü—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è —Ä–µ—Ñ—Ä–∞–∫—Ü–∏–æ–Ω–Ω—ã—Ö –∏—Å–∫–∞–∂–µ–Ω–∏–π (–†–ò–ó)

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –ø—Ä–∏–º–µ—Ä—ã –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏ —Ä–µ—Ñ—Ä–∞–∫—Ü–∏–æ–Ω–Ω—ã—Ö –∏—Å–∫–∞–∂–µ–Ω–∏–π –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–º–∏ (–Ω–µ-–Ω–µ–π—Ä–æ—Å–µ—Ç–µ–≤—ã–º–∏ –º–µ—Ç–æ–¥–∞–º–∏) –ø—Ä–∏ –ø–æ–º–æ—â–∏ –Ω–∞—à–µ–≥–æ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞

#### –ú–µ—Ç–æ–¥ –•—É–∞–Ω–≥–∞

–ú–µ—Ç–æ–¥ Huang ‚Äî —á–∏—Å–ª–µ–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ **—Ñ–∏–ª—å—Ç—Ä–µ –í–∏–Ω–µ—Ä–∞**,  –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –∏—Å–∫–∞–∂—ë–Ω–Ω—ã—Ö –∞–±–µ—Ä—Ä–∞—Ü–∏—è–º–∏ –∑—Ä–µ–Ω–∏—è (PSF).  –û–Ω –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –æ–±—É—á–µ–Ω–∏—è –∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫–∞–∫ –±–∞–∑–æ–≤—ã–π –º–µ—Ç–æ–¥ –¥–ª—è –æ—Ü–µ–Ω–∫–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –Ω–µ–π—Ä–æ—Å–µ—Ç–µ–≤—ã—Ö –ø–æ–¥—Ö–æ–¥–æ–≤.

**–í—Ö–æ–¥:**
- –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ;
- PSF (—Ñ—É–Ω–∫—Ü–∏—è —Ä–∞—Å—Å–µ—è–Ω–∏—è —Ç–æ—á–∫–∏).

**–í—ã—Ö–æ–¥:**
- –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ [0, 1].

üìñ –ü–æ–¥—Ä–æ–±–Ω–µ–µ: Jian Huang,  
*Dynamic Image Precompensation for Improving Visual Performance of Computer Users with Ocular Aberrations*,  
Master's Thesis, Florida International University, 18 –∏—é–Ω—è 2013.  
[–°–∫–∞—á–∞—Ç—å PDF](https://digitalcommons.fiu.edu/cgi/viewcontent.cgi?article=2021&context=etd)
 
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–ª–µ–¥—É—é—â–∏–π –∫–æ–¥:

    from __future__ import annotations

    from typing import Callable
    from torch import Tensor

    from olimp.processing import scale_value
    from olimp.precompensation._demo import demo
    from olimp.precompensation.basic.huang import huang

    if __name__ == "__main__":

        def demo_huang(
            image: Tensor,
            psf: Tensor,
            progress: Callable[[float], None],
        ) -> Tensor:
            ret = huang(image, psf)
            progress(1.0)
            return scale_value(ret, min_val=0, max_val=1.0)

        demo("Huang", demo_huang, mono=False)

–ó–¥–µ—Å—å:

- `torch.Tensor` ‚Äî —Ä–∞–±–æ—Ç–∞ —Å —Ç–µ–Ω–∑–æ—Ä–∞–º–∏ –≤ PyTorch;
- `Callable` ‚Äî —Ç–∏–ø –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ –∏–∑ `typing`;
- `scale_value`, `fft_conv` ‚Äî —Ñ—É–Ω–∫—Ü–∏–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏–∑ –º–æ–¥—É–ª—è `olimp.processing` –≤ —Å–æ—Å—Ç–∞–≤–µ –Ω–∞—à–µ–≥–æ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞;
- `demo`, `demo_cvd` ‚Äî —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.

–≠—Ç–æ—Ç –∫–æ–¥ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –≤–Ω–µ—Å–µ–Ω –≤ —Ñ–∞–π–ª olimp/examples/precompensation/huang.py –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω –∫–æ–º–∞–Ω–¥–æ–π 

    python3 -m olimp.examples.precompensation.huang

–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –∑–∞–ø—É—Å–∫–∞ —ç—Ç–æ—Ç –≤—ã–∑–æ–≤ –≤—ã–¥–∞—Å—Ç –æ–∫–Ω–æ —Å 4 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏: –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞—Å—Å–µ—è–Ω–∏—è —Ç–æ—á–∫–∏ (–§–†–¢, PSF), –∏—Å—Ö–æ–¥–Ω—ã–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º, —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏ –∏ —Å–∏–º—É–ª—è—Ü–∏–µ–π, –∫–∞–∫ –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –±—É–¥–µ—Ç –≤–∏–¥–Ω–æ –Ω–µ–∏–¥–µ–∞–ª—å–Ω–æ–π –∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π —Å –¥–∞–Ω–Ω–æ–π –§–†–¢. 

### –ú–µ—Ç–æ–¥ Feng Xu

–ú–µ—Ç–æ–¥ Feng Xu ‚Äî —á–∏—Å–ª–µ–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏, —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –≤ **—Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏**  
–∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–ª—è **GPU-–≤—ã—á–∏—Å–ª–µ–Ω–∏–π**. –û—Å–Ω–æ–≤–∞–Ω –Ω–∞ **L2-–¥–µ–∫–æ–Ω–≤–æ–ª—é—Ü–∏–∏** –≤ —á–∞—Å—Ç–æ—Ç–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏ (FFT)  
—Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–∏ `Œª`, –ø–æ–∑–≤–æ–ª—è—é—â–∏–º –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –¥–∏–∞–ø–∞–∑–æ–Ω –∑–Ω–∞—á–µ–Ω–∏–π –ø–∏–∫—Å–µ–ª–µ–π.

**–í—Ö–æ–¥:**
- –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ;
- PSF (—Ñ—É–Ω–∫—Ü–∏—è —Ä–∞—Å—Å–µ—è–Ω–∏—è —Ç–æ—á–∫–∏);
- –ø–∞—Ä–∞–º–µ—Ç—Ä —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–∏ `lambda_val` (–Ω–∞–ø—Ä–∏–º–µ—Ä, Œª = 2).

**–í—ã—Ö–æ–¥:**
- –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (–º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∏–ª–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ).

üìñ –ü–æ–¥—Ä–æ–±–Ω–µ–µ: Feng Xu,  
*Software Based Visual Aberration Correction for HMDs*, IEEE VR, –º–∞—Ä—Ç 2018.  
[–°–∫–∞—á–∞—Ç—å PDF](https://www.cs.ucf.edu/courses/cap6121/spr2024/readings/Xu2018.pdf)

–î–ª—è –≤—ã–∑–æ–≤–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–¥ –∏–∑ —Ñ–∞–π–ª–∞ olimp/examples/precompensation/feng_xu.py

–ü–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –∫–æ–¥ –∞–Ω–∞–ª–æ–≥–∏—á–µ–Ω –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–º—É –≤ –º–µ—Ç–æ–¥–µ –•—É–∞–Ω–≥–∞ (—Å–º. –≤—ã—à–µ). –î–ª—è –µ–≥–æ –±—ã—Å—Ç—Ä–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É:

    python3 -m olimp.examples.precompensation.feng_xu


### –ú–µ—Ç–æ–¥ Bregman Jumbo

–ú–µ—Ç–æ–¥ Bregman Jumbo ‚Äî —á–∏—Å–ª–µ–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ **–≤–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω–æ–π —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–µ –∑–∞–¥–∞—á–∏ –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏**, –≤ –∫–æ—Ç–æ—Ä–æ–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è —Å **–æ–±—Ä–∞—Ç–Ω–æ–π –ø—Ä–æ–µ–∫—Ü–∏–µ–π –ë—Ä–µ–≥–º–∞–Ω–∞** –∏ —Ä–µ—à–∞–µ—Ç—Å—è –∑–∞–¥–∞—á–∞ –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏.  
–ê–ª–≥–æ—Ä–∏—Ç–º –≤–ø–µ—Ä–≤—ã–µ –±—ã–ª –ø—Ä–µ–¥–ª–æ–∂–µ–Ω –≤ 2021 –≥–æ–¥—É, –∞ –≤ 2024 –≥–æ–¥—É –±—ã–ª –¥–æ—Ä–∞–±–æ—Ç–∞–Ω –∞–≤—Ç–æ—Ä–∞–º–∏ –¥–∞–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ –∏ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏.

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –º–µ—Ç–æ–¥ –ë—Ä–µ–≥–º–∞–Ω–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞ —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º –ø–æ –¥–∏–∞–ø–∞–∑–æ–Ω—É –ø–∏–∫—Å–µ–ª–µ–π;
- –í –æ—Ä–∏–≥–∏–Ω–∞–ª–µ ‚Äî —Ä–µ—à–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –∏—Ç–µ—Ä–∞—Ç–∏–≤–Ω—É—é —Å—Ö–µ–º—É —Å TV-—Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–µ–π;
- –í –¥–æ—Ä–∞–±–æ—Ç–∫–µ (2024) ‚Äî —É–ª—É—á—à–µ–Ω–∞ —Å—Ö–æ–¥–∏–º–æ—Å—Ç—å, –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∞–¥–∞–ø—Ç–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è —Å—Ö–µ–º–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö.

**–í—Ö–æ–¥:**
- –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ;
- PSF (—Ñ—É–Ω–∫—Ü–∏—è —Ä–∞—Å—Å–µ—è–Ω–∏—è —Ç–æ—á–∫–∏).

**–í—ã—Ö–æ–¥:**
- –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ.

üìñ –ü–æ–¥—Ä–æ–±–Ω–µ–µ:  
**–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –º–µ—Ç–æ–¥** ‚Äî Montalto et al., *JUMBO: Joint Unrolling Optimization and Model-Based Approach for Blind Image Deconvolution*, ICCV 2021.  
[–°–∫–∞—á–∞—Ç—å PDF](https://drive.google.com/file/d/1TQs41VJY4Bw05bAOMTacS6zZx0d9tK01/view?usp=sharing)  
**–î–æ—Ä–∞–±–æ—Ç–∫–∞** ‚Äî Abgaryan A.A., Al-Kazir N.B., *–ê–Ω–∞–ª–∏–∑ –∏ —É–ª—É—á—à–µ–Ω–∏–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ë—Ä–µ–≥–º–∞–Ω–∞ –≤ –∑–∞–¥–∞—á–∞—Ö –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏: –Ω–æ–≤—ã–µ –ø–æ–¥—Ö–æ–¥—ã –∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∏—á–µ—Å–∫–∏–µ —Ä–µ—à–µ–Ω–∏—è*, 2024.  
[–°–∫–∞—á–∞—Ç—å PDF (–Ω–∞ —Ä—É—Å—Å–∫–æ–º)](attachment:/mnt/data/2024_AbgaryanAA_Al_KazirNB_Analiz_i_uluchshenie_optimizatsii_Bregmana_v_zadachakh_predkompensatsii_novye_podkhody_i_algoritmicheskie_k_id3179_v2024_1219_1739_.pdf)

–î–ª—è –≤—ã–∑–æ–≤–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–¥ –∏–∑ —Ñ–∞–π–ª–∞ olimp/examples/precompensation/bregman_jumbo.py

–ü–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –∫–æ–¥ –∞–Ω–∞–ª–æ–≥–∏—á–µ–Ω –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–º—É –≤ –º–µ—Ç–æ–¥–µ –•—É–∞–Ω–≥–∞ (—Å–º. –≤—ã—à–µ). –î–ª—è –µ–≥–æ –±—ã—Å—Ç—Ä–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É:

    python3 -m olimp.examples.precompensation.bregman_jumbo

### –ú–µ—Ç–æ–¥ Global Tone Mapping (GTM)

–ú–µ—Ç–æ–¥ Global Tone Mapping ‚Äî —á–∏—Å–ª–µ–Ω–Ω—ã–π –º–µ—Ç–æ–¥ –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ —Ç–æ–Ω–∞–ª—å–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è,  
—Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π –¥–ª—è –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å —É—á—ë—Ç–æ–º **—Ä–µ—Ñ—Ä–∞–∫—Ü–∏–æ–Ω–Ω—ã—Ö –∏—Å–∫–∞–∂–µ–Ω–∏–π –∑—Ä–µ–Ω–∏—è**.  
–û–Ω –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω—É—é –∫—Ä–∏–≤—É—é –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å –ø–æ–º–æ—â—å—é –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–≥–æ —Å–ø—É—Å–∫–∞,  
–æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –±–æ–ª–µ–µ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—É—é –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é –ø–µ—Ä–µ–¥–∞—á—É —è—Ä–∫–æ—Å—Ç–∏ –∏ –∫–æ–Ω—Ç—Ä–∞—Å—Ç–∞ –ø–æ—Å–ª–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —á–µ—Ä–µ–∑ –∏—Å–∫–∞–∂–∞—é—â—É—é PSF.

**–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏;
- –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω–∞—è –≥–ª–æ–±–∞–ª—å–Ω–∞—è –∫—Ä–∏–≤–∞—è —è—Ä–∫–æ—Å—Ç–∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç—Å—è –ø–æ –∑–∞–¥–∞–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å;
- –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –≤ –∑–∞–¥–∞—á–∞—Ö –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏ –∑—Ä–µ–Ω–∏—è —Å –∏—Å–∫–∞–∂–µ–Ω–∏—è–º–∏, –≤—ã–∑–≤–∞–Ω–Ω—ã–º–∏ –∞–±–µ—Ä—Ä–∞—Ü–∏—è–º–∏.

**–í—Ö–æ–¥:**
- –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ;
- PSF (—Ñ—É–Ω–∫—Ü–∏—è —Ä–∞—Å—Å–µ—è–Ω–∏—è —Ç–æ—á–∫–∏);
- –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (`lr`, —á–∏—Å–ª–æ –∏—Ç–µ—Ä–∞—Ü–∏–π –∏ –¥—Ä.).

**–í—ã—Ö–æ–¥:**
- –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –≥–ª–æ–±–∞–ª—å–Ω–æ–π —Ç–æ–Ω–∞–ª—å–Ω–æ–π –∫—Ä–∏–≤–æ–π.

üìñ –ü–æ–¥—Ä–æ–±–Ω–µ–µ:  
Al-Kazir N.B., Nikolaev I.P., Nikolaev D.P.,  
*Search for Image Quality Metrics Suitable for Assessing Images Specially Precompensated for Users with Refractive Vision Defects*,  
HSE, 2023.  
[–°–∫–∞—á–∞—Ç—å PDF](https://publications.hse.ru/pubs/share/direct/932038377.pdf)

–î–ª—è –≤—ã–∑–æ–≤–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–¥ –∏–∑ —Ñ–∞–π–ª–∞ olimp/examples/precompensation/global_tone_mapping.py

–ü–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –∫–æ–¥ –∞–Ω–∞–ª–æ–≥–∏—á–µ–Ω –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–º—É –≤ –º–µ—Ç–æ–¥–µ –•—É–∞–Ω–≥–∞ (—Å–º. –≤—ã—à–µ). –î–ª—è –µ–≥–æ –±—ã—Å—Ç—Ä–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É:

    python3 -m olimp.examples.precompensation.global_tone_mapping


### –ú–µ—Ç–æ–¥ HQS (Half-Quadratic Splitting)

–ú–µ—Ç–æ–¥ HQS ‚Äî —á–∏—Å–ª–µ–Ω–Ω—ã–π –∏—Ç–µ—Ä–∞—Ç–∏–≤–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ **–º–µ—Ç–æ–¥–µ –ø–æ–ª—É –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–æ–≥–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è**,  
–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –∏—Å–∫–∞–∂—ë–Ω–Ω—ã—Ö –∞–±–µ—Ä—Ä–∞—Ü–∏—è–º–∏ –∑—Ä–µ–Ω–∏—è (PSF).  
–ú–µ—Ç–æ–¥ —Ñ–æ—Ä–º—É–ª–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ –∑–∞–¥–∞—á–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Å –¥–≤—É–º—è –ø–æ–¥–∑–∞–¥–∞—á–∞–º–∏:  
–≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–∞—è —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è –∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ —Å –∏—Å–∫–∞–∂—ë–Ω–Ω—ã–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º.  
–û–Ω –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –æ–±—É—á–µ–Ω–∏—è –∏ —Ä–µ—à–∞–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–≥–æ —Å–ø—É—Å–∫–∞.

**–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—É—é —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—é;
- –Ø–≤–ª—è–µ—Ç—Å—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º –≤–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤;
- –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö (–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ `p` –∏ `w`) —É—Å–∫–æ—Ä—è–µ—Ç —Å—Ö–æ–¥–∏–º–æ—Å—Ç—å.

**–í—Ö–æ–¥:**
- –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ;
- PSF (—Ñ—É–Ω–∫—Ü–∏—è —Ä–∞—Å—Å–µ—è–Ω–∏—è —Ç–æ—á–∫–∏).

**–í—ã—Ö–æ–¥:**
- –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ [0, 1].

üìå –ü—É–±–ª–∏–∫–∞—Ü–∏—è –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç (–º–µ—Ç–æ–¥ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∞–≤—Ç–æ—Ä–∞–º–∏ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞ –∫–∞–∫ —á–∏—Å–ª–µ–Ω–Ω—ã–π –ø—Ä–æ—Ç–æ—Ç–∏–ø).

–î–ª—è –≤—ã–∑–æ–≤–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–¥ –∏–∑ —Ñ–∞–π–ª–∞ olimp/examples/precompensation/hqs.py

–ü–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –∫–æ–¥ –∞–Ω–∞–ª–æ–≥–∏—á–µ–Ω –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–º—É –≤ –º–µ—Ç–æ–¥–µ –•—É–∞–Ω–≥–∞ (—Å–º. –≤—ã—à–µ). –î–ª—è –µ–≥–æ –±—ã—Å—Ç—Ä–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É:

     python3 -m olimp.examples.precompensation.hqs



### –ú–µ—Ç–æ–¥ Ji

–ú–µ—Ç–æ–¥ Ji ‚Äî —á–∏—Å–ª–µ–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ **–∫—É—Å–æ—á–Ω–æ-–ª–∏–Ω–µ–π–Ω—ã—Ö –æ—Ü–µ–Ω–∫–∞—Ö (Piecewise Linear Estimators, PLE)**  
–∏ –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–π —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.  
–í –Ω–∞—à–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å **MS-SSIM** –¥–ª—è –±–æ–ª–µ–µ —Ç–æ—á–Ω–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –≤ –∑–∞–¥–∞—á–∞—Ö –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è.

–ú–µ—Ç–æ–¥ –ø–æ–∑–≤–æ–ª—è–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –∏—Å–∫–∞–∂—ë–Ω–Ω—ã–µ –∞–±–µ—Ä—Ä–∞—Ü–∏—è–º–∏ –∑—Ä–µ–Ω–∏—è (PSF),  
—É–ª—É—á—à–∞—è –≤–∏–∑—É–∞–ª—å–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–º–∏ –º–µ—Ç–æ–¥–∞–º–∏ —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–∏.

**–í—Ö–æ–¥:**
- –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ;
- PSF (—Ñ—É–Ω–∫—Ü–∏—è —Ä–∞—Å—Å–µ—è–Ω–∏—è —Ç–æ—á–∫–∏).

**–í—ã—Ö–æ–¥:**
- –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ [0, 1].

üìñ –ü–æ–¥—Ä–æ–±–Ω–µ–µ: Hao Ji, Chao Liu, Zuowei Shen, Yinqiang Xu,  
*Efficient Image Deconvolution with Piecewise Linear Estimators*,  
CVPR 2014. [DOI: 10.1109/CVPR.2014.428](https://doi.org/10.1109/CVPR.2014.428)  
[–°–∫–∞—á–∞—Ç—å PDF](sandbox:/mnt/data/10.1109@CVPR.2014.428.pdf)


–î–ª—è –≤—ã–∑–æ–≤–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–¥ –∏–∑ —Ñ–∞–π–ª–∞ olimp/examples/precompensation/ji.py

–ü–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –∫–æ–¥ –∞–Ω–∞–ª–æ–≥–∏—á–µ–Ω –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–º—É –≤ –º–µ—Ç–æ–¥–µ –•—É–∞–Ω–≥–∞ (—Å–º. –≤—ã—à–µ). –î–ª—è –µ–≥–æ –±—ã—Å—Ç—Ä–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É:

     python3 -m olimp.examples.precompensation.ji


### –ú–µ—Ç–æ–¥ Montalto (FISTA)

–ú–µ—Ç–æ–¥ **Montalto (FISTA)** ‚Äî —á–∏—Å–ª–µ–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–π –Ω–∞  
—É—Å–∫–æ—Ä–µ–Ω–Ω–æ–π –∏—Ç–µ—Ä–∞—Ç–∏–≤–Ω–æ–π —Å—Ö–µ–º–µ **FISTA** —Å —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–µ–π **total variation (TV)**.  
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –∏—Å–∫–∞–∂—ë–Ω–Ω—ã—Ö –∞–±–µ—Ä—Ä–∞—Ü–∏—è–º–∏ –∑—Ä–µ–Ω–∏—è (PSF),  
–æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É —á—ë—Ç–∫–æ—Å—Ç—å—é –∏ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å—é –∫ —à—É–º—É.

**–í—Ö–æ–¥:**
- –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ;
- PSF (—Ñ—É–Ω–∫—Ü–∏—è —Ä–∞—Å—Å–µ—è–Ω–∏—è —Ç–æ—á–∫–∏).

**–í—ã—Ö–æ–¥:**
- –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å –ø–æ–¥–∞–≤–ª–µ–Ω–Ω—ã–º —Ä–∞–∑–º—ã—Ç–∏–µ–º –∏ —É–ª—É—á—à–µ–Ω–Ω—ã–º–∏ –≥—Ä–∞–Ω–∏—Ü–∞–º–∏.

üìñ –ü–æ–¥—Ä–æ–±–Ω–µ–µ: Montalto et al.,  
*A Total Variation Approach for Customizing Imagery to Improve Visual Acuity*, 
ACM transactions on graphics (TOG), 2015.  
[–°–∫–∞—á–∞—Ç—å PDF](sandbox:/mnt/data/10.1145@2717307.pdf)

–î–ª—è –≤—ã–∑–æ–≤–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–¥ –∏–∑ —Ñ–∞–π–ª–∞ olimp/examples/precompensation/montalto_fista.py

–ü–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –∫–æ–¥ –∞–Ω–∞–ª–æ–≥–∏—á–µ–Ω –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–º—É –≤ –º–µ—Ç–æ–¥–µ –•—É–∞–Ω–≥–∞ (—Å–º. –≤—ã—à–µ). –î–ª—è –µ–≥–æ –±—ã—Å—Ç—Ä–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É:

     python3 -m olimp.examples.precompensation.montalto_fista


### –ú–µ—Ç–æ–¥ Montalto (Adam AMSGrad)

–ú–µ—Ç–æ–¥ **Montalto (Adam AMSGrad)** ‚Äî –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ Montalto,  
–≤ –∫–æ—Ç–æ—Ä–æ–π –≤–º–µ—Å—Ç–æ –º–µ—Ç–æ–¥–∞ FISTA –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä **Adam** —Å —Ñ–ª–∞–≥–æ–º **AMSGrad**  
–¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ –∏ —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏. –ú–µ—Ç–æ–¥ –æ–ø–∏—Ä–∞–µ—Ç—Å—è –Ω–∞ **—Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—é total variation (TV)**  
–∏ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏ –∏—Å–∫–∞–∂–µ–Ω–∏–π, –≤—ã–∑–≤–∞–Ω–Ω—ã—Ö –∞–±–µ—Ä—Ä–∞—Ü–∏—è–º–∏ –∑—Ä–µ–Ω–∏—è (PSF),  
—É–ª—É—á—à–∞—è —Ä–µ–∑–∫–æ—Å—Ç—å –∏ —Å—É–±—ä–µ–∫—Ç–∏–≤–Ω—É—é —á—ë—Ç–∫–æ—Å—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.

**–í—Ö–æ–¥:**
- –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ;
- PSF (—Ñ—É–Ω–∫—Ü–∏—è —Ä–∞—Å—Å–µ—è–Ω–∏—è —Ç–æ—á–∫–∏).

**–í—ã—Ö–æ–¥:**
- –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ [0, 1].

üìñ –ü–æ–¥—Ä–æ–±–Ω–µ–µ:  
Montalto C. et al.  
*A Total Variation Approach for Customizing Imagery to Improve Visual Acuity*,  
ACM transactions on graphics (TOG), 2015.  
[–°–∫–∞—á–∞—Ç—å PDF](sandbox:/mnt/data/10.1145@2717307.pdf)


–î–ª—è –≤—ã–∑–æ–≤–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–¥ –∏–∑ —Ñ–∞–π–ª–∞ olimp/examples/precompensation/montalto.py

–ü–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –∫–æ–¥ –∞–Ω–∞–ª–æ–≥–∏—á–µ–Ω –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–º—É –≤ –º–µ—Ç–æ–¥–µ –•—É–∞–Ω–≥–∞ (—Å–º. –≤—ã—à–µ). –î–ª—è –µ–≥–æ –±—ã—Å—Ç—Ä–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É:

     python3 -m olimp.examples.precompensation.montalto

### –ü—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è –¥–µ—Ñ–µ–∫—Ç–æ–≤ —Ü–≤–µ—Ç–æ–≤–æ–≥–æ –∑—Ä–µ–Ω–∏—è (–î–¶–ó)

#### –ú–µ—Ç–æ–¥ Achromatic Daltonization

–ú–µ—Ç–æ–¥ **Achromatic Daltonization** ‚Äî —ç—Ç–æ **–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–æ–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏**,
—Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –ø—Ä–∏ —Ü–≤–µ—Ç–æ–≤–æ–π —Å–ª–µ–ø–æ—Ç–µ.  
–í –æ—Ç–ª–∏—á–∏–µ –æ—Ç –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏—Ö –º–µ—Ç–æ–¥–æ–≤, –æ–Ω —Ñ–æ—Ä–º—É–ª–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ –∑–∞–¥–∞—á–∞ –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞,  
–≤–∫–ª—é—á–∞—é—â–µ–≥–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ –∏ —è—Ä–∫–æ—Å—Ç–Ω–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ, –∏ —Ä–µ—à–∞–µ—Ç—Å—è —á–∏—Å–ª–µ–Ω–Ω–æ —Å –ø–æ–º–æ—â—å—é –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–≥–æ —Å–ø—É—Å–∫–∞.

–ú–µ—Ç–æ–¥ –ø–æ–∑–≤–æ–ª—è–µ—Ç —É—á–∏—Ç—ã–≤–∞—Ç—å –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –Ω–∞—Ä—É—à–µ–Ω–∏–π —Ü–≤–µ—Ç–æ–≤–æ–≥–æ –≤–æ—Å–ø—Ä–∏—è—Ç–∏—è  
(–ø—Ä–æ—Ç–∞–Ω–æ–ø–∏—è, –¥–µ–π—Ç–µ—Ä–∞–Ω–æ–ø–∏—è –∏ –¥—Ä.) –∏ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–¥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–∏–ø —Ü–≤–µ—Ç–æ–≤–æ–π —Å–ª–µ–ø–æ—Ç—ã.

#### –í—Ö–æ–¥:
- –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ;
- —Ç–∏–ø –¥–∏—Ö—Ä–æ–º–∞—Ç–æ–ø—Å–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `protan`);
- —Ñ—É–Ω–∫—Ü–∏—è –∏—Å–∫–∞–∂–µ–Ω–∏—è —Ü–≤–µ—Ç–∞ (`ColorBlindnessDistortion`);
- –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–µ—Ç–æ–¥–∞ (`ADParameters`, –≤–∫–ª—é—á–∞—è —Ñ—É–Ω–∫—Ü–∏—é –ø–æ—Ç–µ—Ä—å –∏ —à–∞–≥–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏).

#### –í—ã—Ö–æ–¥:
- –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (–æ–¥–Ω–æ–∫–∞–Ω–∞–ª—å–Ω–æ–µ –∏–ª–∏ RGB –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–∫).

üìñ –ü–æ–¥—Ä–æ–±–Ω–µ–µ:  
- Alshammari, F., Tov√©e, M. J., & Westland, S.,  
**Achromatic Daltonization: A Novel Technique to Enhance Visual Information for Dichromats**,  
*Journal of Imaging*, 2023.  
[–°–∫–∞—á–∞—Ç—å PDF](https://www.mdpi.com/2313-433X/11/7/225)

–î–ª—è –∑–∞–ø—É—Å–∫–∞ –º–µ—Ç–æ–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–ª–µ–¥—É—é—â–∏–π –∫–æ–¥:

    from __future__ import annotations

    from typing import Callable
    from torch import Tensor

    from olimp.precompensation._demo_cvd import demo as demo_cvd
    from olimp.precompensation.optimization.achromatic_daltonization import (
        achromatic_daltonization,
        ColorBlindnessDistortion,
        ADParameters,
        M1Loss,
    )
    import warnings


    def demo_achromatic_daltonization(
        image: Tensor,
        distortion: ColorBlindnessDistortion,
        progress: Callable[[float], None],
    ) -> tuple[Tensor]:

        with warnings.catch_warnings():
            warnings.simplefilter("ignore")
            return (
                achromatic_daltonization(
                    image,
                    distortion,
                    ADParameters(progress=progress, loss_func=M1Loss()),
                ),
            )

    if __name__ == "__main__":

        distortion = ColorBlindnessDistortion.from_type("protan")
        demo_cvd(
            "Achromatic Daltonization",
            demo_achromatic_daltonization,
            distortion=distortion,
        )

–ó–¥–µ—Å—å:

- `torch.Tensor` ‚Äî —Ä–∞–±–æ—Ç–∞ —Å —Ç–µ–Ω–∑–æ—Ä–∞–º–∏ –≤ PyTorch;
- `Callable` ‚Äî —Ç–∏–ø –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ –∏–∑ `typing`;
- `M1Loss` ‚Äî —Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å;
- `ColorBlindnessDistortion` ‚Äî —Å–∏–º—É–ª—è—Ü–∏—è –¥–∏—Ö—Ä–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∏—Å–∫–∞–∂–µ–Ω–∏—è; 
- `ADParameters` ‚Äî –∫–ª–∞—Å—Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∞–ª–≥–æ—Ä–∏—Ç–º–∞;
- `demo`, `demo_cvd` ‚Äî —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.

–≠—Ç–æ—Ç –∫–æ–¥ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –≤–Ω–µ—Å–µ–Ω –≤ —Ñ–∞–π–ª olimp/examples/precompensation/achromatic_daltonization.py –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω –∫–æ–º–∞–Ω–¥–æ–π 

    python3 -m olimp.examples.precompensation.achromatic_daltonization

–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ —ç—Ç–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –≤—ã–¥–∞–µ—Ç—Å—è –æ–∫–Ω–æ —Å 4 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏: –∏—Å—Ö–æ–¥–Ω—ã–º, —Å–∏–º—É–ª—è—Ü–∏–µ–π –µ–≥–æ –≤–æ—Å–ø—Ä–∏—è—Ç–∏—è —á–µ–ª–æ–≤–µ–∫–æ–º —Å –î–¶–ó, –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –∏ —Å–∏–º—É–ª—è—Ü–∏–µ–π –µ–≥–æ –≤–æ—Å–ø—Ä–∏—è—Ç–∏—è.


### –ú–µ—Ç–æ–¥ CVD Direct Optimization

–ú–µ—Ç–æ–¥ CVD Direct Optimization ‚Äî —á–∏—Å–ª–µ–Ω–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è, –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è –Ω–∞ **–ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—É—é –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—é**  
–¥–µ—Ñ–µ–∫—Ç–æ–≤ —Ü–≤–µ—Ç–æ–≤–æ–≥–æ –∑—Ä–µ–Ω–∏—è (–î–¶–ó), –Ω–∞–ø—Ä–∏–º–µ—Ä –ø—Ä–æ—Ç–∞–Ω–æ–ø–∏—è, –¥–µ–π—Ç–µ—Ä–∞–Ω–æ–ø–∏—è. –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –∑–∞–¥–∞—á, –≥–¥–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É—á–µ—Å—Ç—å –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –∏—Å–∫–∞–∂–µ–Ω–∏—è  
–∑—Ä–µ–Ω–∏—è –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª—è (–º–æ–¥–µ–ª—å `ColorBlindnessDistortion`) –∏ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞–ø—Ä—è–º—É—é –±–µ–∑ –æ–±—É—á–µ–Ω–∏—è –Ω–µ–π—Ä–æ—Å–µ—Ç–∏.

**–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Å–ø—É—Å–∫ —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π –ø–æ –∫–∞—Ä—Ç–µ –≤–µ—Å–æ–≤ (weight map);
- –ü–æ—Ç–µ—Ä–∏ —Å—á–∏—Ç–∞—é—Ç—Å—è –º–µ–∂–¥—É –∏—Å—Ö–æ–¥–Ω—ã–º –∏ —Å–∏–º—É–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —Ä–µ—Ç–∏–Ω–∞–ª—å–Ω—ã–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º;
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ª—é–±—ã–µ –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏—Ä—É–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, RMS –≤ Lab-–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ);
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Ä–∞–Ω–Ω—è—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∏ —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–æ —à–∞–≥—É –∏–∑–º–µ–Ω–µ–Ω–∏—è loss.

**–í—Ö–æ–¥:**
- –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ;
- –º–æ–¥–µ–ª—å –∏—Å–∫–∞–∂–µ–Ω–∏—è –∑—Ä–µ–Ω–∏—è (`ColorBlindnessDistortion`);
- –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (—Å–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è, —Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å –∏ —Ç.–ø.).

**–í—ã—Ö–æ–¥:**
- –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω–æ–µ –¥–ª—è –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª—è —Å –î–¶–ó.

üß™ –ú–µ—Ç–æ–¥ –ø–æ–∫–∞ –Ω–µ –∏–º–µ–µ—Ç –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã—Ö —Å—Ç–∞—Ç–µ–π, –Ω–æ –≤—Ö–æ–¥–∏—Ç –≤ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π —Å—Ç–µ–∫ open-source —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞ `pyolimp`.


–î–ª—è –≤—ã–∑–æ–≤–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–¥ –∏–∑ —Ñ–∞–π–ª–∞ olimp/examples/precompensation/cvd_direct_optimization.py

–ü–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –∫–æ–¥ –∞–Ω–∞–ª–æ–≥–∏—á–µ–Ω –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–º—É –≤ –º–µ—Ç–æ–¥–µ Achromatic Daltonization (—Å–º. –≤—ã—à–µ). –î–ª—è –µ–≥–æ –±—ã—Å—Ç—Ä–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É:

    python3 -m olimp.examples.precompensation.cvd_direct_optimization


### –ú–µ—Ç–æ–¥ Tennenholtz-Zachevsky

–ú–µ—Ç–æ–¥ **Tennenholtz-Zachevsky** –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π  
–ø—Ä–∏ –∞–Ω–æ–º–∞–ª–∏—è—Ö —Ü–≤–µ—Ç–æ–≤–æ–≥–æ –∑—Ä–µ–Ω–∏—è (–¥–∏—Ö—Ä–æ–º–∞—Ç–∏–∏), —Ç–∞–∫–∏—Ö –∫–∞–∫ –ø—Ä–æ—Ç–∞–Ω–æ–ø–∏—è –∏ –¥–µ–π—Ç–µ—Ä–∞–Ω–æ–ø–∏—è.  
–ú–µ—Ç–æ–¥ –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç –∏—Å–∫–∞–∂–µ–Ω–∏—è –≤ LMS-–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ, –º–∏–Ω–∏–º–∏–∑–∏—Ä—É—è —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É  
–≤–æ—Å–ø—Ä–∏—è—Ç–∏–µ–º –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∏ –∫–æ–º–ø–µ–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª—è —Å –Ω–∞—Ä—É—à–µ–Ω–∏–µ–º.

–í –∫–∞—á–µ—Å—Ç–≤–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ä–∞–∑–Ω–æ—Å—Ç—å –≤ LMS-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö,  
–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–≤–æ–¥–∏—Ç—Å—è –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π  
–Ω–∞ –¥–æ–ø—É—Å—Ç–∏–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —è—Ä–∫–æ—Å—Ç–∏.

**–í—Ö–æ–¥:**
- –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ;
- —Ç–∏–ø —Ü–≤–µ—Ç–æ–≤–æ–π –∞–Ω–æ–º–∞–ª–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, protan, deutan).

**–í—ã—Ö–æ–¥:**
- –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø–æ–¥ —Ç–∏–ø –î–¶–ó.

üìñ –ü–æ–¥—Ä–æ–±–Ω–µ–µ:  
Tennenholtz G., Zachevsky A.  
*A Perception-Based Approach for Color Correction of Dichromats*,  
APSIPA ASC, 2019.  
[–°–∫–∞—á–∞—Ç—å PDF](sandbox:/mnt/data/5c6023e6-9374-4916-b84e-ca7c43b58489.pdf)


–î–ª—è –≤—ã–∑–æ–≤–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–¥ –∏–∑ —Ñ–∞–π–ª–∞ olimp/examples/precompensation/tennenholtz_zachevsky.py

–ü–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –∫–æ–¥ –∞–Ω–∞–ª–æ–≥–∏—á–µ–Ω –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–º—É –≤ –º–µ—Ç–æ–¥–µ Achromatic Daltonization (—Å–º. –≤—ã—à–µ). –î–ª—è –µ–≥–æ –±—ã—Å—Ç—Ä–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É:

    python3 -m olimp.examples.precompensation.tennenholtz_zachevsky

## –ü—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è –Ω–µ–π—Ä–æ—Å–µ—Ç–µ–≤—ã–º–∏ –º–µ—Ç–æ–¥–∞–º–∏

### –ü—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è —Ä–µ—Ñ—Ä–∞–∫—Ü–∏–æ–Ω–Ω—ã—Ö –∏—Å–∫–∞–∂–µ–Ω–∏–π (–†–ò–ó)

#### –ú–µ—Ç–æ–¥ DWDN (Deep Wiener Deconvolution Network)

–ú–µ—Ç–æ–¥ **DWDN** ‚Äî –Ω–µ–π—Ä–æ—Å–µ—Ç–µ–≤–æ–π –∞–ª–≥–æ—Ä–∏—Ç–º –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏,  
–ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ **–≥–ª—É–±–æ–∫–æ–π –¥–µ–∫–æ–Ω–≤–æ–ª—é—Ü–∏–æ–Ω–Ω–æ–π —Å–µ—Ç–∏**,  
–∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–±–ª–∏–∂–∞–µ—Ç —Ä–∞–±–æ—Ç—É **—Ñ–∏–ª—å—Ç—Ä–∞ –í–∏–Ω–µ—Ä–∞** –≤ –æ–±—É—á–∞–µ–º–æ–º –≤–∏–¥–µ.  
DWDN —É—á–∏—Ç—ã–≤–∞–µ—Ç –∫–∞–∫ –∏—Å–∫–∞–∂–µ–Ω–∏—è –æ—Ç –∞–±–µ—Ä—Ä–∞—Ü–∏–π –∑—Ä–µ–Ω–∏—è (—á–µ—Ä–µ–∑ PSF),  
—Ç–∞–∫ –∏ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –≤—Ö–æ–¥–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è.

**–í—Ö–æ–¥:**
- –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ;
- PSF (—Ñ—É–Ω–∫—Ü–∏—è —Ä–∞—Å—Å–µ—è–Ω–∏—è —Ç–æ—á–∫–∏).

**–í—ã—Ö–æ–¥:**
- –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ [0, 1].

üìñ –ü–æ–¥—Ä–æ–±–Ω–µ–µ:  
–ú–µ—Ç–æ–¥ –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ —Å—Ç–∞—Ç—å–µ:  
**DWDN: Deep Wiener Deconvolution Network for Non-Blind Image Deblurring**,  
arXiv, 2021.  
[–°–∫–∞—á–∞—Ç—å PDF](https://arxiv.org/pdf/2103.09962)

–î–ª—è –∑–∞–ø—É—Å–∫–∞ –º–µ—Ç–æ–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–ª–µ–¥—É—é—â–∏–π –∫–æ–¥:


    from __future__ import annotations

    from typing import Callable
    import torch
    from torch import Tensor

    from olimp.precompensation._demo import demo
    from olimp.precompensation.nn.models.dwdn import PrecompensationDWDN

    if __name__ == "__main__":

        def demo_dwdn(
            image: Tensor, psf: Tensor, progress: Callable[[float], None]
        ) -> Tensor:
            model = PrecompensationDWDN.from_path(path="hf://RVI/dwdn.pt")

            with torch.inference_mode():
                inputs = model.preprocess(image, psf.to(torch.float32))
                progress(0.1)
                (precompensation,) = model(inputs, **model.arguments(inputs, psf))
                progress(1.0)
                return precompensation

        demo("DWDN", demo_dwdn, mono=True, num_output_channels=3)

–ó–¥–µ—Å—å:

- `torch.Tensor` ‚Äî —Ä–∞–±–æ—Ç–∞ —Å —Ç–µ–Ω–∑–æ—Ä–∞–º–∏ –≤ PyTorch;
- `Callable` ‚Äî —Ç–∏–ø –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ –∏–∑ `typing`;
- `demo` ‚Äî —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.

–û–±—Ä–∞—â–∞–µ–º –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –≤–∞–∂–Ω–æ—Å—Ç—å –∑–∞–ø—É—Å–∫–∞ –Ω–µ–π—Ä–æ—Å–µ—Ç–µ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç-–º–µ–Ω–µ–¥–∂–µ—Ä–∞ torch.inference_mode().

–≠—Ç–æ—Ç –∫–æ–¥ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –≤–Ω–µ—Å–µ–Ω –≤ —Ñ–∞–π–ª olimp/examples/precompensation_nn/dwdn.py –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω –∫–æ–º–∞–Ω–¥–æ–π 

    python3 -m olimp.examples.precompensation_nn.dwdn

–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –∑–∞–ø—É—Å–∫–∞ —ç—Ç–æ—Ç –≤—ã–∑–æ–≤ –≤—ã–¥–∞—Å—Ç –æ–∫–Ω–æ —Å 4 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏: –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞—Å—Å–µ—è–Ω–∏—è —Ç–æ—á–∫–∏ (–§–†–¢, PSF), –∏—Å—Ö–æ–¥–Ω—ã–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º, —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏ –∏ —Å–∏–º—É–ª—è—Ü–∏–µ–π, –∫–∞–∫ –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –±—É–¥–µ—Ç –≤–∏–¥–Ω–æ –Ω–µ–∏–¥–µ–∞–ª—å–Ω–æ–π –∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π —Å –¥–∞–Ω–Ω–æ–π –§–†–¢. 

### üß† –ú–µ—Ç–æ–¥ USRNet

–ú–µ—Ç–æ–¥ **USRNet** –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π **–Ω–µ–π—Ä–æ—Å–µ—Ç–µ–≤–æ–π –∞–ª–≥–æ—Ä–∏—Ç–º –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏**,  
–æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ **–∏—Ç–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –¥–µ–∫–æ–Ω–≤–æ–ª—é—Ü–∏–∏**. –°–µ—Ç—å –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø—É **—Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è  
–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞**, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–æ—Å—Ç–∏—á—å –≤—ã—Å–æ–∫–æ–π —Ç–æ—á–Ω–æ—Å—Ç–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è  
–¥–µ—Ç–∞–ª–µ–π –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –∏—Å–∫–∞–∂–µ–Ω–∏–π, –≤—ã–∑–≤–∞–Ω–Ω—ã—Ö –∞–±–µ—Ä—Ä–∞—Ü–∏—è–º–∏ –∑—Ä–µ–Ω–∏—è.

USRNet –∏—Å–ø–æ–ª—å–∑—É–µ—Ç PSF (—Ñ—É–Ω–∫—Ü–∏—é —Ä–∞—Å—Å–µ—è–Ω–∏—è —Ç–æ—á–∫–∏) –∏ –æ–±—É—á–µ–Ω–∞ –Ω–∞ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö,  
–≤–∫–ª—é—á–∞—è —à—É–º –∏ –≤–∞—Ä–∏–∞—Ç–∏–≤–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ –∏—Å–∫–∞–∂–µ–Ω–∏–π, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –µ—ë —É—Å—Ç–æ–π—á–∏–≤–æ–π –∫ —Ä–∞–∑–ª–∏—á–Ω—ã–º —Å–∏—Ç—É–∞—Ü–∏—è–º.

#### üßæ –í—Ö–æ–¥:
- –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ;
- PSF (–≤ –≤–∏–¥–µ —Ç–µ–Ω–∑–æ—Ä–∞);
- –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: `scale_factor = 1`, `noise_level = 0`.

#### üì§ –í—ã—Ö–æ–¥:
- –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ –≤ RGB –∏ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ.

üìñ –ü–æ–¥—Ä–æ–±–Ω–µ–µ:  
Zhang et al.,  
**Deep Unfolding Network for Image Super-Resolution**,  
CVPR, 2020.  
[–°–∫–∞—á–∞—Ç—å PDF](https://openaccess.thecvf.com/content_CVPR_2020/papers/Zhang_Deep_Unfolding_Network_for_Image_Super-Resolution_CVPR_2020_paper.pdf)


–î–ª—è –≤—ã–∑–æ–≤–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–¥ –∏–∑ —Ñ–∞–π–ª–∞ olimp/examples/precompensation_nn/usrnet.py

–ü–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –∫–æ–¥ –∞–Ω–∞–ª–æ–≥–∏—á–µ–Ω –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–º—É –≤ –º–µ—Ç–æ–¥–µ DWDN (—Å–º. –≤—ã—à–µ). –î–ª—è –µ–≥–æ –±—ã—Å—Ç—Ä–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É:

    python3 -m olimp.examples.precompensation_nn.usrnet





### üß† –ú–µ—Ç–æ–¥ CVAE (Conditional Variational Autoencoder)

–ú–µ—Ç–æ–¥ **CVAE** –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π **–Ω–µ–π—Ä–æ—Å–µ—Ç–µ–≤–æ–π –∞–ª–≥–æ—Ä–∏—Ç–º –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏**,  
–æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ **—É—Å–ª–æ–≤–Ω–æ–º –≤–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω–æ–º –∞–≤—Ç–æ–∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–µ**. –°–µ—Ç—å –æ–±—É—á–∞–µ—Ç—Å—è –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞—Ç—å  
—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å —É—á—ë—Ç–æ–º PSF (—Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞—Å—Å–µ—è–Ω–∏—è —Ç–æ—á–∫–∏),  
—á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, —É—Å—Ç–æ–π—á–∏–≤—ã–µ –∫ —Ä–∞–∑–ª–∏—á–Ω—ã–º –≤–∏–¥–∞–º –∏—Å–∫–∞–∂–µ–Ω–∏–π.

CVAE —Å–æ—á–µ—Ç–∞–µ—Ç –≤ —Å–µ–±–µ –≥–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω—É—é –º–æ–¥–µ–ª—å –∏ —Å—Ç–æ—Ö–∞—Å—Ç–∏—á–µ—Å–∫–∏–π –ª–∞—Ç–µ–Ω—Ç–Ω—ã–π –∫–æ–¥,  
—á—Ç–æ –¥–µ–ª–∞–µ—Ç –µ–≥–æ –ø—Ä–∏–≥–æ–¥–Ω—ã–º –¥–ª—è –∑–∞–¥–∞—á, –≥–¥–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É—á–∏—Ç—ã–≤–∞—Ç—å –Ω–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ—Å—Ç—å –≤ –¥–∞–Ω–Ω—ã—Ö.

#### üßæ –í—Ö–æ–¥:
- –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ;
- PSF (–≤ –≤–∏–¥–µ 2D —Ç–µ–Ω–∑–æ—Ä–∞);
- (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ) ‚Äî –∫–æ–¥–∏—Ä–æ–≤–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ PSF –≤ –ª–∞—Ç–µ–Ω—Ç–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ  
  –∏ –¥–∞–ª—å–Ω–µ–π—à–∞—è –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∫–∞ –≤ –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ.

#### üì§ –í—ã—Ö–æ–¥:
- –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ;
- —Å—Ä–µ–¥–Ω–µ–µ (`mu`) –∏ –ª–æ–≥-–¥–∏—Å–ø–µ—Ä—Å–∏—è (`logvar`) –ª–∞—Ç–µ–Ω—Ç–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è  
  (–∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏ –∏ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ—Å—Ç–∏).

üìñ –ü–æ–¥—Ä–æ–±–Ω–µ–µ:  
- Zhiwei Xue et. al,  
**Diffusion Models for Probabilistic Deconvolution of Galaxy Images**,   
[–°–∫–∞—á–∞—Ç—å PDF](https://arxiv.org/pdf/2307.11122)  
- Artidoro Pagnoni et al.,  
**Conditional Variational Autoencoder for Neural Machine Translation**,   
[–°–∫–∞—á–∞—Ç—å PDF](https://arxiv.org/abs/1812.04405)



–î–ª—è –≤—ã–∑–æ–≤–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–¥ –∏–∑ —Ñ–∞–π–ª–∞ olimp/examples/precompensation_nn/cvae.py

–ü–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –∫–æ–¥ –∞–Ω–∞–ª–æ–≥–∏—á–µ–Ω –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–º—É –≤ –º–µ—Ç–æ–¥–µ DWDN (—Å–º. –≤—ã—à–µ). –î–ª—è –µ–≥–æ –±—ã—Å—Ç—Ä–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É:

    python3 -m olimp.examples.precompensation_nn.cvae



### üß† –ú–µ—Ç–æ–¥ VAE (Variational Autoencoder)

–ú–µ—Ç–æ–¥ **VAE** ‚Äî —ç—Ç–æ **–≤–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω—ã–π –∞–≤—Ç–æ–∫–æ–¥–∏—Ä–æ–≤—â–∏–∫**, –ø—Ä–∏–º–µ–Ω—ë–Ω–Ω—ã–π –¥–ª—è –∑–∞–¥–∞—á–∏ –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏  
–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –∏—Å–∫–∞–∂–µ–Ω–∏–π. –û–Ω –æ–±—É—á–∞–µ—Ç—Å—è —Ä–µ–∫–æ–Ω—Å—Ç—Ä—É–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è,  
–∏—Å–ø–æ–ª—å–∑—É—è —Ç–æ–ª—å–∫–æ **–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏ PSF**, –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π.

#### üßæ –í—Ö–æ–¥:
- –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ;
- PSF (–≤ –≤–∏–¥–µ 2D —Ç–µ–Ω–∑–æ—Ä–∞);
- –º–æ–¥–µ–ª—å –∫–æ–¥–∏—Ä—É–µ—Ç –≤—Ö–æ–¥ –≤ –ª–∞—Ç–µ–Ω—Ç–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ,  
  –∫–æ—Ç–æ—Ä–æ–µ –∑–∞—Ç–µ–º –¥–µ–∫–æ–¥–∏—Ä—É–µ—Ç—Å—è –≤ –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—é.

#### üì§ –í—ã—Ö–æ–¥:
- –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ;
- –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ª–∞—Ç–µ–Ω—Ç–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è (`mu`, `logvar`)  
  (–∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏ –∏ –º–æ–≥—É—Ç –±—ã—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ—Å—Ç–∏).

üìñ –ü–æ–¥—Ä–æ–±–Ω–µ–µ:  
- Zhiwei Xue et. al,  
**Diffusion Models for Probabilistic Deconvolution of Galaxy Images**, (–ò–¥–µ—è –≤–∑—è—Ç–∞)  
[–°–∫–∞—á–∞—Ç—å PDF](https://arxiv.org/pdf/2307.11122)  
- Kingma & Welling,  
**Auto-Encoding Variational Bayes**,  
ICLR, 2014.  
[–°–∫–∞—á–∞—Ç—å PDF](https://arxiv.org/pdf/1312.6114) 

–î–ª—è –≤—ã–∑–æ–≤–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–¥ –∏–∑ —Ñ–∞–π–ª–∞ olimp/examples/precompensation_nn/vae.py

–ü–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –∫–æ–¥ –∞–Ω–∞–ª–æ–≥–∏—á–µ–Ω –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–º—É –≤ –º–µ—Ç–æ–¥–µ DWDN (—Å–º. –≤—ã—à–µ). –î–ª—è –µ–≥–æ –±—ã—Å—Ç—Ä–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É:

    python3 -m olimp.examples.precompensation_nn.vae



### üß† –ú–µ—Ç–æ–¥ UNET-B0 (–Ω–∞ –±–∞–∑–µ EfficientNet)

–ú–µ—Ç–æ–¥ **UNET-B0** ‚Äî —ç—Ç–æ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–≥–æ U-Net,  
–≤ –∫–æ—Ç–æ—Ä–æ–π —ç–Ω–∫–æ–¥–µ—Ä –ø–æ—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –æ—Å–Ω–æ–≤–µ **EfficientNet-B0**.  
–û–Ω –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –¥–ª—è –∑–∞–¥–∞—á–∏ –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏ –∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –∏—Å–∫–∞–∂–µ–Ω–∏–π,  
–∏—Å–ø–æ–ª—å–∑—É—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏ **PSF** –∫–∞–∫ –≤—Ö–æ–¥.

#### üßæ –í—Ö–æ–¥:
- –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ;
- PSF (–≤ –≤–∏–¥–µ 2D —Ç–µ–Ω–∑–æ—Ä–∞);
- –æ–±–∞ —Ç–µ–Ω–∑–æ—Ä–∞ –æ–±—ä–µ–¥–∏–Ω—è—é—Ç—Å—è –∏ –ø–æ–¥–∞—é—Ç—Å—è –Ω–∞ –≤—Ö–æ–¥ —Å–µ—Ç–∏.

#### üì§ –í—ã—Ö–æ–¥:
- –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ  
  (—Ç–µ–Ω–∑–æ—Ä —Ç–æ–≥–æ –∂–µ —Ä–∞–∑–º–µ—Ä–∞, —á—Ç–æ –∏ –≤—Ö–æ–¥).

üìñ –ü–æ–¥—Ä–æ–±–Ω–µ–µ:  
- –ú–æ–¥–µ–ª—å –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ EfficientNet-B0 (—ç–Ω–∫–æ–¥–µ—Ä);  
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–µ–∫–æ–¥–µ—Ä–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ U-Net;  
- –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–ª—è –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏: *–Ω–∞—à–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –±–µ–∑ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏*.  
- –ò–º–µ–µ—Ç –º–∞–ª–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–π —Ç–æ—á–Ω–æ—Å—Ç–∏.

–î–ª—è –≤—ã–∑–æ–≤–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–¥ –∏–∑ —Ñ–∞–π–ª–∞ olimp/examples/precompensation_nn/unet_efficient_b0.py

–ü–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –∫–æ–¥ –∞–Ω–∞–ª–æ–≥–∏—á–µ–Ω –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–º—É –≤ –º–µ—Ç–æ–¥–µ DWDN (—Å–º. –≤—ã—à–µ). –î–ª—è –µ–≥–æ –±—ã—Å—Ç—Ä–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É:

    python3 -m olimp.examples.precompensation_nn.unet_efficient_b0



### üß† –ú–µ—Ç–æ–¥ UNETVAE

–ú–µ—Ç–æ–¥ **UNETVAE** —Å–æ—á–µ—Ç–∞–µ—Ç –≤ —Å–µ–±–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ UNet –∏ –≤–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –∞–≤—Ç–æ–∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–∞ (VAE),  
—á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞—Ç—å –Ω–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ—Å—Ç—å –∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –≤—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è.  
–ú–æ–¥–µ–ª—å –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –Ω–∞ –≤—Ö–æ–¥ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏ **PSF**, –∏–∑–≤–ª–µ–∫–∞–µ—Ç –ª–∞—Ç–µ–Ω—Ç–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏  
–≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ.

#### üßæ –í—Ö–æ–¥:
- –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ;
- PSF (–≤ –≤–∏–¥–µ 2D —Ç–µ–Ω–∑–æ—Ä–∞);
- –¥–∞–Ω–Ω—ã–µ –∫–æ–¥–∏—Ä—É—é—Ç—Å—è –≤ `mu`, `logvar`, –∑–∞—Ç–µ–º —Ä–µ–∫–æ–Ω—Å—Ç—Ä—É–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ –≤—ã–±–æ—Ä–∫—É –∏–∑ –ª–∞—Ç–µ–Ω—Ç–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è.

#### üì§ –í—ã—Ö–æ–¥:
- –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ;
- –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ª–∞—Ç–µ–Ω—Ç–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è (`mu`, `logvar`)  
  (–∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –æ–±—É—á–µ–Ω–∏—è –∏ –º–æ–≥—É—Ç –±—ã—Ç—å –ø–æ–ª–µ–∑–Ω—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞).

üìñ –ü–æ–¥—Ä–æ–±–Ω–µ–µ:  
- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —ç–Ω–∫–æ–¥–µ—Ä–∞-–¥–µ–∫–æ–¥–µ—Ä–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ UNet;  
- –î–æ–±–∞–≤–ª–µ–Ω —Å—Ç–æ—Ö–∞—Å—Ç–∏—á–µ—Å–∫–∏–π –ª–∞—Ç–µ–Ω—Ç–Ω—ã–π —Å–ª–æ–π, –∫–∞–∫ –≤ VAE;  
- –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–ª—è –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏: *–Ω–∞—à–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –±–µ–∑ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏*.



–î–ª—è –≤—ã–∑–æ–≤–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–¥ –∏–∑ —Ñ–∞–π–ª–∞ olimp/examples/precompensation_nn/unetvae.py

–ü–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –∫–æ–¥ –∞–Ω–∞–ª–æ–≥–∏—á–µ–Ω –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–º—É –≤ –º–µ—Ç–æ–¥–µ DWDN (—Å–º. –≤—ã—à–µ). –î–ª—è –µ–≥–æ –±—ã—Å—Ç—Ä–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É:

    python3 -m olimp.examples.precompensation_nn.unetvae


### üß† –ú–µ—Ç–æ–¥ VDSR (Very Deep Super-Resolution)

–ú–µ—Ç–æ–¥ **VDSR** ‚Äî —ç—Ç–æ **–≥–ª—É–±–æ–∫–∞—è —Å–≤–µ—Ä—Ç–æ—á–Ω–∞—è –Ω–µ–π—Ä–æ—Å–µ—Ç—å**, –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–ª—è –∑–∞–¥–∞—á–∏  
–ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏ –∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –∏—Å–∫–∞–∂–µ–Ω–∏–π. –ò—Å—Ö–æ–¥–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ VDSR –±—ã–ª–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–∞ –¥–ª—è  
—Å–≤–µ—Ä—Ö—Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –Ω–æ –≤ –Ω–∞—à–µ–π —Ä–∞–±–æ—Ç–µ –æ–Ω–∞ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å PSF  
(—Ñ—É–Ω–∫—Ü–∏–µ–π —Ä–∞—Å—Å–µ—è–Ω–∏—è —Ç–æ—á–∫–∏) –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.

VDSR –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–æ—Å—Ç—É—é, –Ω–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É —Å –º–Ω–æ–∂–µ—Å—Ç–≤–æ–º —Å–≤–µ—Ä—Ç–æ—á–Ω—ã—Ö —Å–ª–æ—ë–≤,  
—á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –µ–π —Ç–æ—á–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –¥–µ—Ç–∞–ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–∞–∂–µ –ø—Ä–∏ –∏—Å–∫–∞–∂–µ–Ω–∏—è—Ö.

#### üßæ –í—Ö–æ–¥:
- –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ;
- PSF (–≤ –≤–∏–¥–µ 2D —Ç–µ–Ω–∑–æ—Ä–∞);
- –¥–∞–Ω–Ω—ã–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∏ –ø–æ–¥–∞—é—Ç—Å—è –Ω–∞ –≤—Ö–æ–¥ —Å–≤–µ—Ä—Ç–æ—á–Ω–æ–π —Å–µ—Ç–∏.

#### üì§ –í—ã—Ö–æ–¥:
- –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ.

üìñ –ü–æ–¥—Ä–æ–±–Ω–µ–µ:  
- –ë–∞–∑–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:  
  Kim et al.,  
  **Accurate Image Super-Resolution Using Very Deep Convolutional Networks**,  
  CVPR, 2016.  
  [–°–∫–∞—á–∞—Ç—å PDF](https://arxiv.org/pdf/1511.04587)

- –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–ª—è –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏: *–Ω–∞—à–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –±–µ–∑ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏*.


–î–ª—è –≤—ã–∑–æ–≤–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–¥ –∏–∑ —Ñ–∞–π–ª–∞ olimp/examples/precompensation_nn/unetvae.py

–ü–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –∫–æ–¥ –∞–Ω–∞–ª–æ–≥–∏—á–µ–Ω –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–º—É –≤ –º–µ—Ç–æ–¥–µ DWDN (—Å–º. –≤—ã—à–µ). –î–ª—è –µ–≥–æ –±—ã—Å—Ç—Ä–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É:

    python3 -m olimp.examples.precompensation_nn.vdsr


## üß† –ú–µ—Ç–æ–¥ CVDSwin4Channels

–ú–µ—Ç–æ–¥ **CVDSwin4Channels** —è–≤–ª—è–µ—Ç—Å—è –Ω–∞—à–µ–π –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–µ–π, –æ—Å–Ω–æ–≤–∞–Ω–Ω–æ–π –Ω–∞ —Å–µ–º–µ–π—Å—Ç–≤–µ –Ω–µ–π—Ä–æ—Å–µ—Ç–µ–π CVD-SWIN (—Å—Å—ã–ª–∫–∞ –ø—Ä–∏–≤–µ–¥–µ–Ω–∞ –Ω–∏–∂–µ).
CVD-SWIN –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Å–µ–º–µ–π—Å—Ç–≤–æ –Ω–µ–π—Ä–æ—Å–µ—Ç–µ–≤—ã—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã—Ö –Ω–∞ Swin —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–∞—Ö –∏ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã—Ö –¥–ª—è –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏ —Ü–≤–µ—Ç–æ–≤—ã—Ö –∏—Å–∫–∞–∂–µ–Ω–∏–π, –≤—ã–∑–≤–∞–Ω–Ω—ã—Ö –¥–µ—Ñ–µ–∫—Ç–∞–º–∏ —Ü–≤–µ—Ç–æ–≤–æ–≥–æ –∑—Ä–µ–Ω–∏—è (–î–¶–ó).
–ò—Å–ø–æ–ª—å–∑—É–µ–º–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å —É—á–∏—Ç—ã–≤–∞–µ—Ç –∫–∞–∫ –∫–æ–Ω—Ç—Ä–∞—Å—Ç –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏, —Ç–∞–∫ –∏ "–Ω–∞—Ç—É—Ä–∞–ª—å–Ω–æ—Å—Ç—å" —Ü–≤–µ—Ç–æ–≤.
–û–¥–Ω–∞–∫–æ, –¥–∞–Ω–Ω–∞—è –Ω–µ–π—Ä–æ—Å–µ—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∞ –æ–±—É—á–µ–Ω–∏–µ–º –Ω–∞ –æ–¥–Ω–æ–º —Ç–∏–ø–µ –∏—Å–∫–∞–∂–µ–Ω–∏—è: –¥–µ–π—Ç–µ—Ä–∞–Ω–æ–ø–∏–∏ –∏–ª–∏ –ø—Ä–æ—Ç–∞–Ω–æ–ø–∏–∏.

–ú–µ—Ç–æ–¥ **CVDSwin4Channels** –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –≤—Ö–æ–¥, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±—É—á–∞—Ç—å –Ω–µ–π—Ä–æ—Å–µ—Ç—å –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ç–∏–ø–∞—Ö –∏—Å–∫–∞–∂–µ–Ω–∏–π –î–¶–ó.
–≠—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ –≤–∏–¥–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –∏—Å–∫–∞–∂–µ–Ω–∏—è (—É–≥–æ–ª –º–µ–∂–¥—É –≤–µ–∫—Ç–æ—Ä–æ–º —Ü–≤–µ—Ç–æ–≤–æ–π —Å–ª–µ–ø–æ—Ç—ã –∏ –æ—Å—å—é L –≤ —Ü–≤–µ—Ç–æ–≤–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ LMS) –≤ –≤–∏–¥–µ —á–µ—Ç–≤–µ—Ä—Ç–æ–≥–æ –∫–∞–Ω–∞–ª–∞, 
–ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–µ–≥–æ —Å–æ–±–æ–π –ø–æ–ø–∏–∫—Å–µ–ª—å–Ω–æ–µ —Å–∫–∞–ª—è—Ä–Ω–æ–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ linRGB –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ –≤–µ–∫—Ç–æ—Ä–∞ —Ü–≤–µ—Ç–æ–≤–æ–π —Å–ª–µ–ø–æ—Ç—ã –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ linRGB.
–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –≤–Ω–µ—Å–µ–Ω–∞ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è, –ø–æ –∫–æ—Ç–æ—Ä–æ–π –Ω–µ–π—Ä–æ—Å–µ—Ç—å –¥–ª—è –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —è—Ä–∫–æ—Å—Ç–∏.
–ù–µ–±–æ–ª—å—à–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —è—Ä–∫–æ—Å—Ç–∏ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –Ω–∞ —ç—Ç–∞–ø–µ –∫–≤–∞–Ω—Ç–∏–ª—å–Ω–æ–≥–æ –∫–ª–∏–ø–∏–Ω–≥–∞, –≥–¥–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç—Å—è –≤ –¥–∏–∞–ø–∞–∑–æ–Ω [0,1] 
—á–∞—Å—Ç–∏—á–Ω–æ –ø—É—Ç–µ–º –¥–µ–ª–µ–Ω–∏—è –≤—Å–µ–≥–æ –∏—Ç–æ–≥–æ–≤–æ–≥–æ linRGB –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–µ —á–∏—Å–ª–æ (–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∫–≤–∞–Ω—Ç–∏–ª–µ–º –æ—Ç –Ω–∞–±–æ—Ä–∞ 
–º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π —Å—Ä–µ–¥–∏ —Ç—Ä–µ—Ö –∫–∞–Ω–∞–ª–æ–≤ –ø–æ –≤—Å–µ–º –ø–∏–∫—Å–µ–ª—è–º) –∏ —á–∞—Å—Ç–∏—á–Ω–æ –ø—Ä—è–º—ã–º –∫–ª–∏–ø–ø–∏–Ω–≥–æ–º –≤ [0,1].

–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –∏—Å—Ö–æ–¥–Ω—ã—Ö —Ü–≤–µ—Ç–æ–≤.

#### üßæ –í—Ö–æ–¥:
- –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (–≤ RGB, –∑–∞—Ç–µ–º –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç—Å—è –≤ 4-–∫–∞–Ω–∞–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç);
- —Ç–∏–ø –¥–µ—Ñ–µ–∫—Ç–∞ —Ü–≤–µ—Ç–æ–≤–æ–≥–æ –∑—Ä–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, `protan`, `deutan`, –∏–ª–∏ –ª—é–±–æ–µ –¥—Ä—É–≥–æ–µ –∑–∞–¥–∞–Ω–Ω–æ–µ —É–≥–ª–æ–º).

#### üì§ –í—ã—Ö–æ–¥:
- –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –ø—Ä–∏–≥–æ–¥–Ω–æ–µ –¥–ª—è –≤–æ—Å–ø—Ä–∏—è—Ç–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º —Å –î–¶–ó.

–ú–µ—Ç–æ–¥ **CVDSwin4Channels** —è–≤–ª—è–µ—Ç—Å—è –Ω–∞—à–µ–π –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –∏ –µ—â–µ –Ω–µ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–∞.

üìñ –ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ CVD-SWIN, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–π –æ—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞—à–∞ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è:  
Ligeng Chen et al.,  
**Swin Transformer for Precompensation of Refractive and Color Vision Defects**,  
Neural Computing and Applications, Springer, 2023.  
[–°–∫–∞—á–∞—Ç—å PDF](https://link.springer.com/content/pdf/10.1007/s00521-023-09367-2.pdf)

–î–ª—è –∑–∞–ø—É—Å–∫–∞ –º–µ—Ç–æ–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–ª–µ–¥—É—é—â–∏–π –∫–æ–¥:

    from __future__ import annotations

    from typing import Callable
    import torch
    from torch import Tensor

    from olimp.precompensation._demo_cvd import demo as demo_cvd
    from olimp.precompensation.nn.models.cvd_swin.cvd_swin_4channels import (
        CVDSwin4Channels,
    )
    from olimp.simulate.color_blindness_distortion import ColorBlindnessDistortion

    if __name__ == "__main__":

        def demo_cvd_swin(
            image: Tensor,
            distortion: ColorBlindnessDistortion,
            progress: Callable[[float], None],
        ) -> tuple[torch.Tensor]:
            svd_swin = CVDSwin4Channels.from_path()
            image = svd_swin.preprocess(image, hue_angle_deg=torch.tensor([0.0]))
            progress(0.1)
            precompensation = svd_swin(image)
            progress(1.0)
            return (svd_swin.postprocess(precompensation[0]),)

        distortion = ColorBlindnessDistortion.from_type("protan")
        demo_cvd(
            "CVD-SWIN",
            demo_cvd_swin,
            distortion=distortion,
        )


–ó–¥–µ—Å—å:

- `torch.Tensor` ‚Äî —Ä–∞–±–æ—Ç–∞ —Å —Ç–µ–Ω–∑–æ—Ä–∞–º–∏ –≤ PyTorch;
- `ColorBlindnessDistortion` ‚Äî —Å–∏–º—É–ª—è—Ü–∏—è –¥–∏—Ö—Ä–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∏—Å–∫–∞–∂–µ–Ω–∏—è; 
- `CVDSwin4Channels` ‚Äî –∫–ª–∞—Å—Å –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏;
- `demo_cvd` ‚Äî —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.

–≠—Ç–æ—Ç –∫–æ–¥ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –≤–Ω–µ—Å–µ–Ω –≤ —Ñ–∞–π–ª  –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω –∫–æ–º–∞–Ω–¥–æ–π olimp/examples/precompensation_nn/cvd_swin.py

    python3 -m olimp.examples.precompensation_nn.cvd_swin

–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ —ç—Ç–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –≤—ã–¥–∞–µ—Ç—Å—è –æ–∫–Ω–æ —Å 4 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏: –∏—Å—Ö–æ–¥–Ω—ã–º, —Å–∏–º—É–ª—è—Ü–∏–µ–π –µ–≥–æ –≤–æ—Å–ø—Ä–∏—è—Ç–∏—è —á–µ–ª–æ–≤–µ–∫–æ–º —Å –î–¶–ó, –ø—Ä–µ–¥–∫–æ–º–ø–µ–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –∏ —Å–∏–º—É–ª—è—Ü–∏–µ–π –µ–≥–æ –≤–æ—Å–ø—Ä–∏—è—Ç–∏—è.


## –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π –∏—Å–∫–∞–∂–µ–Ω–∏–π, —Å–∏–º—É–ª–∏—Ä—É—é—â–∏—Ö –†–ò–ó –∏ –î–¶–ó

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π —Ä–µ—Ñ—Ä–∞–∫—Ü–∏–æ–Ω–Ω—ã—Ö –∏—Å–∫–∞–∂–µ–Ω–∏–π (–†–ò–ó)

–î–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–∞—Ç–∞—Å–µ—Ç–∞ —Ñ—É–Ω–∫—Ü–∏–π —Ä–∞—Å—Å–µ—è–Ω–∏—è —Ç–æ—á–∫–∏ (–§–†–¢), —Ä–µ–∞–ª–∏–∑—É—é—â–∏—Ö —Ä–µ—Ñ—Ä–∞–∫—Ü–∏–æ–Ω–Ω—ã–µ –∏—Å–∫–∞–∂–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–ª–∞—Å—Å **PSFSCADataset** (–Ω–∞—Å–ª–µ–¥—É–µ—Ç—Å—è –æ—Ç –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞ `DistortionDataset`)  
–ú–æ–¥–µ–ª—å —É—á–∏—Ç—ã–≤–∞–µ—Ç —Å—Ñ–µ—Ä–∏—á–µ—Å–∫–∏–µ –∏ —Ü–∏–ª–∏–Ω–¥—Ä–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ —Ä–µ—Ñ—Ä–∞–∫—Ü–∏–∏, —É–≥–æ–ª –∞—Å—Ç–∏–≥–º–∞—Ç–∏–∑–º–∞ –∏ –¥–∏–∞–º–µ—Ç—Ä –∑—Ä–∞—á–∫–∞.

#### üßæ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞:
- **width**, **height** ‚Äî —Ä–∞–∑–º–µ—Ä—ã –≤—ã—Ö–æ–¥–Ω–æ–≥–æ –§–†–¢ –≤ –ø–∏–∫—Å–µ–ª—è—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, `512√ó512`).
- **sphere_dpt** ‚Äî —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ñ–µ—Ä–∏—á–µ—Å–∫–æ–π —Å–æ—Å—Ç–∞–≤–ª—è—é—â–µ–π —Ä–µ—Ñ—Ä–∞–∫—Ü–∏–∏ (–≤ –¥–∏–æ–ø—Ç—Ä–∏—è—Ö); —Å–ª–æ–≤–∞—Ä—å:
  - `name`: —Ç–∏–ø —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è, –Ω–∞–ø—Ä–∏–º–µ—Ä `"uniform"`
  - `a`, `b`: –≥—Ä–∞–Ω–∏—Ü—ã –¥–∏–∞–ø–∞–∑–æ–Ω–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä `a = -4.0`, `b = -2.0`
- **cylinder_dpt** ‚Äî —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ü–∏–ª–∏–Ω–¥—Ä–∏—á–µ—Å–∫–æ–π —Å–æ—Å—Ç–∞–≤–ª—è—é—â–µ–π (–≤ –¥–∏–æ–ø—Ç—Ä–∏—è—Ö); –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ `sphere_dpt`.
- **angle_deg** ‚Äî —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —É–≥–ª–∞ –∞—Å—Ç–∏–≥–º–∞—Ç–∏–∑–º–∞ –≤ –≥—Ä–∞–¥—É—Å–∞—Ö; –Ω–∞–ø—Ä–∏–º–µ—Ä `a = 0.0`, `b = 180.0`.
- **pupil_diameter_mm** ‚Äî –¥–∏–∞–º–µ—Ç—Ä –∑—Ä–∞—á–∫–∞ –≤ –º–∏–ª–ª–∏–º–µ—Ç—Ä–∞—Ö; –Ω–∞–ø—Ä–∏–º–µ—Ä `a = 3.0`, `b = 5.0`.
- **am2px** ‚Äî –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ø–µ—Ä–µ–≤–æ–¥–∞ —É–≥–ª–æ–≤—ã—Ö –º–∏–Ω—É—Ç –≤ –ø–∏–∫—Å–µ–ª–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `0.001`).
- **seed** ‚Äî –Ω–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ —Å–ª—É—á–∞–π–Ω—ã—Ö —á–∏—Å–µ–ª –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `42`).
- **size** ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–±–æ—Ä–æ–∫ –≤ –¥–∞—Ç–∞—Å–µ—Ç–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `100`).

#### üì• –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
1. –°–æ–∑–¥–∞–π—Ç–µ —ç–∫–∑–µ–º–ø–ª—è—Ä `PSFSCADataset` —Å –Ω—É–∂–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏.
2. –ü–æ–ª—É—á–∏—Ç–µ —ç–ª–µ–º–µ–Ω—Ç —á–µ—Ä–µ–∑ `dataset[idx]`, –≥–¥–µ `idx` –æ—Ç `0` –¥–æ `size-1`.
3. –ö–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç ‚Äî —Ç–µ–Ω–∑–æ—Ä —Ñ–æ—Ä–º—ã `(1, H, W)` ‚Äî –æ–¥–Ω–æ–º–µ—Ä–Ω–∞—è –§–†–¢, —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –º–æ–¥–µ–ª—å—é –≥–ª–∞–∑–∞.

#### üì§ –í—ã—Ö–æ–¥ –∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞:
- **–§–†–¢**: —Ç–µ–Ω–∑–æ—Ä `Tensor[1, H, W]`, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —Å–º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–º—É –∏—Å–∫–∞–∂–µ–Ω–∏—é –∑—Ä–µ–Ω–∏—è.
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≤—ã–±–æ—Ä–∫–∏**: `sphere_dpt`, `cylinder_dpt`, `angle_deg`, `pupil_diameter_mm` (–º–æ–∂–Ω–æ –ª–æ–≥–≥–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ).

–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
    from __future__ import annotations

    from torch import Tensor
    from matplotlib import pylab as plt

    from olimp.precompensation.nn.dataset.psf_sca import PSFSCADataset
    from olimp.simulate._demo_distortion import demo


    def show_one(image: Tensor, title: str) -> None:
        if image.isnan().any():
            raise ValueError("has nan")
        fig, ax1 = plt.subplots(dpi=72, figsize=(6, 4.5), ncols=1, nrows=1)
        plt.title(title)
        ax1.imshow(image)
        plt.show()


    if __name__ == "__main__":

        dataset = PSFSCADataset(
            width=512,
            height=512,
            sphere_dpt={
                "name": "uniform",
                "a": -4.0,
                "b": -2.0,
            },  # uniform –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ [-2,‚ÄØ0]
            cylinder_dpt={
                "name": "uniform",
                "a": -4.0,
                "b": -2.0,
            },  # —Ç–æ, —á—Ç–æ —É –≤–∞—Å —É–∂–µ –±—ã–ª–æ
            angle_deg={
                "name": "uniform",
                "a": 0.0,
                "b": 180.0,
            },  # —Ç–æ, —á—Ç–æ —É –≤–∞—Å —É–∂–µ –±—ã–ª–æ
            pupil_diameter_mm={
                "name": "uniform",
                "a": 3.0,
                "b": 5.0,
            },  # uniform, –Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—Ç 3 –¥–æ 5‚ÄØ–º–º
            am2px=0.001,
            seed=42,
            size=100,
        )

        def demo_simulate():
            apply_fn = dataset.apply()
            funcs = []

            for i in range(3):
                psf = dataset[i]
                show_one(psf[0], title=f"Gaussian PSF #{i}")

                # —Å–æ–∑–¥–∞—ë–º —Ñ—É–Ω–∫—Ü–∏—é —Å –∑–∞—Ö–≤–∞—á–µ–Ω–Ω—ã–º –∏–Ω–¥–µ–∫—Å–æ–º
                funcs.append((lambda image, i=i: list(apply_fn(image))[i], f"{i}"))

            return funcs

        demo("RefractionDistortion", demo_simulate, on="horse", size=(512, 512))

–î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ —ç—Ç–æ—Ç –∫–æ–¥ —Ä–∞–∑–º–µ—â–µ–Ω –≤ —Ñ–∞–π–ª–µ olimp/examples/simulate/psf_sca_datasets.py –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω –∫–æ–º–∞–Ω–¥–æ–π:

    python3 -m olimp.examples.simulate.psf_sca_datasets

–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –∑–∞–ø—É—Å–∫–∞ –≤ –ø–∞–º—è—Ç–∏ –±—É–¥–µ—Ç —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω –¥–∞—Ç–∞—Å–µ—Ç —Ä–∞–∑–º–µ—Ä–æ–º 100 (–ø–∞—Ä–∞–º–µ—Ç—Ä size) –∏ –æ—Ç–∫—Ä—ã—Ç—ã 3 –æ–∫–Ω–∞ —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –§–†–¢ –∏–∑ —ç—Ç–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞, –∞ —Ç–∞–∫–∂–µ –æ–∫–Ω–æ —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ —Å–∏–º—É–ª—è—Ü–∏–π –†–ò–ó (—Ä–∞–∑–º—ã—Ç—ã–º–∏ –ø—Ä–∏ –ø–æ–º–æ—â–∏ —ç—Ç–∏—Ö –§–†–¢ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π). –û–∫–Ω–∞ –±—É–¥—É—Ç –æ—Ç–∫—Ä—ã–≤–∞—Ç—å—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ.


### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π –¥–∏—Ö—Ä–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –∏—Å–∫–∞–∂–µ–Ω–∏–π (–î–¶–ó)

–î–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–∞—Ç–∞—Å–µ—Ç–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π —Ü–≤–µ—Ç–æ–≤–æ–π —Å–ª–µ–ø–æ—Ç—ã, –æ–ø–∏—Å—ã–≤–∞—é—â–∏—Ö —Ä–∞–∑–Ω—ã–µ –≤–∏–¥—ã –¥–∏—Ö—Ä–æ–º–∞–∑–∏–∏, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–ª–∞—Å—Å **ColorBlindnessDataset** (–Ω–∞—Å–ª–µ–¥—É–µ—Ç—Å—è –æ—Ç –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞ `DistortionDataset`)  
–ü–æ–º–∏–º–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –ø—Ä–æ—Ç–∞–Ω–æ–ø–æ–≤, –¥–µ–π—Ç–µ—Ä–∞–Ω–æ–ø–æ–≤ –∏ —Ç—Ä–∏—Ç–∞–Ω–æ–ø–æ–≤ –º–æ–¥–µ–ª—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ü–≤–µ—Ç–æ–≤–æ–π —Å–ª–µ–ø–æ—Ç—ã.

#### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞:
  - **angle_deg** ‚Äî —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —É–≥–ª–∞ –Ω–∞ —Ü–≤–µ—Ç–æ–≤–æ–º –∫—Ä—É–≥–µ (–≤ –≥—Ä–∞–¥—É—Å–∞—Ö):
  - `name`: —Ç–∏–ø —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, `"uniform"`)
  - `a`: –Ω–∏–∂–Ω—è—è –≥—Ä–∞–Ω–∏—Ü–∞ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `33.0`)
  - `b`: –≤–µ—Ä—Ö–Ω—è—è –≥—Ä–∞–Ω–∏—Ü–∞ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `360.0`)
- **seed** ‚Äî –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ —Å–ª—É—á–∞–π–Ω—ã—Ö —á–∏—Å–µ–ª (–Ω–∞–ø—Ä–∏–º–µ—Ä, `11`)
- **size** ‚Äî —Ç—Ä–µ–±—É–µ–º—ã–π —Ä–∞–∑–º–µ—Ä –¥–∞—Ç–∞—Å–µ—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `365`)

#### üì• –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
1. –°–æ–∑–¥–∞–π—Ç–µ —ç–∫–∑–µ–º–ø–ª—è—Ä `ColorBlindnessDataset` —Å –Ω—É–∂–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏.
2. –ü–æ–ª—É—á–∏—Ç–µ —É–≥–æ–ª —á–µ—Ä–µ–∑ `angle = dataset[idx].item()`, –≥–¥–µ `idx` –æ—Ç `0` –¥–æ `size - 1`.
3. –ü–æ–ª—É—á–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é –∏—Å–∫–∞–∂–µ–Ω–∏—è —á–µ—Ä–µ–∑ `dataset._distortions[idx]()`.
4. –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –µ—ë –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é: `image_transformed = apply_fn(image)`.

#### üì§ –í—ã—Ö–æ–¥ –∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞:
- **–£–≥–æ–ª —Ü–≤–µ—Ç–æ–≤–æ–π —Å–ª–µ–ø–æ—Ç—ã**: –∑–Ω–∞—á–µ–Ω–∏–µ —Ç–∏–ø–∞ `float`, –≤ –≥—Ä–∞–¥—É—Å–∞—Ö.
- **–§—É–Ω–∫—Ü–∏—è –∏—Å–∫–∞–∂–µ–Ω–∏—è**: `Callable[[Tensor], Tensor]`, –∏–º–∏—Ç–∏—Ä—É—é—â–∞—è –¥–∏—Ö—Ä–æ–º–∞–∑–∏—é —Å –∑–∞–¥–∞–Ω–Ω—ã–º —É–≥–ª–æ–º.

–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:

    from __future__ import annotations

    from olimp.precompensation.nn.dataset.cvd_angle import ColorBlindnessDataset
    from olimp.simulate._demo_distortion import demo


    if __name__ == "__main__":

        dataset = ColorBlindnessDataset(
            angle_deg={"name": "uniform", "a": 33.0, "b": 360.0}, seed=11, size=365
        )

        def demo_simulate():
            funcs = []

            for i in range(3):
                angle = dataset[i].item()
                funcs.append(
                    (
                        lambda image, distortion=dataset._distortions[
                            i
                        ]: distortion()(image),
                        f"{angle:.1f}¬∞",
                    )
                )

            return funcs

        demo("ColorBlindnessDistortion (3 angles)", demo_simulate)

–î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã–π –ø—Ä–∏–º–µ—Ä —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ —Ñ–∞–π–ª olimp/examples/simulate/color_blind_distortion_datasets.py –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω –∫–æ–º–∞–Ω–¥–æ–π

    python3 -m olimp.examples.simulate.color_blind_distortion_datasets 

–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –∑–∞–ø—É—Å–∫–∞ –≤ –ø–∞–º—è—Ç–∏ –±—É–¥–µ—Ç —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω –¥–∞—Ç–∞—Å–µ—Ç –∏–∑ 365 (–ø–∞—Ä–∞–º–µ—Ç—Ä size) –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π —Ü–≤–µ—Ç–æ–≤–æ–π —Å–ª–µ–ø–æ—Ç—ã –∏ –æ—Ç–∫—Ä—ã—Ç–æ –æ–∫–Ω–æ, –≤ –∫–æ—Ç–æ—Ä–æ–º –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—Ç—Å—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏ –ø—Ä–∏–º–µ—Ä—ã –µ–≥–æ –¥–∏—Ö—Ä–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –∏—Å–∫–∞–∂–µ–Ω–∏–π —Å 3 –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º–∏ –∏–∑ —ç—Ç–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞.

## –û–±—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã—Ö –≤–æ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–µ –Ω–µ–π—Ä–æ—Å–µ—Ç–µ–≤—ã—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä —Å –∑–∞–¥–∞–Ω–Ω—ã–º –¥–∞—Ç–∞—Å–µ—Ç–æ–º

–ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ –≤–æ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–µ –Ω–µ–π—Ä–æ—Å–µ—Ç–µ–≤—ã–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –º–æ–≥—É—Ç –±—ã—Ç—å –∑–∞–Ω–æ–≤–æ –æ–±—É—á–µ–Ω—ã —Å –æ—Å–æ–±—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏. –î–ª—è —ç—Ç–æ–≥–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª –æ–±—É—á–µ–Ω–∏—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –≤–∏–¥–∞:

    {
        "model": {
            "name": "precompensationusrnet",
            "n_iter": 2
        },
        "img": {
            "datasets": [
                {
                    "name": "SCA2023",
                    "subsets": [
                        "Images/Real_images/Faces"
                    ]
                }
            ],
            "transforms": [
                {
                    "name": "grayscale",
                    "num_output_channels": 3
                },
                {
                    "name": "resize",
                    "width": 512,
                    "height": 512
                },
                {
                    "name": "float32"
                },
                {
                    "name": "divide",
                    "value": 255
                }
            ]
        },
        "distortion": [
            {
                "name": "refraction_datasets",
                "psf": {
                    "datasets": [
                        {
                            "name": "SCA2023",
                            "subsets": [
                                "PSFs/Narrow"
                            ]
                        }
                    ]
                }
            }
        ],
        "batch_size": 1,
        "sample_size": 1,
        "epochs": 500,
        "optimizer": {
            "name": "Adam",
            "learning_rate": 0.0001,
            "eps": 1e-8
        },
        "loss_function": {
            "name": "MS_SSIM"
        }
    }

–î–∞–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ä–∞–∑–º–µ—â–µ–Ω–∞ –≤ —Ñ–∞–π–ª–µ olimp/precompensation/nn/pipeline/usrnet.json

–î–ª—è –æ–±—É—á–µ–Ω–∏—è —Å –¥–∞–Ω–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É (–Ω–∞—Ö–æ–¥—è—Å—å –≤ –∫–æ—Ä–Ω–µ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ –∏–ª–∏ —É–∫–∞–∑–∞–≤ –ø–æ–ª–Ω—ã–π –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏):

    python3 -m olimp.precompensation.nn.train.train --config ./olimp/precompensation/nn/pipeline/usrnet.json

–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —ç—Ç–æ–π –∫–æ–º–∞–Ω–¥—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫–∞—á–∏–≤–∞–µ—Ç—Å—è —Ç—Ä–µ–±—É–µ–º—ã–π –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –¥–∞—Ç–∞—Å–µ—Ç, –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ–±—É—á–µ–Ω–∏—è –∏ –≤–µ—Å–∞ –æ–±—É—á–µ–Ω–Ω–æ–π –Ω–µ–π—Ä–æ—Å–µ—Ç–µ–≤–æ–π –º–æ–¥–µ–ª–∏ –ø–æ–º–µ—â–∞—é—Ç—Å—è –≤–æ –≤—Ä–µ–º–µ–Ω–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –≤–Ω—É—Ç—Ä–∏ **epoch_saved/** 