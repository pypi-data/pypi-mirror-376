"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([["12085"],{89868:function(t,e,i){i.d(e,{i:function(){return s}});i(40777),i(87799);const n=(0,i(40645).P)(t=>{history.replaceState({scrollPosition:t},"")},300);function s(t){return(e,i)=>{if("object"==typeof i)throw new Error("This decorator does not support this compilation type.");const s=e.connectedCallback;e.connectedCallback=function(){s.call(this);const e=this[i];e&&this.updateComplete.then(()=>{const i=this.renderRoot.querySelector(t);i&&setTimeout(()=>{i.scrollTop=e},0)})};const o=Object.getOwnPropertyDescriptor(e,i);let a;if(void 0===o)a={get(){var t;return this[`__${String(i)}`]||(null===(t=history.state)||void 0===t?void 0:t.scrollPosition)},set(t){n(t),this[`__${String(i)}`]=t},configurable:!0,enumerable:!0};else{const t=o.set;a=Object.assign(Object.assign({},o),{},{set(e){n(e),this[`__${String(i)}`]=e,null==t||t.call(this,e)}})}Object.defineProperty(e,i,a)}}},86420:function(t,e,i){i.d(e,{D:function(){return n}});i(20655);const n=t=>{var e;return null===(e=t.name)||void 0===e?void 0:e.trim()}},58125:function(t,e,i){i.d(e,{wZ:function(){return a},jL:function(){return o},sU:function(){return c}});i(26847),i(81738),i(94814),i(6989),i(20655),i(27530);var n=i(28105),s=i(15459);i(67886),i(65451),i(46015),i(38334),i(94880),i(75643),i(29761);const o=t=>{var e;return null===(e=t.name_by_user||t.name)||void 0===e?void 0:e.trim()},a=(t,e,i)=>o(t)||i&&r(e,i)||e.localize("ui.panel.config.devices.unnamed_device",{type:e.localize(`ui.panel.config.devices.type.${t.entry_type||"device"}`)}),r=(t,e)=>{for(const i of e||[]){const e="string"==typeof i?i:i.entity_id,n=t.states[e];if(n)return(0,s.C)(n)}},c=(0,n.Z)(t=>function(t){const e=new Set,i=new Set;for(const n of t)i.has(n)?e.add(n):i.add(n);return e}(Object.values(t).map(t=>o(t)).filter(t=>void 0!==t)))},61981:function(t,e,i){i.d(e,{K:function(){return a},T:function(){return r}});var n=i(58125),s=i(15459),o=i(55107);const a=(t,e)=>{const i=e.entities[t.entity_id];return i?r(i,e):(0,s.C)(t)},r=(t,e)=>{const i=t.name||("original_name"in t&&null!=t.original_name?String(t.original_name):void 0),a=t.device_id?e.devices[t.device_id]:void 0;if(!a){if(i)return i;const n=e.states[t.entity_id];return n?(0,s.C)(n):void 0}const r=(0,n.jL)(a);if(r!==i)return r&&i&&(0,o.N)(i,r)||i}},55107:function(t,e,i){i.d(e,{N:function(){return s}});i(26847),i(44261),i(27530);const n=[" ",": "," - "],s=(t,e)=>{const i=t.toLowerCase(),s=e.toLowerCase();for(const a of n){const e=`${s}${a}`;if(i.startsWith(e)){const i=t.substring(e.length);if(i.length)return o(i.substr(0,i.indexOf(" ")))?i:i[0].toUpperCase()+i.slice(1)}}},o=t=>t.toLowerCase()!==t},73804:function(t,e,i){i.d(e,{lY:function(){return f},AP:function(){return v},oU:function(){return m},VG:function(){return _}});i(39710),i(26847),i(2394),i(18574),i(73042),i(81738),i(94814),i(29981),i(22960),i(6989),i(87799),i(67886),i(65451),i(46015),i(38334),i(94880),i(75643),i(29761),i(56389),i(20655),i(27530);var n=i(40141),s=i(44272),o=i(6219),a=i(15459);var r=i(55107),c=i(36221),l=i(85993),d=i(96222),u=i(99918),h=i(19331);const p=new Set(["ai_task","automation","configurator","device_tracker","event","geo_location","notify","persistent_notification","script","sun","tag","todo","zone",...n.a5]),y=new Set(["backup","mobile_app"]),f=(t,e)=>Object.assign({type:"grid",cards:t.map(t=>({type:"tile",entity:t,show_entity_picture:["camera","image","person"].includes((0,s.M)(t))||void 0}))},e),_=(t,e,i,o=!0)=>{const l=[],d=[],u=i.title?i.title.toLowerCase():void 0,h=[];for(const n of e){const e=t[n],i=(0,s.M)(n);if("alarm_control_panel"===i){const t={type:"alarm-panel",entity:n};l.push(t)}else if("camera"===i){const t={type:"picture-entity",entity:n};l.push(t)}else if("image"===i){const t={type:"picture",image_entity:n};l.push(t)}else if("climate"===i){var p,y,f;const e={type:"thermostat",entity:n,features:(null!==(p=null===(y=t[n])||void 0===y||null===(y=y.attributes)||void 0===y||null===(y=y.hvac_modes)||void 0===y?void 0:y.length)&&void 0!==p?p:0)>1?[{type:"climate-hvac-modes",hvac_modes:null===(f=t[n])||void 0===f||null===(f=f.attributes)||void 0===f?void 0:f.hvac_modes}]:void 0};l.push(e)}else if("humidifier"===i){const t={type:"humidifier",entity:n,features:[{type:"humidifier-toggle"}]};l.push(t)}else if("media_player"===i){const t={type:"media-control",entity:n};l.push(t)}else if("plant"===i){const t={type:"plant-status",entity:n};l.push(t)}else if("weather"===i){const t={type:"weather-forecast",entity:n,show_forecast:!1};l.push(t)}else if(!o||"scene"!==i&&"script"!==i){let t;const i=u&&e&&(t=(0,r.N)((0,a.C)(e),u))?{entity:n,name:t}:n;d.push(i)}else{const t={entity:n,show_icon:!0,show_name:!0};let i;u&&e&&(i=(0,r.N)((0,a.C)(e),u))&&(t.name=i),h.push(t)}}if(d.sort((e,i)=>{const o="string"==typeof e?e:e.entity,r="string"==typeof i?i:i.entity,l=n.zF.includes((0,s.M)(o))?"sensor":"control";return l!==(n.zF.includes((0,s.M)(r))?"sensor":"control")?"sensor"===l?1:-1:(0,c.$K)("string"==typeof e?t[e]?(0,a.C)(t[e]):"":e.name||"","string"==typeof i?t[i]?(0,a.C)(t[i]):"":i.name||"")}),0===d.length&&h.length>0)return _(t,e,i,!1);if(d.length>0||h.length>0){const t=Object.assign({type:"entities",entities:d},i);h.length>0&&(t.footer={type:"buttons",entities:h}),l.unshift(t)}return l.length<2?l:[{type:"grid",square:!1,columns:1,cards:l}]},m=(t,e)=>{const i=[];for(const n of e){const t={type:"entity",entity:n};i.push(t)}return i},v=(t,e,i,n,r,f,m,v,g)=>{const b=((t,e)=>{const i={},n=new Set(Object.values(e).filter(t=>t.entity_category||t.platform&&y.has(t.platform)||t.hidden).map(t=>t.entity_id));for(const s of Object.keys(t)){const e=t[s];p.has((0,o.N)(e))||n.has(e.entity_id)||(i[s]=t[s])}return i})(n,i),w={};for(const s of Object.keys(b)){const t=b[s];t.attributes.order&&(w[s]=t.attributes.order)}const C=((t,e,i,n)=>{const s=Object.assign({},n),o={},a={};for(const c of Object.values(i)){var r;const i=c.area_id||c.device_id&&(null===(r=e[c.device_id])||void 0===r?void 0:r.area_id);i&&i in t&&c.entity_id in s?(i in o||(o[i]=[]),o[i].push(s[c.entity_id]),delete s[c.entity_id]):c.device_id&&c.device_id in e&&c.entity_id in s&&(c.device_id in a||(a[c.device_id]=[]),a[c.device_id].push(s[c.entity_id]),delete s[c.entity_id])}for(const[c,l]of Object.entries(a))1===l.length&&(s[l[0].entity_id]=l[0],delete a[c]);return{areasWithEntities:o,devicesWithEntities:a,otherEntities:s}})(t,e,i,b);if(null!=m&&m.hidden)for(const s of m.hidden)delete C.areasWithEntities[s];v&&(C.devicesWithEntities={},C.otherEntities={});const $=(t=>{const e=[],i={};return Object.keys(t).forEach(n=>{const o=t[n];"group"===(0,s.M)(n)?e.push(o):i[n]=o}),e.forEach(t=>t.attributes.entity_id.forEach(t=>{delete i[t]})),{groups:e,ungrouped:i}})(C.otherEntities);$.groups.sort((t,e)=>w[t.entity_id]-w[e.entity_id]);const j=[];for(const s of $.groups)j.push(..._(n,s.attributes.entity_id,{title:(0,a.C)(s),show_header_toggle:"hidden"!==s.attributes.control}));const k=((t,e,i,n,s)=>{const r={};for(const a of Object.keys(s)){const t=s[a],e=(0,o.N)(t);e in r||(r[e]=[]),r[e].push(t.entity_id)}const l=[];if("person"in r){const t=[];if(1===r.person.length)l.push({type:"entities",entities:r.person});else{let e,i="";for(const n of r.person){const o=s[n];let a=o.attributes.entity_picture;if(!a){if(void 0===e){const t=getComputedStyle(document.body);e=encodeURIComponent(t.getPropertyValue("--light-primary-color").trim()),i=encodeURIComponent((t.getPropertyValue("--text-light-primary-color")||t.getPropertyValue("--primary-text-color")).trim())}a=`data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 50 50' width='50' height='50' style='background-color:${e}'%3E%3Cg%3E%3Ctext font-family='roboto' x='50%25' y='50%25' text-anchor='middle' stroke='${i}' font-size='1.3em' dy='.3em'%3E${(0,u.fm)(o.attributes.friendly_name||"")}%3C/text%3E%3C/g%3E%3C/svg%3E`}t.push({type:"picture-entity",entity:n,aspect_ratio:"1",show_name:!1,image:a})}l.push({type:"grid",square:!0,columns:3,cards:t})}delete r.person}const p=[];for(const o of h.y)o in r&&(p.push(...r[o]),delete r[o]);const y={};for(const o of Object.keys(r))y[o]=(0,d.Lh)(t,o);p.length&&(r._helpers=p,y._helpers=t("ui.panel.lovelace.strategy.original-states.helpers")),Object.keys(r).sort((t,e)=>(0,c.$K)(y[t],y[e])).forEach(t=>{l.push(..._(s,r[t].sort((t,e)=>(0,c.$K)((0,a.C)(s[t]),(0,a.C)(s[e]))),{title:y[t]}))});const f={path:e,title:i,cards:l};return n&&(f.icon=n),f})(r,"default_view","Home",undefined,$.ungrouped),E=[],O=Object.keys(C.areasWithEntities).sort((0,l.a)(t,null==m?void 0:m.order));for(const s of O){const e=C.areasWithEntities[s],i=t[s];E.push(..._(n,e.map(t=>t.entity_id),{title:i.name}))}const z=[],L=Object.entries(C.devicesWithEntities).sort((t,i)=>{const n=e[t[0]],s=e[i[0]];return(0,c.$K)(n.name_by_user||n.name||"",s.name_by_user||s.name||"")});for(const[s,o]of L){const t=e[s];z.push(..._(n,o.map(t=>t.entity_id),{title:t.name_by_user||t.name||r("ui.panel.config.devices.unnamed_device",{type:r(`ui.panel.config.devices.type.${t.entry_type||"device"}`)})}))}let x;if(f&&!g){const t=f.energy_sources.find(t=>"grid"===t.type);t&&t.flow_from.length>0&&(x={title:r("ui.panel.lovelace.cards.energy.energy_distribution.title_today"),type:"energy-distribution",link_dashboard:!0})}return k.cards.unshift(...E,...j,...x?[x]:[]),k.cards.push(...z),k}},7299:function(t,e,i){i.a(t,async function(t,e){try{i(26847),i(81738),i(6989),i(27530);var n=i(73742),s=i(59048),o=i(7616),a=i(36180),r=i(28105),c=i(39884),l=i(86420),d=i(58125),u=i(44272),h=i(61981),p=i(51574),y=i(97050),f=(i(9277),i(23476)),_=i(19262),m=i(96222),v=t([f,_]);[f,_]=v.then?(await v)():v;let g,b,w,C,$,j,k,E=t=>t;const O=(0,a.V)({fontFamily:"var(--ha-font-family-code)",fontSize:"var(--ha-font-size-xs)"});class z extends s.oi{firstUpdated(t){super.firstUpdated(t),this.hass.loadBackendTranslation("title")}render(){var t;const e=this._data(this.hass.states,this.hass.localize,this.entities),i=Boolean(null===(t=this.hass.userData)||void 0===t?void 0:t.showEntityIdPicker),n=this._columns(this.narrow,(0,y.HE)(this.hass),i);return(0,s.dy)(g||(g=E` <ha-data-table class="${0}" .hass="${0}" selectable .id="${0}" .columns="${0}" .data="${0}" .searchLabel="${0}" .noLabelFloat="${0}" .noDataText="${0}" @selection-changed="${0}"></ha-data-table> `),i?"show-entity-id":"",this.hass,"entity_id",n,e,this.hass.localize("ui.panel.lovelace.unused_entities.search"),this.noLabelFloat,this.hass.localize("ui.panel.lovelace.unused_entities.no_data"),this._handleSelectionChanged)}_handleSelectionChanged(t){const e=t.detail.value;(0,c.B)(this,"selected-changed",{selectedEntities:e})}_handleEntityClicked(t){const e=t.target.closest(".mdc-data-table__row").rowId;(0,c.B)(this,"hass-more-info",{entityId:e})}constructor(...t){super(...t),this.narrow=!1,this.noLabelFloat=!1,this._data=(0,r.Z)((t,e,i)=>(i||Object.keys(t)).map(t=>{const i=this.hass.states[t],{area:n,device:s}=(0,p.U)(i,this.hass),o=(0,h.K)(i,this.hass),a=s?(0,d.jL)(s):void 0,r=n?(0,l.D)(n):void 0,c=[a,o].filter(Boolean).join(" "),y=(0,u.M)(t);return{icon:"",entity_id:t,stateObj:i,name:c,entity_name:o,device_name:a,area_name:r,domain_name:(0,m.Lh)(e,y),last_changed:i.last_changed}})),this._columns=(0,r.Z)((t,e,i)=>{const n={icon:{title:"",label:this.hass.localize("ui.panel.lovelace.unused_entities.state_icon"),type:"icon",template:t=>(0,s.dy)(b||(b=E` <state-badge @click="${0}" .hass="${0}" .stateObj="${0}"></state-badge> `),this._handleEntityClicked,this.hass,t.stateObj)},name:{title:this.hass.localize("ui.panel.lovelace.unused_entities.entity"),sortable:!0,filterable:!0,flex:2,main:!0,direction:"asc",template:n=>{const o=n.entity_name||n.device_name||n.entity_id,a=[n.area_name,n.entity_name?n.device_name:void 0].filter(Boolean).join(e?" ◂ ":" ▸ ");return(0,s.dy)(w||(w=E` <div @click="${0}" style="cursor:pointer"> ${0} ${0} ${0} </div> `),this._handleEntityClicked,o,a?(0,s.dy)(C||(C=E`<div class="secondary">${0}</div>`),a):s.Ld,t&&i?(0,s.dy)($||($=E` <div class="secondary" style="${0}"> ${0} </div> `),O,n.entity_id):s.Ld)}},entity_name:{title:"entity_name",filterable:!0,hidden:!0},device_name:{title:"device_name",filterable:!0,hidden:!0},area_name:{title:"area_name",filterable:!0,hidden:!0}};return n.entity_id={title:this.hass.localize("ui.panel.lovelace.unused_entities.entity_id"),sortable:!0,filterable:!0,hidden:t||!i},n.domain_name={title:this.hass.localize("ui.panel.lovelace.unused_entities.domain"),sortable:!0,filterable:!0,hidden:t||i},n.last_changed={title:this.hass.localize("ui.panel.lovelace.unused_entities.last_changed"),type:"numeric",sortable:!0,hidden:t,template:t=>(0,s.dy)(j||(j=E` <ha-relative-time .hass="${0}" .datetime="${0}" capitalize></ha-relative-time> `),this.hass,t.last_changed)},n})}}z.styles=(0,s.iv)(k||(k=E`ha-data-table{--data-table-border-width:0;height:100%}ha-data-table.show-entity-id{--data-table-row-height:64px}`)),(0,n.__decorate)([(0,o.Cb)({attribute:!1})],z.prototype,"hass",void 0),(0,n.__decorate)([(0,o.Cb)({type:Boolean})],z.prototype,"narrow",void 0),(0,n.__decorate)([(0,o.Cb)({type:Boolean,attribute:"no-label-float"})],z.prototype,"noLabelFloat",void 0),(0,n.__decorate)([(0,o.Cb)({type:Array})],z.prototype,"entities",void 0),z=(0,n.__decorate)([(0,o.Mo)("hui-entity-picker-table")],z),e()}catch(g){e(g)}})}}]);
//# sourceMappingURL=12085.a2d650c53d737d5c.js.map