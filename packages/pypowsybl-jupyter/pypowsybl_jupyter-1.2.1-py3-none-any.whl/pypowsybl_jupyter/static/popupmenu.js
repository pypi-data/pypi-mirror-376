var s=class{constructor(e,n,t){this.menuItems=[];this.focusedIndex=-1;this.id="";this.container=e,this.items=n,this.menuItemCallback=t,this.popupMenu=null,this.handleOutsideClick=this.handleOutsideClick.bind(this),this.handleKeydown=this.handleKeydown.bind(this)}initializeMenu(){this.popupMenu=document.createElement("div"),this.popupMenu.style.position="absolute",this.popupMenu.style.display="none",this.popupMenu.style.backgroundColor="#fff",this.popupMenu.style.border="1px solid #ccc",this.popupMenu.style.boxShadow="0px 4px 6px rgba(0, 0, 0, 0.1)",this.popupMenu.style.padding="10px",this.popupMenu.style.zIndex="1000",this.items.forEach((e,n)=>{let t=document.createElement("div");t.textContent=e,t.style.padding="5px",t.style.cursor="pointer",t.tabIndex=0,t.addEventListener("mouseover",()=>{this.focusMenuItem(n)}),t.addEventListener("mouseout",()=>{t.style.backgroundColor=""}),t.addEventListener("click",()=>{this.menuItemCallback?.(n,this.id),this.hideMenu()}),this.popupMenu.appendChild(t),this.menuItems.push(t)}),this.container.appendChild(this.popupMenu)}displayMenu(e,n,t){this.popupMenu==null&&this.initializeMenu(),this.popupMenu&&this.popupMenu.style.display=="none"&&(this.popupMenu.style.left=`${e}px`,this.popupMenu.style.top=`${n}px`,this.popupMenu.style.display="block",this.focusedIndex=-1,this.id=t,setTimeout(()=>{document.addEventListener("mousedown",this.handleOutsideClick),document.addEventListener("keydown",this.handleKeydown)},0))}hideMenu(){this.popupMenu&&(this.popupMenu.style.display="none",document.removeEventListener("mousedown",this.handleOutsideClick),document.removeEventListener("keydown",this.handleKeydown))}handleOutsideClick(e){this.popupMenu&&!this.popupMenu.contains(e.target)&&this.hideMenu()}handleKeydown(e){if(!(!this.popupMenu||this.popupMenu.style.display==="none"))switch(e.key){case"ArrowDown":this.focusNextMenuItem(),e.preventDefault();break;case"ArrowUp":this.focusPreviousMenuItem(),e.preventDefault();break;case"Enter":this.focusedIndex>=0&&this.menuItems[this.focusedIndex].click(),e.preventDefault();break;case"Escape":this.hideMenu(),e.preventDefault();break}}focusMenuItem(e){this.focusedIndex>=0&&(this.menuItems[this.focusedIndex].style.backgroundColor=""),this.focusedIndex=e,this.menuItems[e].focus(),this.menuItems[e].style.backgroundColor="#f0f0f0"}focusNextMenuItem(){let e=(this.focusedIndex+1)%this.menuItems.length;this.focusMenuItem(e)}focusPreviousMenuItem(){let e=(this.focusedIndex-1+this.menuItems.length)%this.menuItems.length;this.focusMenuItem(e)}};export{s as PopupMenu};
