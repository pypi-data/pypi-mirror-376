@import 'https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4/theme.css';

@custom-variant dark (&:is(.dark *));


@theme {
    /* Font families - Exact shadcn system */
    --font-sans: var(--font-geist-sans), -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen", "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans", "Helvetica Neue", sans-serif;
    --font-mono: var(--font-geist-mono), "SF Mono", "Monaco", "Inconsolata", "Fira Code", "Fira Mono", "Roboto Mono", monospace;
    
    /* Radius system - Exact shadcn values */
    --radius: 0.5rem;
    --radius-sm: calc(var(--radius) - 4px);
    --radius-md: calc(var(--radius) - 2px);
    --radius-lg: var(--radius);
    --radius-xl: calc(var(--radius) + 4px);
    
    /* Light mode colors - Using OKLCH for Tailwind v4 */
    --color-background: oklch(100% 0 0);
    --color-foreground: oklch(13% 0.028 261.692);
    --color-card: oklch(100% 0 0);
    --color-card-foreground: oklch(13% 0.028 261.692);
    --color-popover: oklch(100% 0 0);
    --color-popover-foreground: oklch(13% 0.028 261.692);
    --color-primary: oklch(22.2% 0.03 261.692);
    --color-primary-foreground: oklch(98.3% 0 0);
    --color-secondary: oklch(96.4% 0.004 261.692);
    --color-secondary-foreground: oklch(22.2% 0.03 261.692);
    --color-muted: oklch(96.4% 0.004 261.692);
    --color-muted-foreground: oklch(54.2% 0.022 261.692);
    --color-accent: oklch(96.4% 0.004 261.692);
    --color-accent-foreground: oklch(22.2% 0.03 261.692);
    --color-destructive: oklch(59.8% 0.243 25.546);
    --color-destructive-foreground: oklch(98.3% 0 0);
    --color-border: oklch(91.2% 0.004 261.692);
    --color-input: oklch(91.2% 0.004 261.692);
    --color-ring: oklch(71.2% 0.014 261.692);
    
    /* Shadow system - Exact shadcn shadows */
    --shadow-xs: 0 1px 2px 0 rgb(0 0 0 / 0.05);
    --shadow-sm: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
    --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
}

* {
    border-color: var(--color-border);
}

body {
    background-color: var(--color-background);
    color: var(--color-foreground);
    font-family: var(--font-sans);
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

.dark {
    /* Dark mode colors - Using OKLCH for Tailwind v4 */
    --color-background: oklch(14.1% 0.005 285.823);
    --color-foreground: oklch(98.3% 0 0);
    --color-card: oklch(14.1% 0.005 285.823);
    --color-card-foreground: oklch(98.3% 0 0);
    --color-popover: oklch(14.1% 0.005 285.823);
    --color-popover-foreground: oklch(98.3% 0 0);
    --color-primary: oklch(98.3% 0 0);
    --color-primary-foreground: oklch(22.2% 0.03 261.692);
    --color-secondary: oklch(24.2% 0.005 285.823);
    --color-secondary-foreground: oklch(98.3% 0 0);
    --color-muted: oklch(24.2% 0.005 285.823);
    --color-muted-foreground: oklch(71.2% 0.014 261.692);
    --color-accent: oklch(24.2% 0.005 285.823);
    --color-accent-foreground: oklch(98.3% 0 0);
    --color-destructive: oklch(44.2% 0.158 26.548);
    --color-destructive-foreground: oklch(96.9% 0.021 23.104);
    --color-border: oklch(24.2% 0.005 285.823);
    --color-input: oklch(24.2% 0.005 285.823);
    --color-ring: oklch(84.7% 0.005 285.823);
}

code {
    font-family: var(--font-mono);
}

/* Typography hierarchy - Exact shadcn system */
h1 {
    scroll-margin-top: 5rem;
    margin-top: 0.5rem;
    font-size: 2.25rem;
    font-weight: 700;
    line-height: 1.2;
    letter-spacing: -0.025em;
}

h2 {
    scroll-margin-top: 5rem;
    margin-top: 4rem;
    padding-bottom: 1rem;
    font-size: 1.25rem;
    font-weight: 600;
    line-height: 1.25;
    letter-spacing: -0.025em;
    border-bottom: 1px solid hsl(var(--color-border));
}

h2:first-child {
    margin-top: 0;
}

h3 {
    scroll-margin-top: 5rem;
    margin-top: 2rem;
    font-size: 1.125rem;
    font-weight: 600;
    line-height: 1.25;
    letter-spacing: -0.025em;
}

h4, h5, h6 {
    scroll-margin-top: 5rem;
    margin-top: 2rem;
    font-size: 1rem;
    font-weight: 600;
    line-height: 1.5;
    letter-spacing: -0.025em;
}

p {
    line-height: 1.65rem;
    margin-top: 1.5rem;
}

p:first-child {
    margin-top: 0;
}

/* Container system - Exact shadcn layout */
.container {
    max-width: 1400px;
    margin-left: auto;
    margin-right: auto;
    padding-left: 1rem;
    padding-right: 1rem;
}

@media (min-width: 768px) {
    .container {
        padding-left: 1.5rem;
        padding-right: 1.5rem;
    }
}

@media (min-width: 1280px) {
    .container {
        padding-left: 1.5rem;
        padding-right: 1.5rem;
    }
}

@media (min-width: 1400px) {
    .container {
        border-left: 1px dashed hsl(var(--color-border) / 0.7);
        border-right: 1px dashed hsl(var(--color-border) / 0.7);
    }
    
    .dark .container {
        border-left: 1px dashed hsl(var(--color-border));
        border-right: 1px dashed hsl(var(--color-border));
    }
}

@media (min-width: 1800px) {
    .container {
        max-width: 1536px;
    }
}

/* Animation for theme toggle */
.animate-spin {
    animation: spin 1s linear infinite;
}

@keyframes spin {
    to {
        transform: rotate(360deg);
    }
}

/* Theme transition optimizations */
.theme-transitioning {
    transition: background-color 300ms ease-in-out, color 300ms ease-in-out;
}

.theme-transitioning *,
.theme-transitioning *::before,
.theme-transitioning *::after {
    transition: background-color 300ms ease-in-out, color 300ms ease-in-out, border-color 300ms ease-in-out !important;
}

.theme-loading {
    /* Prevent flash during initial load */
    transition: none !important;
}

.theme-loading *,
.theme-loading *::before,
.theme-loading *::after {
    transition: none !important;
}

/* Optimized icon transitions */
iconify-icon {
    transition: opacity 200ms ease-in-out, transform 200ms ease-in-out;
}

/* Reduce motion for accessibility */
@media (prefers-reduced-motion: reduce) {
    .theme-transitioning,
    .theme-transitioning *,
    .theme-transitioning *::before,
    .theme-transitioning *::after,
    iconify-icon {
        transition: none !important;
    }
}

/* Optimized Mobile Menu Animation System */

/* Base mobile menu with hardware acceleration */
.mobile-menu-container {
    /* Hardware acceleration triggers */
    transform: translateX(100%) translateZ(0);
    will-change: transform;
    backface-visibility: hidden;
    
    /* Optimized transition for 60fps - natural feel */
    transition: transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

/* Open state - slides in from right */
.mobile-menu-container.open {
    transform: translateX(0) translateZ(0);
}

/* Enhanced backdrop with optimized fade */
.mobile-menu-backdrop {
    /* Hardware acceleration */
    transform: translateZ(0);
    will-change: opacity;
    
    /* Smooth fade transition */
    opacity: 0;
    transition: opacity 300ms cubic-bezier(0.16, 1, 0.3, 1);
    
    /* Enhanced backdrop styling */
    backdrop-filter: blur(4px);
    -webkit-backdrop-filter: blur(4px);
    background-color: hsl(var(--color-background) / 0.8);
}

.mobile-menu-backdrop.open {
    opacity: 1;
}

/* Content animation with stagger */
.mobile-menu-content {
    opacity: 0;
    transform: translateY(20px);
    transition: opacity 200ms ease-out, transform 200ms ease-out;
    transition-delay: 100ms;
}

.mobile-menu-container.open .mobile-menu-content {
    opacity: 1;
    transform: translateY(0);
}

/* Staggered animation for menu items */
.mobile-menu-item {
    opacity: 0;
    transform: translateX(20px);
    transition: opacity 150ms ease-out, transform 150ms ease-out;
}

.mobile-menu-container.open .mobile-menu-item:nth-child(1) {
    transition-delay: 150ms;
    opacity: 1;
    transform: translateX(0);
}

.mobile-menu-container.open .mobile-menu-item:nth-child(2) {
    transition-delay: 200ms;
    opacity: 1;
    transform: translateX(0);
}

.mobile-menu-container.open .mobile-menu-item:nth-child(3) {
    transition-delay: 250ms;
    opacity: 1;
    transform: translateX(0);
}

.mobile-menu-container.open .mobile-menu-item:nth-child(4) {
    transition-delay: 300ms;
    opacity: 1;
    transform: translateX(0);
}

.mobile-menu-container.open .mobile-menu-item:nth-child(5) {
    transition-delay: 350ms;
    opacity: 1;
    transform: translateX(0);
}

/* Alternative timing functions for different feels */
.mobile-menu--smooth {
    transition: transform 400ms cubic-bezier(0.16, 1, 0.3, 1);
}

.mobile-menu--snappy {
    transition: transform 280ms cubic-bezier(0.4, 0, 0.2, 1);
}

/* Accessibility: Respect reduced motion preference */
@media (prefers-reduced-motion: reduce) {
    .mobile-menu-container,
    .mobile-menu-backdrop,
    .mobile-menu-content,
    .mobile-menu-item {
        transition: none;
    }
    
    .mobile-menu-container {
        transform: translateX(100%);
    }
    
    .mobile-menu-container.open {
        transform: translateX(0);
    }
    
    .mobile-menu-content,
    .mobile-menu-item {
        opacity: 1;
        transform: none;
    }
}

@media (max-width: 1023px) {
    /* Legacy sidebar mobile support */
    .sidebar-mobile {
        transform: translateX(-100%);
        transition: transform 300ms cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .sidebar-mobile[data-show="true"] {
        transform: translateX(0);
    }
    
    /* Prevent body scroll when mobile menu is open */
    body:has(.mobile-menu-container.open),
    body:has([data-show="true"]) {
        overflow: hidden;
        touch-action: none;
    }
    
    /* Optimize for touch interactions */
    .mobile-menu-container {
        -webkit-overflow-scrolling: touch;
        overscroll-behavior: contain;
        touch-action: pan-y;
    }
    
    /* Handle safe area on mobile devices */
    .mobile-menu-container {
        padding-top: env(safe-area-inset-top);
        padding-bottom: env(safe-area-inset-bottom);
    }
    
    /* Enhanced touch targets */
    .mobile-menu-item {
        min-height: 44px; /* iOS recommended minimum */
        padding: 12px 16px;
        display: flex;
        align-items: center;
        gap: 12px;
        
        /* Touch feedback */
        transition: background-color 150ms ease-out, transform 150ms ease-out;
        -webkit-tap-highlight-color: transparent;
    }
    
    .mobile-menu-item:active {
        background-color: hsl(var(--color-accent));
        transform: scale(0.98);
    }
    
    /* Legacy backdrop support */
    .sidebar-backdrop {
        backdrop-filter: blur(2px);
        -webkit-backdrop-filter: blur(2px);
        background-color: hsl(var(--color-background) / 0.8);
    }
}

/* Performance optimization for lower-end devices */
@media (max-width: 480px) {
    .mobile-menu-backdrop {
        backdrop-filter: blur(2px);
        -webkit-backdrop-filter: blur(2px);
    }
}

/* Handle interrupted animations gracefully */
.mobile-menu-container.transitioning {
    pointer-events: none;
}

.mobile-menu-container:not(.transitioning) {
    pointer-events: auto;
}

/* Dialog backdrop blur for mobile menu */
#mobile-menu-dialog::backdrop {
    backdrop-filter: blur(4px);
    -webkit-backdrop-filter: blur(4px);
    background-color: rgba(0, 0, 0, 0.8);
}

/* Enhanced sidebar styling for better dark/light mode support */
.sidebar-content {
    /* Scrollbar styling for better theme integration */
    scrollbar-width: thin;
    scrollbar-color: hsl(var(--color-muted)) transparent;
}

/* Fix for mobile menu race condition during resize */
@media (min-width: 1280px) {
    /* Force hide mobile menu on desktop regardless of Datastar state */
    .sidebar-mobile-menu {
        transform: translateX(100%) !important;
        transition: none !important;
    }
    
    /* Ensure mobile menu elements are not interactive on desktop */
    .sidebar-mobile-menu,
    .mobile-menu-backdrop {
        pointer-events: none !important;
        opacity: 0 !important;
    }
}

.sidebar-content::-webkit-scrollbar {
    width: 6px;
}

.sidebar-content::-webkit-scrollbar-track {
    background: transparent;
}

.sidebar-content::-webkit-scrollbar-thumb {
    background-color: hsl(var(--color-muted));
    border-radius: 3px;
}

.sidebar-content::-webkit-scrollbar-thumb:hover {
    background-color: hsl(var(--color-muted-foreground));
}

/* Desktop sidebar improvements */
@media (min-width: 1024px) {
    /* Smooth content width transitions when sidebar toggles */
    .sidebar-content {
        transition: margin-left 300ms ease-in-out;
    }
}
