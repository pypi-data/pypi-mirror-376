# MCP Feedback Enhanced å›¾ç‰‡åºåˆ—åŒ–é”™è¯¯ä¿®å¤æ–‡æ¡£

## é—®é¢˜æè¿°

åœ¨ä½¿ç”¨ MCP Feedback Enhanced å·¥å…·ä¸Šä¼ å›¾ç‰‡æ—¶ï¼Œå‡ºç°ä»¥ä¸‹é”™è¯¯ï¼š

```
Error calling tool 'interactive_feedback': Unable to serialize unknown type: <class 'fastmcp.utilities.types.Image'>
```

## é—®é¢˜æ ¹å› åˆ†æ

é”™è¯¯çš„æ ¹æœ¬åŸå› æ˜¯ `fastmcp.utilities.types.Image` å¯¹è±¡æ— æ³•è¢« MCP åè®®ç›´æ¥åºåˆ—åŒ–ã€‚åœ¨ `process_images` å‡½æ•°ä¸­ï¼Œåˆ›å»ºçš„ `MCPImage` å¯¹è±¡éœ€è¦è½¬æ¢ä¸ºæ ‡å‡†çš„ MCP `ImageContent` ç±»å‹æ‰èƒ½æ­£ç¡®ä¼ è¾“ã€‚

## ä¿®å¤æ–¹æ¡ˆ

### 1. ä»£ç ä¿®æ”¹

éœ€è¦ä¿®æ”¹ `src/mcp_feedback_enhanced/server.py` æ–‡ä»¶ä¸­çš„ä»¥ä¸‹éƒ¨åˆ†ï¼š

#### 1.1 æ·»åŠ  ImageContent å¯¼å…¥

```python
# ä¿®æ”¹å‰
from fastmcp import FastMCP
from fastmcp.utilities.types import Image as MCPImage
from mcp.types import TextContent
from pydantic import Field

# ä¿®æ”¹å
from fastmcp import FastMCP
from fastmcp.utilities.types import Image as MCPImage
from mcp.types import TextContent, ImageContent
from pydantic import Field
```

#### 1.2 ä¿®æ”¹ process_images å‡½æ•°ç­¾å

```python
# ä¿®æ”¹å‰
def process_images(images_data: list[dict]) -> list[MCPImage]:

# ä¿®æ”¹å
def process_images(images_data: list[dict]) -> list[ImageContent]:
```

#### 1.3 ä¿®æ”¹å‡½æ•°æ–‡æ¡£å­—ç¬¦ä¸²

```python
# ä¿®æ”¹å‰
    Returns:
        List[MCPImage]: MCP åœ–ç‰‡å°è±¡åˆ—è¡¨

# ä¿®æ”¹å  
    Returns:
        List[ImageContent]: MCP åœ–ç‰‡å…§å®¹å°è±¡åˆ—è¡¨
```

#### 1.4 ä¿®æ”¹å›¾ç‰‡å¯¹è±¡åˆ›å»ºé€»è¾‘

```python
# ä¿®æ”¹å‰
            # å‰µå»º MCPImage å°è±¡
            mcp_image = MCPImage(data=image_bytes, format=image_format)
            mcp_images.append(mcp_image)

# ä¿®æ”¹å
            # å‰µå»º MCPImage å°è±¡ä¸¦è½‰æ›ç‚º ImageContent
            mcp_image = MCPImage(data=image_bytes, format=image_format)
            # ä½¿ç”¨ to_image_content æ–¹æ³•è½‰æ›ç‚ºå¯åºåˆ—åŒ–çš„ ImageContent
            image_content = mcp_image.to_image_content()
            mcp_images.append(image_content)
```

### 2. ä¿®å¤åŸç†

é€šè¿‡ä½¿ç”¨ `MCPImage.to_image_content()` æ–¹æ³•ï¼Œå°† fastmcp çš„ Image å¯¹è±¡è½¬æ¢ä¸ºæ ‡å‡†çš„ MCP `ImageContent` å¯¹è±¡ï¼Œè¿™æ ·å°±èƒ½è¢«æ­£ç¡®åºåˆ—åŒ–å¹¶é€šè¿‡ MCP åè®®ä¼ è¾“ã€‚

## éªŒè¯ä¿®å¤

ä¿®å¤åï¼Œåº”è¯¥èƒ½å¤Ÿï¼š
1. æ­£å¸¸ä¸Šä¼ å›¾ç‰‡è€Œä¸å‡ºç°åºåˆ—åŒ–é”™è¯¯
2. AI åŠ©æ‰‹èƒ½å¤Ÿæ¥æ”¶å¹¶æ˜¾ç¤ºå›¾ç‰‡å†…å®¹
3. å›¾ç‰‡æ•°æ®å®Œæ•´ä¼ è¾“

## éƒ¨ç½²æ­¥éª¤

### åœ¨æ–°ç”µè„‘ä¸Šéƒ¨ç½²ä¿®å¤ç‰ˆæœ¬

#### å‰ç½®æ¡ä»¶
- Python 3.11 æˆ–æ›´é«˜ç‰ˆæœ¬
- uv åŒ…ç®¡ç†å·¥å…·
- Gitï¼ˆå¯é€‰ï¼Œç”¨äºè·å–æºç ï¼‰

#### æ­¥éª¤ 1ï¼šè·å–å®‰è£…åŒ…

**æ–¹æ³• Aï¼šç›´æ¥ä½¿ç”¨æ„å»ºå¥½çš„åŒ…ï¼ˆæ¨èï¼‰**

å¦‚æœæ‚¨å·²ç»æœ‰æ„å»ºå¥½çš„åŒ…æ–‡ä»¶ï¼Œç›´æ¥å°†ä»¥ä¸‹æ–‡ä»¶å¤åˆ¶åˆ°æ–°æœºå™¨ï¼š
- `mcp_feedback_enhanced-2.6.0-py3-none-any.whl`ï¼ˆæ¨èï¼‰
- æˆ– `mcp_feedback_enhanced-2.6.0.tar.gz`

```bash
# åˆ›å»ºä¸´æ—¶ç›®å½•å­˜æ”¾åŒ…æ–‡ä»¶
mkdir mcp-install
cd mcp-install

# å°†æ„å»ºåŒ…å¤åˆ¶åˆ°æ­¤ç›®å½•
# ï¼ˆé€šè¿‡Uç›˜ã€ç½‘ç»œä¼ è¾“ç­‰æ–¹å¼ï¼‰
```

**æ–¹æ³• Bï¼šä»æºç æ„å»º**

å¦‚æœéœ€è¦ä»æºç é‡æ–°æ„å»ºï¼š

```bash
# å…‹éš†æˆ–ä¸‹è½½é¡¹ç›®æºç 
git clone https://github.com/your-repo/mcp-feedback-enhanced.git
cd mcp-feedback-enhanced

# åº”ç”¨ä¿®å¤è¡¥ä¸ï¼ˆå¦‚æœä½¿ç”¨æœªä¿®å¤çš„æºç ï¼‰
# æ‰‹åŠ¨åº”ç”¨ä¸Šè¿°ä»£ç ä¿®æ”¹ï¼Œæˆ–ä½¿ç”¨ä¿®å¤åçš„ server.py æ–‡ä»¶

# ä½¿ç”¨ uv æ„å»ºåŒ…
uv build
```

æ„å»ºå®Œæˆåï¼Œåœ¨ `dist/` ç›®å½•ä¸‹ä¼šç”Ÿæˆï¼š
- `mcp_feedback_enhanced-2.6.0.tar.gz`
- `mcp_feedback_enhanced-2.6.0-py3-none-any.whl`

#### æ­¥éª¤ 2ï¼šå®‰è£…ä¿®å¤ç‰ˆæœ¬

```bash
# å®‰è£… wheel åŒ…ï¼ˆæ¨èï¼‰
pip install dist/mcp_feedback_enhanced-2.6.0-py3-none-any.whl --force-reinstall

# æˆ–è€…å®‰è£… tar.gz åŒ…
pip install dist/mcp_feedback_enhanced-2.6.0.tar.gz --force-reinstall
```

#### æ­¥éª¤ 3ï¼šé…ç½® MCP

åˆ›å»ºæˆ–ä¿®æ”¹ MCP é…ç½®æ–‡ä»¶ï¼Œä½¿ç”¨æœ¬åœ°å®‰è£…çš„ç‰ˆæœ¬ï¼š

```json
{
  "mcpServers": {
    "mcp-feedback-enhanced": {
      "command": "mcp-feedback-enhanced",
      "args": []
    }
  }
}
```

**æ³¨æ„**ï¼šä¸è¦ä½¿ç”¨ `uvx` å’Œ `@latest`ï¼Œè¿™ä¼šä¸‹è½½æœªä¿®å¤çš„å®˜æ–¹ç‰ˆæœ¬ã€‚

#### æ­¥éª¤ 4ï¼šé‡å¯ AI åŠ©æ‰‹

é‡å¯æ‚¨çš„ AI åŠ©æ‰‹åº”ç”¨ç¨‹åºä»¥åŠ è½½æ–°çš„ MCP é…ç½®ã€‚

#### æ­¥éª¤ 5ï¼šæµ‹è¯•åŠŸèƒ½

1. è°ƒç”¨ `interactive_feedback` å·¥å…·
2. å°è¯•ä¸Šä¼ å›¾ç‰‡
3. éªŒè¯æ²¡æœ‰åºåˆ—åŒ–é”™è¯¯
4. ç¡®è®¤å›¾ç‰‡èƒ½æ­£å¸¸æ˜¾ç¤º

### å¯é€‰ï¼šéªŒè¯å®‰è£…

```bash
# æ£€æŸ¥å®‰è£…çš„ç‰ˆæœ¬
pip show mcp-feedback-enhanced

# éªŒè¯å‘½ä»¤å¯ç”¨
mcp-feedback-enhanced --help
```

## é…ç½®æ–‡ä»¶ç¤ºä¾‹

### å®Œæ•´çš„ MCP é…ç½®ç¤ºä¾‹

```json
{
  "mcpServers": {
    "mcp-feedback-enhanced": {
      "command": "mcp-feedback-enhanced",
      "args": [],
      "env": {
        "MCP_DEBUG": "false"
      }
    }
  }
}
```

### å¼€å‘ç¯å¢ƒé…ç½®

å¦‚æœéœ€è¦å¯ç”¨è°ƒè¯•æ¨¡å¼ï¼š

```json
{
  "mcpServers": {
    "mcp-feedback-enhanced": {
      "command": "python",
      "args": ["-m", "mcp_feedback_enhanced"],
      "env": {
        "MCP_DEBUG": "true"
      }
    }
  }
}
```

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **ä»ç„¶å‡ºç°åºåˆ—åŒ–é”™è¯¯**
   - ç¡®è®¤ä½¿ç”¨çš„æ˜¯ä¿®å¤ç‰ˆæœ¬è€Œä¸æ˜¯å®˜æ–¹ç‰ˆæœ¬
   - æ£€æŸ¥ MCP é…ç½®æ˜¯å¦æ­£ç¡®
   - é‡å¯ AI åŠ©æ‰‹

2. **æ— æ³•æ‰¾åˆ°å‘½ä»¤**
   - ç¡®è®¤åŒ…å·²æ­£ç¡®å®‰è£…ï¼š`pip show mcp-feedback-enhanced`
   - å°è¯•ä½¿ç”¨å®Œæ•´è·¯å¾„ï¼š`python -m mcp_feedback_enhanced`

3. **ç‰ˆæœ¬å†²çª**
   - ä½¿ç”¨ `--force-reinstall` å¼ºåˆ¶é‡è£…
   - æ¸…ç†æ—§ç‰ˆæœ¬ï¼š`pip uninstall mcp-feedback-enhanced`

### æ—¥å¿—æ£€æŸ¥

å¯ç”¨è°ƒè¯•æ¨¡å¼æŸ¥çœ‹è¯¦ç»†æ—¥å¿—ï¼š
```bash
export MCP_DEBUG=true
```

## æŠ€æœ¯ç»†èŠ‚

### ä¿®å¤æ¶‰åŠçš„å…³é”®æ–‡ä»¶
- `src/mcp_feedback_enhanced/server.py` - ä¸»è¦ä¿®å¤æ–‡ä»¶
- `pyproject.toml` - é¡¹ç›®é…ç½®

### ä¾èµ–å…³ç³»
- `fastmcp >= 2.0.0` - MCP æ¡†æ¶
- `mcp >= 1.9.3` - MCP åè®®åº“

### å…¼å®¹æ€§
- ä¿®å¤ç‰ˆæœ¬å‘åå…¼å®¹
- æ”¯æŒ Python 3.11+
- è·¨å¹³å°æ”¯æŒï¼ˆWindows, macOS, Linuxï¼‰

## ğŸš€ å¿«é€Ÿéƒ¨ç½²å‘½ä»¤

å¯¹äºå…¶ä»–ç”µè„‘çš„å¿«é€Ÿéƒ¨ç½²ï¼Œæœ‰ä¸¤ç§æ–¹å¼ï¼š

**æ–¹å¼ Aï¼šç›´æ¥ä½¿ç”¨æ„å»ºåŒ…ï¼ˆæœ€ç®€ä¾¿ï¼‰**

å¦‚æœå·²æœ‰æ„å»ºå¥½çš„åŒ…æ–‡ä»¶ï¼š
```bash
# 1. å°†åŒ…æ–‡ä»¶å¤åˆ¶åˆ°æ–°æœºå™¨
# å¤åˆ¶ mcp_feedback_enhanced-2.6.0-py3-none-any.whl

# 2. å®‰è£…
pip install mcp_feedback_enhanced-2.6.0-py3-none-any.whl --force-reinstall

# 3. é…ç½®MCPï¼ˆä½¿ç”¨æœ¬åœ°å‘½ä»¤è€Œéuvxï¼‰
```

**æ–¹å¼ Bï¼šä»æºç æ„å»º**
```bash
# 1. æ„å»ºåŒ…
uv build

# 2. å®‰è£…
pip install dist/mcp_feedback_enhanced-2.6.0-py3-none-any.whl --force-reinstall
```

**MCPé…ç½®ï¼ˆä¸¤ç§æ–¹å¼ç›¸åŒï¼‰ï¼š**
```json
{
  "mcpServers": {
    "mcp-feedback-enhanced": {
      "command": "mcp-feedback-enhanced",
      "args": []
    }
  }
}
```

**ä¼˜åŠ¿å¯¹æ¯”ï¼š**
- æ–¹å¼Aï¼šæ— éœ€æºç ï¼Œä¼ è¾“ä¸€ä¸ªwheelæ–‡ä»¶å³å¯ï¼Œé€‚åˆæ‰¹é‡éƒ¨ç½²
- æ–¹å¼Bï¼šéœ€è¦å®Œæ•´å¼€å‘ç¯å¢ƒï¼Œé€‚åˆå¼€å‘è°ƒè¯•

## ç‰ˆæœ¬å†å²

- **v2.6.0** - ä¿®å¤å›¾ç‰‡åºåˆ—åŒ–é”™è¯¯
- **v2.5.x** - ä¹‹å‰ç‰ˆæœ¬ï¼ˆå­˜åœ¨åºåˆ—åŒ–é—®é¢˜ï¼‰

---

**ä¿®å¤å®Œæˆæ—¥æœŸ**: 2025å¹´9æœˆ12æ—¥  
**ä¿®å¤ä½œè€…**: AI Assistant  
**æµ‹è¯•çŠ¶æ€**: âœ… é€šè¿‡éªŒè¯